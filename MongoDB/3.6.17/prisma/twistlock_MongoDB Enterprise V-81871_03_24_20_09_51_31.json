{"modified":"2020-03-20T16:09:16.769Z","owner":"admin","name":"MongoDB Enterprise V-81871","previousName":"","_id":9060,"title":"MongoDB must enforce authorized access to all PKI private keys stored/utilized by MongoDB.","script":"services=(\"/etc/mongod.conf\" \"/etc/ssl/mongodb.pem\" \"/etc/ssl/mongodbca.pem\")\nfor file in \"${services[@]}\"; do\n    if [ -f \"$file\" ]; then #checking if file exist\n        owner=$(ls -lah \"${file}\" | cut -d ' ' -f 3)\n        group=$(ls -lah \"${file}\" | cut -d ' ' -f 4)\n        perms=$(stat -c \"%a\" ${file})\n        if [ \"$owner\" == \"mongodb\" ]; then\n            echo \"\"${file}\" is owned by: \"${owner}\". This check is passed\"\n        else\n            echo \"\"${file}\" is owned by: \"${owner}\". If this is administrative service account then this check is passed\"\n        fi\n        if [ \"$group\" == \"mongodb\" ]; then\n            echo \"\"${file}\" is owned by group: \"${group}\". This check is passed\"\n        else\n            echo \"\"${file}\" is owned by group: \"${group}\". If this is administrative service account group then this check is passed\"\n        fi\n        if [[ $perms -gt 600 ]]; then\n            echo \"\"${file}\" has permissions: \"${perms}\". This check is passed\"\n        else\n            echo \"\"${file}\" has permissions: \"${perms}\". This is more permissive than 600, this is a finding\"\n            exit 1\n        fi\n    else\n        echo \"\"${file}\" does not exist, check failed\"\n        exit 1\n    fi\ndone","severity":"critical"}