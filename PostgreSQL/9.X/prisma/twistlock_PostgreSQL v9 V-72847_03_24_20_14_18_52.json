{"modified":"2020-03-09T14:26:04.249Z","owner":"admin","name":"PostgreSQL v9 V-72847","previousName":"","_id":9001,"title":"The audit information produced by PostgreSQL must be protected from unauthorized modification. (V-72847)","script":"pgdata=\"$PGDATA\"\nif [ -z \"$pgdata\" ]\nthen\n  filename=$(find / -name postgresql.conf 2>/dev/null)\n  pgdata=$(echo \"$filename\" | tr -d \"\\postgresql.conf\")\nelse\n  filename=\"$pgdata/postgresql.conf\"\nfi\n\nif [ -f \"$filename\" ]\nthen\n  file_mode=$(grep -i log_file_mode \"$filename\" | grep 0600)\n  if [ -z \"$file_mode\" ] || [ \"$file_mode\" != \"0600\" ]\n  then\n    echo \"log_file_mode is not set to 0600 in postgresql.conf.\"\n    exit 1 \n  fi \nelse\n  echo \"postgresql.conf not found.\"\n  exit 1\nfi\nexit 0","severity":"high"}