{"modified":"2020-03-09T14:26:02.427Z","owner":"admin","name":"PostgreSQL v9 V-72841","previousName":"","_id":9000,"title":"PostgreSQL must be configured to prohibit or restrict the use of organization-defined functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments. (V-72841)((UPDATED))","script":"pgdata=\"$PGDATA\"\nif [ -z \"$pgdata\" ]\nthen\n  filename=$(find / -name postgresql.conf 2>/dev/null)\nelse\n  filename=\"$pgdata/postgresql.conf\"\nfi\n\nif [ -f \"$filename\" ]\nthen\n  port=$(grep -i port \"$filename\")\n  if [ -z \"$port\" ]\n  then\n    echo \"Port not set in postgresql.conf.\"\n    exit 1\n  fi\n\n  if [ \"$port\" != \"5432\" ]\n  then\n    echo 'Port is not set to 5432 in postgresql.conf.'\n    exit 1\n  fi\nelse\n  echo \"postgresql.conf file not found.\"\n  exit 1\nfi\nexit 0","severity":"high"}