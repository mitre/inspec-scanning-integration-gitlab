{
    "platform":{
       "name":"debian",
       "release":"10.4"
    },
    "profiles":[
       {
          "name":"Apache Tomcat 9 Security Technical Implementation Guide",
          "version":"0.1.0",
          "sha256":"5540dc72c51959baa0963bb7de25a4be8c458c5501d86afc681e4a2374b270e1",
          "title":"Apache Tomcat 9 Security Technical Implementation Guide",
          "maintainer":"The Authors",
          "summary":"This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems.",
          "license":"tbd",
          "copyright":"The Authors",
          "copyright_email":"you@example.com",
          "supports":[
 
          ],
          "attributes":[
 
          ],
          "groups":[
             {
                "id":"controls/TCAT-AS-000010.rb",
                "controls":[
                   "TCAT-AS-000010"
                ]
             },
             {
                "id":"controls/TCAT-AS-000020.rb",
                "controls":[
                   "TCAT-AS-000020"
                ]
             },
             {
                "id":"controls/TCAT-AS-000030.rb",
                "controls":[
                   "TCAT-AS-000030"
                ]
             },
             {
                "id":"controls/TCAT-AS-000040.rb",
                "controls":[
                   "TCAT-AS-000040"
                ]
             },
             {
                "id":"controls/TCAT-AS-000050.rb",
                "controls":[
                   "TCAT-AS-000050"
                ]
             },
             {
                "id":"controls/TCAT-AS-000060.rb",
                "controls":[
                   "TCAT-AS-000060"
                ]
             },
             {
                "id":"controls/TCAT-AS-000070.rb",
                "controls":[
                   "TCAT-AS-000070"
                ]
             },
             {
                "id":"controls/TCAT-AS-000080.rb",
                "controls":[
                   "TCAT-AS-000080"
                ]
             },
             {
                "id":"controls/TCAT-AS-000090.rb",
                "controls":[
                   "TCAT-AS-000090"
                ]
             },
             {
                "id":"controls/TCAT-AS-000100.rb",
                "controls":[
                   "TCAT-AS-000100"
                ]
             },
             {
                "id":"controls/TCAT-AS-000110.rb",
                "controls":[
                   "TCAT-AS-000110"
                ]
             },
             {
                "id":"controls/TCAT-AS-000140.rb",
                "controls":[
                   "TCAT-AS-000140"
                ]
             },
             {
                "id":"controls/TCAT-AS-000160.rb",
                "controls":[
                   "TCAT-AS-000160"
                ]
             },
             {
                "id":"controls/TCAT-AS-000170.rb",
                "controls":[
                   "TCAT-AS-000170"
                ]
             },
             {
                "id":"controls/TCAT-AS-000180.rb",
                "controls":[
                   "TCAT-AS-000180"
                ]
             },
             {
                "id":"controls/TCAT-AS-000190.rb",
                "controls":[
                   "TCAT-AS-000190"
                ]
             },
             {
                "id":"controls/TCAT-AS-000210.rb",
                "controls":[
                   "TCAT-AS-000210"
                ]
             },
             {
                "id":"controls/TCAT-AS-000220.rb",
                "controls":[
                   "TCAT-AS-000220"
                ]
             },
             {
                "id":"controls/TCAT-AS-000230.rb",
                "controls":[
                   "TCAT-AS-000230"
                ]
             },
             {
                "id":"controls/TCAT-AS-000240.rb",
                "controls":[
                   "TCAT-AS-000240"
                ]
             },
             {
                "id":"controls/TCAT-AS-000250.rb",
                "controls":[
                   "TCAT-AS-000250"
                ]
             },
             {
                "id":"controls/TCAT-AS-000260.rb",
                "controls":[
                   "TCAT-AS-000260"
                ]
             },
             {
                "id":"controls/TCAT-AS-000270.rb",
                "controls":[
                   "TCAT-AS-000270"
                ]
             },
             {
                "id":"controls/TCAT-AS-000280.rb",
                "controls":[
                   "TCAT-AS-000280"
                ]
             },
             {
                "id":"controls/TCAT-AS-000290.rb",
                "controls":[
                   "TCAT-AS-000290"
                ]
             },
             {
                "id":"controls/TCAT-AS-000300.rb",
                "controls":[
                   "TCAT-AS-000300"
                ]
             },
             {
                "id":"controls/TCAT-AS-000310.rb",
                "controls":[
                   "TCAT-AS-000310"
                ]
             },
             {
                "id":"controls/TCAT-AS-000360.rb",
                "controls":[
                   "TCAT-AS-000360"
                ]
             },
             {
                "id":"controls/TCAT-AS-000361.rb",
                "controls":[
                   "TCAT-AS-000361"
                ]
             },
             {
                "id":"controls/TCAT-AS-000370.rb",
                "controls":[
                   "TCAT-AS-000370"
                ]
             },
             {
                "id":"controls/TCAT-AS-000371.rb",
                "controls":[
                   "TCAT-AS-000371"
                ]
             },
             {
                "id":"controls/TCAT-AS-000380.rb",
                "controls":[
                   "TCAT-AS-000380"
                ]
             },
             {
                "id":"controls/TCAT-AS-000390.rb",
                "controls":[
                   "TCAT-AS-000390"
                ]
             },
             {
                "id":"controls/TCAT-AS-000400.rb",
                "controls":[
                   "TCAT-AS-000400"
                ]
             },
             {
                "id":"controls/TCAT-AS-000410.rb",
                "controls":[
                   "TCAT-AS-000410"
                ]
             },
             {
                "id":"controls/TCAT-AS-000450.rb",
                "controls":[
                   "TCAT-AS-000450"
                ]
             },
             {
                "id":"controls/TCAT-AS-000470.rb",
                "controls":[
                   "TCAT-AS-000470"
                ]
             },
             {
                "id":"controls/TCAT-AS-000480.rb",
                "controls":[
                   "TCAT-AS-000480"
                ]
             },
             {
                "id":"controls/TCAT-AS-000490.rb",
                "controls":[
                   "TCAT-AS-000490"
                ]
             },
             {
                "id":"controls/TCAT-AS-000500.rb",
                "controls":[
                   "TCAT-AS-000500"
                ]
             },
             {
                "id":"controls/TCAT-AS-000510.rb",
                "controls":[
                   "TCAT-AS-000510"
                ]
             },
             {
                "id":"controls/TCAT-AS-000520.rb",
                "controls":[
                   "TCAT-AS-000520"
                ]
             },
             {
                "id":"controls/TCAT-AS-000530.rb",
                "controls":[
                   "TCAT-AS-000530"
                ]
             },
             {
                "id":"controls/TCAT-AS-000540.rb",
                "controls":[
                   "TCAT-AS-000540"
                ]
             },
             {
                "id":"controls/TCAT-AS-000550.rb",
                "controls":[
                   "TCAT-AS-000550"
                ]
             },
             {
                "id":"controls/TCAT-AS-000560.rb",
                "controls":[
                   "TCAT-AS-000560"
                ]
             },
             {
                "id":"controls/TCAT-AS-000570.rb",
                "controls":[
                   "TCAT-AS-000570"
                ]
             },
             {
                "id":"controls/TCAT-AS-000580.rb",
                "controls":[
                   "TCAT-AS-000580"
                ]
             },
             {
                "id":"controls/TCAT-AS-000590.rb",
                "controls":[
                   "TCAT-AS-000590"
                ]
             },
             {
                "id":"controls/TCAT-AS-000600.rb",
                "controls":[
                   "TCAT-AS-000600"
                ]
             },
             {
                "id":"controls/TCAT-AS-000610.rb",
                "controls":[
                   "TCAT-AS-000610"
                ]
             },
             {
                "id":"controls/TCAT-AS-000630.rb",
                "controls":[
                   "TCAT-AS-000630"
                ]
             },
             {
                "id":"controls/TCAT-AS-000680.rb",
                "controls":[
                   "TCAT-AS-000680"
                ]
             },
             {
                "id":"controls/TCAT-AS-000690.rb",
                "controls":[
                   "TCAT-AS-000690"
                ]
             },
             {
                "id":"controls/TCAT-AS-000700.rb",
                "controls":[
                   "TCAT-AS-000700"
                ]
             },
             {
                "id":"controls/TCAT-AS-000710.rb",
                "controls":[
                   "TCAT-AS-000710"
                ]
             },
             {
                "id":"controls/TCAT-AS-000720.rb",
                "controls":[
                   "TCAT-AS-000720"
                ]
             },
             {
                "id":"controls/TCAT-AS-000750.rb",
                "controls":[
                   "TCAT-AS-000750"
                ]
             },
             {
                "id":"controls/TCAT-AS-000780.rb",
                "controls":[
                   "TCAT-AS-000780"
                ]
             },
             {
                "id":"controls/TCAT-AS-000790.rb",
                "controls":[
                   "TCAT-AS-000790"
                ]
             },
             {
                "id":"controls/TCAT-AS-000800.rb",
                "controls":[
                   "TCAT-AS-000800"
                ]
             },
             {
                "id":"controls/TCAT-AS-000810.rb",
                "controls":[
                   "TCAT-AS-000810"
                ]
             },
             {
                "id":"controls/TCAT-AS-000820.rb",
                "controls":[
                   "TCAT-AS-000820"
                ]
             },
             {
                "id":"controls/TCAT-AS-000840.rb",
                "controls":[
                   "TCAT-AS-000840"
                ]
             },
             {
                "id":"controls/TCAT-AS-000860.rb",
                "controls":[
                   "TCAT-AS-000860"
                ]
             },
             {
                "id":"controls/TCAT-AS-000920.rb",
                "controls":[
                   "TCAT-AS-000920"
                ]
             },
             {
                "id":"controls/TCAT-AS-000930.rb",
                "controls":[
                   "TCAT-AS-000930"
                ]
             },
             {
                "id":"controls/TCAT-AS-000940.rb",
                "controls":[
                   "TCAT-AS-000940"
                ]
             },
             {
                "id":"controls/TCAT-AS-000950.rb",
                "controls":[
                   "TCAT-AS-000950"
                ]
             },
             {
                "id":"controls/TCAT-AS-000970.rb",
                "controls":[
                   "TCAT-AS-000970"
                ]
             },
             {
                "id":"controls/TCAT-AS-001020.rb",
                "controls":[
                   "TCAT-AS-001020"
                ]
             },
             {
                "id":"controls/TCAT-AS-001030.rb",
                "controls":[
                   "TCAT-AS-001030"
                ]
             },
             {
                "id":"controls/TCAT-AS-001040.rb",
                "controls":[
                   "TCAT-AS-001040"
                ]
             },
             {
                "id":"controls/TCAT-AS-001050.rb",
                "controls":[
                   "TCAT-AS-001050"
                ]
             },
             {
                "id":"controls/TCAT-AS-001060.rb",
                "controls":[
                   "TCAT-AS-001060"
                ]
             },
             {
                "id":"controls/TCAT-AS-001070.rb",
                "controls":[
                   "TCAT-AS-001070"
                ]
             },
             {
                "id":"controls/TCAT-AS-001080.rb",
                "controls":[
                   "TCAT-AS-001080"
                ]
             },
             {
                "id":"controls/TCAT-AS-001200.rb",
                "controls":[
                   "TCAT-AS-001200"
                ]
             },
             {
                "id":"controls/TCAT-AS-001220.rb",
                "controls":[
                   "TCAT-AS-001220"
                ]
             },
             {
                "id":"controls/TCAT-AS-001230.rb",
                "controls":[
                   "TCAT-AS-001230"
                ]
             },
             {
                "id":"controls/TCAT-AS-001240.rb",
                "controls":[
                   "TCAT-AS-001240"
                ]
             },
             {
                "id":"controls/TCAT-AS-001250.rb",
                "controls":[
                   "TCAT-AS-001250"
                ]
             },
             {
                "id":"controls/TCAT-AS-001260.rb",
                "controls":[
                   "TCAT-AS-001260"
                ]
             },
             {
                "id":"controls/TCAT-AS-001270.rb",
                "controls":[
                   "TCAT-AS-001270"
                ]
             },
             {
                "id":"controls/TCAT-AS-001280.rb",
                "controls":[
                   "TCAT-AS-001280"
                ]
             },
             {
                "id":"controls/TCAT-AS-001290.rb",
                "controls":[
                   "TCAT-AS-001290"
                ]
             },
             {
                "id":"controls/TCAT-AS-001300.rb",
                "controls":[
                   "TCAT-AS-001300"
                ]
             },
             {
                "id":"controls/TCAT-AS-001320.rb",
                "controls":[
                   "TCAT-AS-001320"
                ]
             },
             {
                "id":"controls/TCAT-AS-001330.rb",
                "controls":[
                   "TCAT-AS-001330"
                ]
             },
             {
                "id":"controls/TCAT-AS-001380.rb",
                "controls":[
                   "TCAT-AS-001380"
                ]
             },
             {
                "id":"controls/TCAT-AS-001390.rb",
                "controls":[
                   "TCAT-AS-001390"
                ]
             },
             {
                "id":"controls/TCAT-AS-001430.rb",
                "controls":[
                   "TCAT-AS-001430"
                ]
             },
             {
                "id":"controls/TCAT-AS-001440.rb",
                "controls":[
                   "TCAT-AS-001440"
                ]
             },
             {
                "id":"controls/TCAT-AS-001450.rb",
                "controls":[
                   "TCAT-AS-001450"
                ]
             },
             {
                "id":"controls/TCAT-AS-001460.rb",
                "controls":[
                   "TCAT-AS-001460"
                ]
             },
             {
                "id":"controls/TCAT-AS-001470.rb",
                "controls":[
                   "TCAT-AS-001470"
                ]
             },
             {
                "id":"controls/TCAT-AS-001480.rb",
                "controls":[
                   "TCAT-AS-001480"
                ]
             },
             {
                "id":"controls/TCAT-AS-001490.rb",
                "controls":[
                   "TCAT-AS-001490"
                ]
             },
             {
                "id":"controls/TCAT-AS-001500.rb",
                "controls":[
                   "TCAT-AS-001500"
                ]
             },
             {
                "id":"controls/TCAT-AS-001550.rb",
                "controls":[
                   "TCAT-AS-001550"
                ]
             },
             {
                "id":"controls/TCAT-AS-001560.rb",
                "controls":[
                   "TCAT-AS-001560"
                ]
             },
             {
                "id":"controls/TCAT-AS-001570.rb",
                "controls":[
                   "TCAT-AS-001570"
                ]
             },
             {
                "id":"controls/TCAT-AS-001580.rb",
                "controls":[
                   "TCAT-AS-001580"
                ]
             },
             {
                "id":"controls/TCAT-AS-001590.rb",
                "controls":[
                   "TCAT-AS-001590"
                ]
             },
             {
                "id":"controls/TCAT-AS-001592.rb",
                "controls":[
                   "TCAT-AS-001592"
                ]
             },
             {
                "id":"controls/TCAT-AS-001594.rb",
                "controls":[
                   "TCAT-AS-001594"
                ]
             },
             {
                "id":"controls/TCAT-AS-001596.rb",
                "controls":[
                   "TCAT-AS-001596"
                ]
             },
             {
                "id":"controls/TCAT-AS-001600.rb",
                "controls":[
                   "TCAT-AS-001600"
                ]
             },
             {
                "id":"controls/TCAT-AS-001610.rb",
                "controls":[
                   "TCAT-AS-001610"
                ]
             },
             {
                "id":"controls/TCAT-AS-001640.rb",
                "controls":[
                   "TCAT-AS-001640"
                ]
             },
             {
                "id":"controls/TCAT-AS-001660.rb",
                "controls":[
                   "TCAT-AS-001660"
                ]
             },
             {
                "id":"controls/TCAT-AS-001670.rb",
                "controls":[
                   "TCAT-AS-001670"
                ]
             },
             {
                "id":"controls/TCAT-AS-001680.rb",
                "controls":[
                   "TCAT-AS-001680"
                ]
             },
             {
                "id":"controls/TCAT-AS-001690.rb",
                "controls":[
                   "TCAT-AS-001690"
                ]
             },
             {
                "id":"controls/TCAT-AS-001700.rb",
                "controls":[
                   "TCAT-AS-001700"
                ]
             },
             {
                "id":"controls/TCAT-AS-001710.rb",
                "controls":[
                   "TCAT-AS-001710"
                ]
             },
             {
                "id":"controls/TCAT-AS-001720.rb",
                "controls":[
                   "TCAT-AS-001720"
                ]
             },
             {
                "id":"controls/TCAT-AS-001730.rb",
                "controls":[
                   "TCAT-AS-001730"
                ]
             }
          ],
          "controls":[
             {
                "id":"TCAT-AS-000010",
                "title":"The number of allowed simultaneous sessions to the manager application must be limited.",
                "desc":"The manager application provides configuration access to the Tomcat server. Access to the manager \n  application must be limited and that includes the number of sessions allowed to access the management application. \n  A balance must be struck between the number of simultaneous connections allowed to the management application \n  and the number of authorized admins requiring access at any given time. Determine the number of authorized \n  admins requiring simultaneous access and increase the number of allowed simultaneous sessions by a small percentage \n  in order to help prevent potential lockouts. Document that value in the System Security Plan.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The manager application provides configuration access to the Tomcat server. Access to the manager \n  application must be limited and that includes the number of sessions allowed to access the management application. \n  A balance must be struck between the number of simultaneous connections allowed to the management application \n  and the number of authorized admins requiring access at any given time. Determine the number of authorized \n  admins requiring simultaneous access and increase the number of allowed simultaneous sessions by a small percentage \n  in order to help prevent potential lockouts. Document that value in the System Security Plan."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000001-AS-000001",
                   "gid":"TCAT-AS-000010",
                   "rid":"TCAT-AS-000010_rule",
                   "stig_id":"TCAT-AS-000010",
                   "cci":"CCI-000054",
                   "nist":[
                      "AC-10",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"If the manager application is not in use or has been deleted from the system, this is not a finding. \n  From the Tomcat server as an elevated user run the following command:\n  sudo grep -i maxactivesessions $CATALINA_HOME/webapps/manager/ META-INF/context.xml \n  If the maxActiveSesions setting is not configured according to the number of connections defined in the SSP, this is a finding.",
                   "fix":"Determine the number of authorized admins requiring simultaneous access and increase the number of allowed \n  simultaneous sessions by a small percentage in order to address potential lockout scenarios. \n  Document that value in the System Security Plan.\n  Review the maxActiveSessions setting in the $CATALINA_HOME/webapps/manager/ META-INF/context.xml configuration file. \n  Configure maxActiveSessions setting according to admin access requirements defined in the SSP.\n  EXAMPLE:\n  <Manager … maxActiveSessions=\"10\" />"
                },
                "code":"control \"TCAT-AS-000010\" do\r\n  title \"The number of allowed simultaneous sessions to the manager application must be limited.\"\r\n  desc  \"The manager application provides configuration access to the Tomcat server. Access to the manager \r\n  application must be limited and that includes the number of sessions allowed to access the management application. \r\n  A balance must be struck between the number of simultaneous connections allowed to the management application \r\n  and the number of authorized admins requiring access at any given time. Determine the number of authorized \r\n  admins requiring simultaneous access and increase the number of allowed simultaneous sessions by a small percentage \r\n  in order to help prevent potential lockouts. Document that value in the System Security Plan.\"\r\n  impact 0.3\r\n  tag \"gtitle\": \"SRG-APP-000001-AS-000001\"\r\n  tag \"gid\": \"TCAT-AS-000010\"\r\n  tag \"rid\": \"TCAT-AS-000010_rule\"\r\n  tag \"stig_id\": \"TCAT-AS-000010\"\r\n  tag \"cci\": \"CCI-000054\"\r\n  tag \"nist\": [\"AC-10\", \"Rev_4\"]\r\n  tag \"false_negatives\": nil\r\n  tag \"false_positives\": nil\r\n  tag \"documentable\": false\r\n  tag \"mitigations\": nil\r\n  tag \"severity_override_guidance\": false\r\n  tag \"potential_impacts\": nil\r\n  tag \"third_party_tools\": nil\r\n  tag \"mitigation_controls\": nil\r\n  tag \"responsibility\": nil\r\n  tag \"ia_controls\": nil\r\n  tag \"check\": \"If the manager application is not in use or has been deleted from the system, this is not a finding. \r\n  From the Tomcat server as an elevated user run the following command:\r\n  sudo grep -i maxactivesessions $CATALINA_HOME/webapps/manager/ META-INF/context.xml \r\n  If the maxActiveSesions setting is not configured according to the number of connections defined in the SSP, this is a finding.\"\r\n  tag \"fix\": \"Determine the number of authorized admins requiring simultaneous access and increase the number of allowed \r\n  simultaneous sessions by a small percentage in order to address potential lockout scenarios. \r\n  Document that value in the System Security Plan.\r\n  Review the maxActiveSessions setting in the $CATALINA_HOME/webapps/manager/ META-INF/context.xml configuration file. \r\n  Configure maxActiveSessions setting according to admin access requirements defined in the SSP.\r\n  EXAMPLE:\r\n  <Manager … maxActiveSessions=\\\"10\\\" />\"\r\n\r\n  tomcat_manager_web_file = \"$CATALINA_HOME/webapps/manager/WEB-INF/web.xml\"\r\n  max_active_sessions = xml(tomcat_manager_web_file[\"//manager/@maxActiveSessions\"]) \r\n\r\n  only_if('Manager application is not installed. Skipping this check.') do \r\n    file(tomcat_manager_web_file).exist?\r\n  end\r\n  \r\n  describe \"This is a manual control\" do\r\n    skip \"Check the maxActiveSessions: #{max_active_sessions} output and compare with your SSP\"\r\n  end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000010.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"No-op",
                      "run_time":1.1685e-05,
                      "start_time":"2020-06-17T00:47:04+00:00",
                      "resource":"No-op",
                      "skip_message":"Skipped control due to only_if condition: Manager application is not installed. Skipping this check."
                   }
                ]
             },
             {
                "id":"TCAT-AS-000020",
                "title":"Secured connectors must be configured to use strong encryption ciphers.",
                "desc":"The Tomcat <Connector> element controls the SSL/TLS protocol and the associated ciphers used. \n    If a strong cipher is not selected, an attacker may be able to circumvent encryption protections \n    that are configured for the connector. Strong ciphers must be employed when configuring a secured connector. \n\n    The configuration attribute and its values depend on what HTTPS implementation the user is utilizing. \n    The user may be utilizing either Java-based implementation (aka JSSE) with BIO and NIO connectors or \n    OpenSSL-based implementation with APR connector.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The Tomcat <Connector> element controls the SSL/TLS protocol and the associated ciphers used. \n    If a strong cipher is not selected, an attacker may be able to circumvent encryption protections \n    that are configured for the connector. Strong ciphers must be employed when configuring a secured connector. \n\n    The configuration attribute and its values depend on what HTTPS implementation the user is utilizing. \n    The user may be utilizing either Java-based implementation (aka JSSE) with BIO and NIO connectors or \n    OpenSSL-based implementation with APR connector."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000014-AS-000009",
                   "gid":"TCAT-AS-000020",
                   "rid":"TCAT-AS-000020_rule",
                   "stig_id":"TCAT-AS-000020",
                   "cci":"CCI-000068",
                   "nist":[
                      "AC-17",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo grep -i ciphers $CATALINA_HOME/conf/server.xml. \n    Examine each <Connector> statement that is not a redirect to a secure port. \n    If insecure ciphers are specified, this is a finding.",
                   "fix":"As a privileged user on the Tomcat server, edit the $CATALINA_HOME/conf/server.xml \n    and modify the <Connector> …</Connector> element. Add the \"SSLEnabledProtocols=\" flag to the \n    connector or modify the existing flag. Set SSLEnabledProtocols=\"TLS1.2\". Save the server.xml \n    file and restart Tomcat:\n    sudo systemctl restart tomcat\n    sudo systemctl reload-daemon"
                },
                "code":"control \"TCAT-AS-000020\" do\r\n    title \"Secured connectors must be configured to use strong encryption ciphers.\"\r\n    desc  \"The Tomcat <Connector> element controls the SSL/TLS protocol and the associated ciphers used. \r\n    If a strong cipher is not selected, an attacker may be able to circumvent encryption protections \r\n    that are configured for the connector. Strong ciphers must be employed when configuring a secured connector. \r\n\r\n    The configuration attribute and its values depend on what HTTPS implementation the user is utilizing. \r\n    The user may be utilizing either Java-based implementation (aka JSSE) with BIO and NIO connectors or \r\n    OpenSSL-based implementation with APR connector.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000014-AS-000009\"\r\n    tag \"gid\": \"TCAT-AS-000020\"\r\n    tag \"rid\": \"TCAT-AS-000020_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000020\"\r\n    tag \"cci\": \"CCI-000068\"\r\n    tag \"nist\": [\"AC-17\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo grep -i ciphers $CATALINA_HOME/conf/server.xml. \r\n    Examine each <Connector> statement that is not a redirect to a secure port. \r\n    If insecure ciphers are specified, this is a finding.\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server, edit the $CATALINA_HOME/conf/server.xml \r\n    and modify the <Connector> …</Connector> element. Add the \\\"SSLEnabledProtocols=\\\" flag to the \r\n    connector or modify the existing flag. Set SSLEnabledProtocols=\\\"TLS1.2\\\". Save the server.xml \r\n    file and restart Tomcat:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl reload-daemon\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    connectors_count = tomcat_server_file[\"//Connector\"].count \r\n    ssl_enabled_protocols = tomcat_server_file[\"//Connector/@SSLEnabledProtocols\"]\r\n\r\n    describe connectors_count do \r\n        puts \"Each connector should have SSLEnabledProtocols attribute\"\r\n        it { should eq ssl_enabled_protocols.count }\r\n    end\r\n\r\n    ssl_enabled_protocols.each do |item|\r\n        describe item do \r\n            it { should cmp \"TLSv1.2\" }\r\n        end\r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000020.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000020.rb:1 ",
                      "run_time":0.001798552,
                      "start_time":"2020-06-17T00:47:04+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000030",
                "title":"HTTP Strict Transport Security (HSTS) must be enabled.",
                "desc":"HTTP Strict Transport Security (HSTS) instructs web browsers to only use secure connections \n    for all future requests when communicating with a web site. Doing so helps prevent SSL protocol \n    attacks, SSL stripping, cookie hijacking, and other attempts to circumvent SSL protection.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"HTTP Strict Transport Security (HSTS) instructs web browsers to only use secure connections \n    for all future requests when communicating with a web site. Doing so helps prevent SSL protocol \n    attacks, SSL stripping, cookie hijacking, and other attempts to circumvent SSL protection."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000015-AS-000010",
                   "gid":"TCAT-AS-000030",
                   "rid":"TCAT-AS-000030_rule",
                   "stig_id":"TCAT-AS-000030",
                   "cci":"CCI-001453",
                   "nist":[
                      "AC-17",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo grep -i -A5 -B8 hstsEnable $CATALINA_HOME/conf/web.xml file. If the httpHeaderSecurity \n    filter is commented out or if hstsEnable is not set to \"true\", this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, edit the web.xml file:\n    sudo nano $CATALINA_HOME/conf/web.xml file. Uncomment the existing httpHeaderSecurity \n    filter section or create the filter section using the following code:\n    <filter>\n    <filter-name>httpHeaderSecurity</filter-name>\n    <filter-class>org.apache.catalina.filters.HttpHeaderSecurityFilter</filter-class>\n    <async-supported>true</async-supported>\n    <hstsEnabled>true</hstsEnabled>\n    </filter>"
                },
                "code":"control \"TCAT-AS-000030\" do\r\n    title \"HTTP Strict Transport Security (HSTS) must be enabled.\"\r\n    desc  \"HTTP Strict Transport Security (HSTS) instructs web browsers to only use secure connections \r\n    for all future requests when communicating with a web site. Doing so helps prevent SSL protocol \r\n    attacks, SSL stripping, cookie hijacking, and other attempts to circumvent SSL protection.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000015-AS-000010\"\r\n    tag \"gid\": \"TCAT-AS-000030\"\r\n    tag \"rid\": \"TCAT-AS-000030_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000030\"\r\n    tag \"cci\": \"CCI-001453\"\r\n    tag \"nist\": [\"AC-17\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo grep -i -A5 -B8 hstsEnable $CATALINA_HOME/conf/web.xml file. If the httpHeaderSecurity \r\n    filter is commented out or if hstsEnable is not set to \\\"true\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, edit the web.xml file:\r\n    sudo nano $CATALINA_HOME/conf/web.xml file. Uncomment the existing httpHeaderSecurity \r\n    filter section or create the filter section using the following code:\r\n    <filter>\r\n    <filter-name>httpHeaderSecurity</filter-name>\r\n    <filter-class>org.apache.catalina.filters.HttpHeaderSecurityFilter</filter-class>\r\n    <async-supported>true</async-supported>\r\n    <hstsEnabled>true</hstsEnabled>\r\n    </filter>\"\r\n  \r\n    tomcat_web_file = xml(\"$CATALINA_HOME/conf/web.xml\")\r\n    hsts = tomcat_web_file[\"//hstsEnabled\"]\r\n\r\n    describe hsts do\r\n        it { should cmp \"true\" }\r\n    end\r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000030.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000030.rb:1 ",
                      "run_time":0.001687787,
                      "start_time":"2020-06-17T00:47:04+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000040",
                "title":"TLS 1.2 must be used on secured HTTP connectors.",
                "desc":"Using older versions of TLS introduces security vulnerabilities that exist in the older versions of the protocol. \n    Tomcat by default will use all available versions of the SSL/TLS protocols unless the version is explicitly defined in \n    the SSL configuration attribute for the associated connector. This introduces the opportunity for the client to negotiate \n    the use of an older protocol version and increases the risk of compromise of the Tomcat server. All connectors must use TLS 1.2.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Using older versions of TLS introduces security vulnerabilities that exist in the older versions of the protocol. \n    Tomcat by default will use all available versions of the SSL/TLS protocols unless the version is explicitly defined in \n    the SSL configuration attribute for the associated connector. This introduces the opportunity for the client to negotiate \n    the use of an older protocol version and increases the risk of compromise of the Tomcat server. All connectors must use TLS 1.2."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000015-AS-000010",
                   "gid":"TCAT-AS-000040",
                   "rid":"TCAT-AS-000040_rule",
                   "stig_id":"TCAT-AS-000040",
                   "cci":"CCI-001453",
                   "nist":[
                      "AC-17",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command: \n    sudo cat $CATALINA_HOME/conf/server.xml. \n    Examine each <Connector> </Connector> statement. For every HTTP protocol connector: Verify \n    the SSLEnabledProtocols=\"TLSv1.2\" flag is set on each connector. If the SSLEnabledProtocols \n    setting is not set to TLSv1.2 or greater, this is a finding.",
                   "fix":"As a privileged user on the Tomcat server, edit the $CATALINA_HOME/conf/server.xml and modify the \n    <Connector> </Connector> element. Add the \"SSLEnabledProtocols=\" flag to the connector or modify the existing flag. \n    Set SSLEnabledProtocols=\"TLS1.2\". Save the server.xml file and restart Tomcat:\n    sudo systemctl restart tomcat\n    sudo systemctl reload-daemon"
                },
                "code":"control \"TCAT-AS-000040\" do\r\n    title \"TLS 1.2 must be used on secured HTTP connectors.\"\r\n    desc  \"Using older versions of TLS introduces security vulnerabilities that exist in the older versions of the protocol. \r\n    Tomcat by default will use all available versions of the SSL/TLS protocols unless the version is explicitly defined in \r\n    the SSL configuration attribute for the associated connector. This introduces the opportunity for the client to negotiate \r\n    the use of an older protocol version and increases the risk of compromise of the Tomcat server. All connectors must use TLS 1.2.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000015-AS-000010\"\r\n    tag \"gid\": \"TCAT-AS-000040\"\r\n    tag \"rid\": \"TCAT-AS-000040_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000040\"\r\n    tag \"cci\": \"CCI-001453\"\r\n    tag \"nist\": [\"AC-17\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command: \r\n    sudo cat $CATALINA_HOME/conf/server.xml. \r\n    Examine each <Connector> </Connector> statement. For every HTTP protocol connector: Verify \r\n    the SSLEnabledProtocols=\\\"TLSv1.2\\\" flag is set on each connector. If the SSLEnabledProtocols \r\n    setting is not set to TLSv1.2 or greater, this is a finding.\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server, edit the $CATALINA_HOME/conf/server.xml and modify the \r\n    <Connector> </Connector> element. Add the \\\"SSLEnabledProtocols=\\\" flag to the connector or modify the existing flag. \r\n    Set SSLEnabledProtocols=\\\"TLS1.2\\\". Save the server.xml file and restart Tomcat:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl reload-daemon\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    connectors_count = tomcat_server_file[\"//Connector\"].count \r\n    ssl_enabled_protocols = tomcat_server_file[\"//Connector/@SSLEnabledProtocols\"]\r\n\r\n    describe connectors_count do \r\n        puts \"Each connector should have SSLEnabledProtocols attribute\"\r\n        it { should eq ssl_enabled_protocols.count }\r\n    end\r\n\r\n    ssl_enabled_protocols.each do |item|\r\n        describe item do \r\n            it { should cmp \"TLSv1.2\" }\r\n        end\r\n    end\r\n     \r\nend\r\n",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000040.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000040.rb:1 ",
                      "run_time":0.001524474,
                      "start_time":"2020-06-17T00:47:04+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000050",
                "title":"AccessLogValve must be configured for each application context.",
                "desc":"Tomcat has the ability to host multiple contexts (applications) on one physical server \n    by using the <Host><Context> element. This allows the admin to specify audit log settings on a per application basis.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat has the ability to host multiple contexts (applications) on one physical server \n    by using the <Host><Context> element. This allows the admin to specify audit log settings on a per application basis."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000016-AS-000013",
                   "gid":"TCAT-AS-000050",
                   "rid":"TCAT-AS-000050_rule",
                   "stig_id":"TCAT-AS-000050",
                   "cci":"CCI-000067",
                   "nist":[
                      "AC-17",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server: \n    Edit the $CATALINA_HOME\u000fnf erver.xml file.\n    Review for all <Host> elements. If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> \n    element is not defined for each <Host> element, this is a finding.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\" unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n    prefix=\"localhost_access_log\" suffix=\".txt\" pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME\u000fnf erver.xml file. Create a <Valve> element that is nested beneath \n    the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\" unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\" \n    prefix=\"localhost_access_log\" suffix=\".txt\" pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    \n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000050\" do\r\n    title \"AccessLogValve must be configured for each application context.\"\r\n    desc  \"Tomcat has the ability to host multiple contexts (applications) on one physical server \r\n    by using the <Host><Context> element. This allows the admin to specify audit log settings on a per application basis.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000016-AS-000013\"\r\n    tag \"gid\": \"TCAT-AS-000050\"\r\n    tag \"rid\": \"TCAT-AS-000050_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000050\"\r\n    tag \"cci\": \"CCI-000067\"\r\n    tag \"nist\": [\"AC-17\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server: \r\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\r\n    Review for all <Host> elements. If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> \r\n    element is not defined for each <Host> element, this is a finding.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\" unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n    prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\" pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\conf\\server.xml file. Create a <Valve> element that is nested beneath \r\n    the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\" unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\" \r\n    prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\" pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    \r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n    \r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\") \r\n    hosts = tcat[\"//Host\"].count \r\n    valves = tcat[\"//Valve\"].count  \r\n    describe hosts do \r\n        it { should eq valves } \r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000050.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000050.rb:1 ",
                      "run_time":0.005841694,
                      "start_time":"2020-06-17T00:47:04+00:00",
                      "message":"undefined local variable or method `tcat' for #<Inspec::Rule:0x00000000041cbed0>",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000060",
                "title":"Default password for keystore must be changed.",
                "desc":"Tomcat currently operates only on JKS, PKCS11, or PKCS12 format keystores. The JKS format is \n    Java's standard \"Java KeyStore\" format, and is the format created by the keytool command-line utility \n    which is included in the JDK. The PKCS12 format is an internet standard, and is managed using OpenSSL or \n    Microsoft's Key-Manager. This requirement only applies to JKS keystores. When a new JKS keystore is created, \n    if a password is not specified during creation the default password used by Tomcat is \"changeit\" (all lower-case). \n    If the default password is not changed, the keystore is at risk of compromise.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat currently operates only on JKS, PKCS11, or PKCS12 format keystores. The JKS format is \n    Java's standard \"Java KeyStore\" format, and is the format created by the keytool command-line utility \n    which is included in the JDK. The PKCS12 format is an internet standard, and is managed using OpenSSL or \n    Microsoft's Key-Manager. This requirement only applies to JKS keystores. When a new JKS keystore is created, \n    if a password is not specified during creation the default password used by Tomcat is \"changeit\" (all lower-case). \n    If the default password is not changed, the keystore is at risk of compromise."
                   }
                ],
                "impact":0.7,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000033-AS-000023",
                   "gid":"TCAT-AS-000060",
                   "rid":"TCAT-AS-000060_rule",
                   "stig_id":"TCAT-AS-000060",
                   "cci":"CCI-000213",
                   "nist":[
                      "AC-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command to check the keystore:\n    sudo keytool -list -v \n    When prompted for the keystore password, type \"changeit\". If the contents of the keystore are displayed, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, run the following command:\n    sudo keytool -storepasswd \n    When prompted for the keystore password, select a strong password, minimum 10 characters, mixed case alpha-numeric.\n    Document the password and store in a secured location that is only accessible to authorized personnel."
                },
                "code":"control \"TCAT-AS-000060\" do\r\n    title \"Default password for keystore must be changed.\"\r\n    desc  \"Tomcat currently operates only on JKS, PKCS11, or PKCS12 format keystores. The JKS format is \r\n    Java's standard \\\"Java KeyStore\\\" format, and is the format created by the keytool command-line utility \r\n    which is included in the JDK. The PKCS12 format is an internet standard, and is managed using OpenSSL or \r\n    Microsoft's Key-Manager. This requirement only applies to JKS keystores. When a new JKS keystore is created, \r\n    if a password is not specified during creation the default password used by Tomcat is \\\"changeit\\\" (all lower-case). \r\n    If the default password is not changed, the keystore is at risk of compromise.\"\r\n    impact 0.7\r\n    tag \"gtitle\": \"SRG-APP-000033-AS-000023\"\r\n    tag \"gid\": \"TCAT-AS-000060\"\r\n    tag \"rid\": \"TCAT-AS-000060_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000060\"\r\n    tag \"cci\": \"CCI-000213\"\r\n    tag \"nist\": [\"AC-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command to check the keystore:\r\n    sudo keytool -list -v \r\n    When prompted for the keystore password, type \\\"changeit\\\". If the contents of the keystore are displayed, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, run the following command:\r\n    sudo keytool -storepasswd \r\n    When prompted for the keystore password, select a strong password, minimum 10 characters, mixed case alpha-numeric.\r\n    Document the password and store in a secured location that is only accessible to authorized personnel.\"\r\n\r\n    keytool = command(\"keytool -list -v\")\r\n    \r\n    describe keytool do\r\n        its('exit_status') { should eq 0 }\r\n    end\r\n\r\n    if keytool.exist?\r\n        describe command(\"keytool -list -v -storepass changeit\") do\r\n            its('exist_status') { should eq 0 }\r\n        end\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000060.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Command: `keytool -list -v` exit_status is expected to eq 0",
                      "run_time":0.561879433,
                      "start_time":"2020-06-17T00:47:04+00:00",
                      "message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000070",
                "title":"Cookies must have secure flag set.",
                "desc":"It is possible to steal or manipulate web application session and cookies without having a secure cookie. \n    Configuring the secure flag injects the setting into the response header. The $CATALINA_HOME/conf/web.xml file \n    controls how all applications handle cookies via the <cookie-config> element.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"It is possible to steal or manipulate web application session and cookies without having a secure cookie. \n    Configuring the secure flag injects the setting into the response header. The $CATALINA_HOME/conf/web.xml file \n    controls how all applications handle cookies via the <cookie-config> element."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000033-AS-000024",
                   "gid":"TCAT-AS-000070",
                   "rid":"TCAT-AS-000070_rule",
                   "stig_id":"TCAT-AS-000070",
                   "cci":"CCI-000213",
                   "nist":[
                      "AC-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo grep -i -B10 -A1 /cookie-config $CATALINA_HOME/conf/web.xml If the command returns no results or if \n    the <secure> element is not set to true, this is a finding.\n    EXAMPLE:\n    <session-config>\n      <session-timeout>15</session-timeout>\n        <cookie-config>\n          <http-only>true</http-only>\n            <secure>true</secure>\n        </cookie-config>\n    </session-config>",
                   "fix":"From the Tomcat server console as a privileged user: Edit the $CATALINA_HOME/conf/web.xml.\n    If the cookie-config section does not exist it must be added. Add or modify the <secure> setting and set to true.\n    EXAMPLE:\n    <session-config>\n      <session-timeout>15</session-timeout>\n        <cookie-config>\n          <http-only>true</http-only>\n            <secure>true</secure>\n        </cookie-config>\n    </session-config>"
                },
                "code":"control \"TCAT-AS-000070\" do\r\n    title \"Cookies must have secure flag set.\"\r\n    desc  \"It is possible to steal or manipulate web application session and cookies without having a secure cookie. \r\n    Configuring the secure flag injects the setting into the response header. The $CATALINA_HOME/conf/web.xml file \r\n    controls how all applications handle cookies via the <cookie-config> element.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000033-AS-000024\"\r\n    tag \"gid\": \"TCAT-AS-000070\"\r\n    tag \"rid\": \"TCAT-AS-000070_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000070\"\r\n    tag \"cci\": \"CCI-000213\"\r\n    tag \"nist\": [\"AC-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo grep -i -B10 -A1 \\/cookie-config $CATALINA_HOME/conf/web.xml If the command returns no results or if \r\n    the <secure> element is not set to true, this is a finding.\r\n    EXAMPLE:\r\n    <session-config>\r\n      <session-timeout>15</session-timeout>\r\n        <cookie-config>\r\n          <http-only>true</http-only>\r\n            <secure>true</secure>\r\n        </cookie-config>\r\n    </session-config>\"\r\n    tag \"fix\": \"From the Tomcat server console as a privileged user: Edit the $CATALINA_HOME/conf/web.xml.\r\n    If the cookie-config section does not exist it must be added. Add or modify the <secure> setting and set to true.\r\n    EXAMPLE:\r\n    <session-config>\r\n      <session-timeout>15</session-timeout>\r\n        <cookie-config>\r\n          <http-only>true</http-only>\r\n            <secure>true</secure>\r\n        </cookie-config>\r\n    </session-config>\"\r\n  \r\n    tomcat_web_file = xml(\"$CATALINA_HOME/conf/web.xml\") \r\n    secure_cookies = tomcat_web_file[\"web-app/session-config/cookie-config/secure\"] \r\n    \r\n    describe secure_cookies do \r\n      it { should cmp 'true' } \r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000070.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000070.rb:1 ",
                      "run_time":0.001638803,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined method `node_type' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000080",
                "title":"Cookies must have http-only flag set.",
                "desc":"It is possible to steal or manipulate web application session and cookies without having a secure cookie. \n    Configuring the secure flag injects the setting into the response header. The $CATALINA_HOME/conf/web.xml file \n    controls how all applications handle cookies via the <cookie-config> element.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"It is possible to steal or manipulate web application session and cookies without having a secure cookie. \n    Configuring the secure flag injects the setting into the response header. The $CATALINA_HOME/conf/web.xml file \n    controls how all applications handle cookies via the <cookie-config> element."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000033-AS-000024",
                   "gid":"TCAT-AS-000080",
                   "rid":"TCAT-AS-000080_rule",
                   "stig_id":"TCAT-AS-000080",
                   "cci":"CCI-000213",
                   "nist":[
                      "AC-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo grep -i -B10 -A1 /cookie-config $CATALINA_HOME/conf/web.xml\n    If the command returns no results or if the <http-only> element is not set to true, this is a finding.\n    EXAMPLE:\n    <session-config>\n      <session-timeout>15</session-timeout>\n      <cookie-config>\n        <http-only>true</http-only>\n        <secure>true</secure>\n      </cookie-config>\n    </session-config>",
                   "fix":"From the Tomcat server console as a privileged user:\n    Edit the $CATALINA_HOME/conf/web.xml.\n    If the cookie-config section does not exist it must be added. Add or modify the <http-only> setting and set to true.\n    EXAMPLE:\n    <session-config>\n      <session-timeout>15</session-timeout>\n        <cookie-config>\n          <http-only>true</http-only>\n            <secure>true</secure>\n        </cookie-config>\n    </session-config>"
                },
                "code":"control \"TCAT-AS-000080\" do\r\n    title \"Cookies must have http-only flag set.\"\r\n    desc  \"It is possible to steal or manipulate web application session and cookies without having a secure cookie. \r\n    Configuring the secure flag injects the setting into the response header. The $CATALINA_HOME/conf/web.xml file \r\n    controls how all applications handle cookies via the <cookie-config> element.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000033-AS-000024\"\r\n    tag \"gid\": \"TCAT-AS-000080\"\r\n    tag \"rid\": \"TCAT-AS-000080_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000080\"\r\n    tag \"cci\": \"CCI-000213\"\r\n    tag \"nist\": [\"AC-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo grep -i -B10 -A1 \\/cookie-config $CATALINA_HOME/conf/web.xml\r\n    If the command returns no results or if the <http-only> element is not set to true, this is a finding.\r\n    EXAMPLE:\r\n    <session-config>\r\n      <session-timeout>15</session-timeout>\r\n      <cookie-config>\r\n        <http-only>true</http-only>\r\n        <secure>true</secure>\r\n      </cookie-config>\r\n    </session-config>\"\r\n    tag \"fix\": \"From the Tomcat server console as a privileged user:\r\n    Edit the $CATALINA_HOME/conf/web.xml.\r\n    If the cookie-config section does not exist it must be added. Add or modify the <http-only> setting and set to true.\r\n    EXAMPLE:\r\n    <session-config>\r\n      <session-timeout>15</session-timeout>\r\n        <cookie-config>\r\n          <http-only>true</http-only>\r\n            <secure>true</secure>\r\n        </cookie-config>\r\n    </session-config>\"\r\n\r\n    tomcat_web_file = xml(\"$CATALINA_HOME/conf/web.xml\") \r\n    secure_cookies = tomcat_web_file[\"web-app/session-config/cookie-config/http-only\"] \r\n    \r\n    describe secure_cookies do \r\n      it { should cmp 'true' } \r\n    end \r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000080.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000080.rb:1 ",
                      "run_time":0.001611523,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined method `node_type' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000090",
                "title":"DefaultServlet must be set to readonly for PUT and DELETE.",
                "desc":"The Default servlet (or DefaultServlet) is a special servlet provided with Tomcat, \n    which is called when no other suitable page is found in a particular folder. The DefaultServlet \n    serves static resources as well as directory listings. The DefaultServlet is declared globally \n    in $CATALINA_BASE/conf/web.xml and by default is configured with the \"readonly\" parameter set to \n    true where HTTP commands like PUT and DELETE are rejected. Changing this to false allows clients to \n    delete or modify static resources on the server and to upload new resources. DefaultServlet readonly \n    must be set to true.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The Default servlet (or DefaultServlet) is a special servlet provided with Tomcat, \n    which is called when no other suitable page is found in a particular folder. The DefaultServlet \n    serves static resources as well as directory listings. The DefaultServlet is declared globally \n    in $CATALINA_BASE/conf/web.xml and by default is configured with the \"readonly\" parameter set to \n    true where HTTP commands like PUT and DELETE are rejected. Changing this to false allows clients to \n    delete or modify static resources on the server and to upload new resources. DefaultServlet readonly \n    must be set to true."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000033-AS-000024",
                   "gid":"TCAT-AS-000090",
                   "rid":"TCAT-AS-000090_rule",
                   "stig_id":"TCAT-AS-000090",
                   "cci":"CCI-000213",
                   "nist":[
                      "AC-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server run the following command:\n    sudo cat $CATALINA_HOME/conf/web.xml |grep -i -A5 -B2 defaultservlet \n    If the \"readonly\" param-value does not exist, this is not a finding.\n    If the \"readonly\" param-value for the \"DefaultServlet\" servlet class = \"false\", this is a finding.",
                   "fix":"From the Tomcat server console as a privileged user:\n    Edit the $CATALINA_HOME/conf/web.xml file. \n    If the \"readonly\" param-value does not exist, it must be created.\n    Change the \"readonly\" param-value for the \"DefaultServlet\" servlet class = \"true\"."
                },
                "code":"control \"TCAT-AS-000090\" do\r\n    title \"DefaultServlet must be set to readonly for PUT and DELETE.\"\r\n    desc  \"The Default servlet (or DefaultServlet) is a special servlet provided with Tomcat, \r\n    which is called when no other suitable page is found in a particular folder. The DefaultServlet \r\n    serves static resources as well as directory listings. The DefaultServlet is declared globally \r\n    in $CATALINA_BASE/conf/web.xml and by default is configured with the \\\"readonly\\\" parameter set to \r\n    true where HTTP commands like PUT and DELETE are rejected. Changing this to false allows clients to \r\n    delete or modify static resources on the server and to upload new resources. DefaultServlet readonly \r\n    must be set to true.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000033-AS-000024\"\r\n    tag \"gid\": \"TCAT-AS-000090\"\r\n    tag \"rid\": \"TCAT-AS-000090_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000090\"\r\n    tag \"cci\": \"CCI-000213\"\r\n    tag \"nist\": [\"AC-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server run the following command:\r\n    sudo cat $CATALINA_HOME/conf/web.xml |grep -i -A5 -B2 defaultservlet \r\n    If the \\\"readonly\\\" param-value does not exist, this is not a finding.\r\n    If the \\\"readonly\\\" param-value for the \\\"DefaultServlet\\\" servlet class = \\\"false\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server console as a privileged user:\r\n    Edit the $CATALINA_HOME/conf/web.xml file. \r\n    If the \\\"readonly\\\" param-value does not exist, it must be created.\r\n    Change the \\\"readonly\\\" param-value for the \\\"DefaultServlet\\\" servlet class = \\\"true\\\".\"\r\n\r\n    tomcat_web_file = xml(\"$CATALINA_HOME/conf/web.xml\") \r\n    servlets = tomcat_web_file[\"//servlet/servlet-name\"]\r\n    check_params = tomcat_web_file[\"//servlet/init-param/param-name\"]\r\n    index = 0\r\n    param_index = 0\r\n\r\n    only_if(\"Run only if DefaultServlet has readonly enabled\") do\r\n        check_params.include?(\"readonly\")\r\n    end \r\n\r\n    if !servlets.empty?\r\n        servlets.each do |servlet|\r\n            for i in 1..servlets.count\r\n                if servlet == \"default\"\r\n                    index+=1\r\n                    break\r\n                end\r\n            end\r\n        end\r\n        params = tomcat_web_file[\"//servlet[#{index}]/init-param/param-name\"]\r\n\r\n        params.each do |param|\r\n            for i in 1..params.count\r\n                if param == \"readonly\"\r\n                    index+=1\r\n                    break\r\n                end\r\n            end\r\n        end\r\n\r\n        readonly = tomcat_web_file[\"//servlet[1]/init-param[#{param_index}]/param-value\"]\r\n        describe readonly do \r\n            it { should cmp \"true\" }\r\n        end\r\n    end \r\n    \r\nend\r\n",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000090.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000090.rb:1 ",
                      "run_time":0.001585414,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000100",
                "title":"Connectors must be secured.",
                "desc":"The unencrypted HTTP protocol does not protect data from interception or alteration which can subject \n    users to eavesdropping, tracking, and the modification of received data. To secure an HTTP connector, \n    both the secure and scheme flags must be set.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The unencrypted HTTP protocol does not protect data from interception or alteration which can subject \n    users to eavesdropping, tracking, and the modification of received data. To secure an HTTP connector, \n    both the secure and scheme flags must be set."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000033-AS-000024",
                   "gid":"TCAT-AS-000100",
                   "rid":"TCAT-AS-000100_rule",
                   "stig_id":"TCAT-AS-000100",
                   "cci":"CCI-000213",
                   "nist":[
                      "AC-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo cat $CATALINA_HOME/conf/server.xml. \n    Examine each <Connector/> element. For each connector, verify the secure= flag is set to \"true\" and the scheme= flag \n    is set to \"https\" on each connector.If the secure flag is not set to \"true\" and/or the scheme flag is not set \n    to \"https\" for each HTTP connector element, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, edit the server.xml file.\n    sudo nano $CATALINA_HOME/conf/server.xml. \n    Locate each <Connector/> element which is lacking a secure setting.  \n    EXAMPLE Connector:\n    <Connector port=\"8080\" protocol=\"HTTP/1.1\"\n                connectionTimeout=\"20000\"\n                redirectPort=\"443\" />\n    Set or add scheme=\"https\" and secure=\"true\" for each HTTP connector element.\n    EXAMPLE:\n    <Connector port=\"443\" protocol=\"org.apache.coyote.http11.Http11NioProtocol\" SSLEnabled=\"true\"\n        maxThreads=\"150\" scheme=\"https\" secure=\"true\".../>\n    Save the server.xml file and restart Tomcat:\n    sudo systemctl restart tomcat\n    sudo systemctl reload-daemon"
                },
                "code":"control \"TCAT-AS-000100\" do\r\n    title \"Connectors must be secured.\"\r\n    desc  \"The unencrypted HTTP protocol does not protect data from interception or alteration which can subject \r\n    users to eavesdropping, tracking, and the modification of received data. To secure an HTTP connector, \r\n    both the secure and scheme flags must be set.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000033-AS-000024\"\r\n    tag \"gid\": \"TCAT-AS-000100\"\r\n    tag \"rid\": \"TCAT-AS-000100_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000100\"\r\n    tag \"cci\": \"CCI-000213\"\r\n    tag \"nist\": [\"AC-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo cat $CATALINA_HOME/conf/server.xml. \r\n    Examine each <Connector/> element. For each connector, verify the secure= flag is set to \\\"true\\\" and the scheme= flag \r\n    is set to \\\"https\\\" on each connector.If the secure flag is not set to \\\"true\\\" and/or the scheme flag is not set \r\n    to \\\"https\\\" for each HTTP connector element, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, edit the server.xml file.\r\n    sudo nano $CATALINA_HOME/conf/server.xml. \r\n    Locate each <Connector/> element which is lacking a secure setting.  \r\n    EXAMPLE Connector:\r\n    <Connector port=\\\"8080\\\" protocol=\\\"HTTP/1.1\\\"\r\n                connectionTimeout=\\\"20000\\\"\r\n                redirectPort=\\\"443\\\" />\r\n    Set or add scheme=\\\"https\\\" and secure=\\\"true\\\" for each HTTP connector element.\r\n    EXAMPLE:\r\n    <Connector port=\\\"443\\\" protocol=\\\"org.apache.coyote.http11.Http11NioProtocol\\\" SSLEnabled=\\\"true\\\"\r\n        maxThreads=\\\"150\\\" scheme=\\\"https\\\" secure=\\\"true\\\".../>\r\n    Save the server.xml file and restart Tomcat:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl reload-daemon\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    connector_count = tomcat_server_file[\"//Connector\"].count \r\n    secure = tomcat_server_file[\"//Connector/@secure\"]\r\n    scheme = tomcat_server_file[\"//Connector/@scheme\"]\r\n\r\n    describe connector_count do \r\n        it { should cmp secure.count }\r\n        it { should cmp scheme.count }\r\n    end \r\n\r\n    if !secure.empty?\r\n        secure.each do |item|\r\n            describe item do \r\n                it { should cmp \"true\" }\r\n            end \r\n        end\r\n    end\r\n\r\n    if !scheme.empty?\r\n        scheme.each do |item| \r\n            describe item do \r\n                it { should cmp \"https\" } \r\n            end\r\n        end\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000100.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000100.rb:1 ",
                      "run_time":0.001506669,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000110",
                "title":"The Java Security Manager must be enabled.",
                "desc":"The Java SecurityManager is what allows a web browser to run an applet in its own sandbox to prevent untrusted \n    code from accessing files on the local file system, connecting to a host other than the one the applet was loaded from, \n    and so on. In the same way the SecurityManager protects the user from an untrusted applet running in the browser, \n    use of a SecurityManager while running Tomcat can protect the server from trojan servlets, JSPs, JSP beans, tag libraries, \n    or even inadvertent mistakes.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The Java SecurityManager is what allows a web browser to run an applet in its own sandbox to prevent untrusted \n    code from accessing files on the local file system, connecting to a host other than the one the applet was loaded from, \n    and so on. In the same way the SecurityManager protects the user from an untrusted applet running in the browser, \n    use of a SecurityManager while running Tomcat can protect the server from trojan servlets, JSPs, JSP beans, tag libraries, \n    or even inadvertent mistakes."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000033-AS-000024",
                   "gid":"TCAT-AS-000110",
                   "rid":"TCAT-AS-000110_rule",
                   "stig_id":"TCAT-AS-000110",
                   "cci":"CCI-000213",
                   "nist":[
                      "AC-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Identify the tomcat systemd startup file which is usually called \"tomcat.service\" and can be viewed as \n    a link in the /etc/systemd/system/ folder.\n    sudo cat /etc/systemd/system/tomcat.service |grep -i security\n    If the ExecStart parameter does not include the -security flag, this is a finding.",
                   "fix":"As an admin user on the Tomcat server, modify the /etc/systemd/system/tomcat.service file and set the \"ExecStart\" \n    parameter to read:\n    \"ExecStart=/opt/tomcat/bin/startup.sh -security\"\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000110\" do\r\n    title \"The Java Security Manager must be enabled.\"\r\n    desc  \"The Java SecurityManager is what allows a web browser to run an applet in its own sandbox to prevent untrusted \r\n    code from accessing files on the local file system, connecting to a host other than the one the applet was loaded from, \r\n    and so on. In the same way the SecurityManager protects the user from an untrusted applet running in the browser, \r\n    use of a SecurityManager while running Tomcat can protect the server from trojan servlets, JSPs, JSP beans, tag libraries, \r\n    or even inadvertent mistakes.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000033-AS-000024\"\r\n    tag \"gid\": \"TCAT-AS-000110\"\r\n    tag \"rid\": \"TCAT-AS-000110_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000110\"\r\n    tag \"cci\": \"CCI-000213\"\r\n    tag \"nist\": [\"AC-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Identify the tomcat systemd startup file which is usually called \\\"tomcat.service\\\" and can be viewed as \r\n    a link in the /etc/systemd/system/ folder.\r\n    sudo cat /etc/systemd/system/tomcat.service |grep -i security\r\n    If the ExecStart parameter does not include the -security flag, this is a finding.\"\r\n    tag \"fix\": \"As an admin user on the Tomcat server, modify the /etc/systemd/system/tomcat.service file and set the \\\"ExecStart\\\" \r\n    parameter to read:\r\n    \\\"ExecStart=/opt/tomcat/bin/startup.sh -security\\\"\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n    \r\n    tomcat_service_file = \"/etc/systemd/system/tomcat.service\"\r\n    describe command(\"cat #{tomcat_service_file} | grep ExecStart | grep -security\") do\r\n        its('stdout') { should_not eq '' }\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000110.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Command: `cat /etc/systemd/system/tomcat.service | grep ExecStart | grep -security` stdout is expected not to eq \"\"",
                      "run_time":0.259289358,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"\nexpected: value != \"\"\n     got: \"\"\n\n(compared using ==)\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000140",
                "title":"AccessLogValve must be configured for each application context.",
                "desc":"Tomcat has the ability to host multiple contexts (applications) on one physical server by using the \n    <Host><Context> element. This allows the admin to specify audit log settings on a per application basis.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat has the ability to host multiple contexts (applications) on one physical server by using the \n    <Host><Context> element. This allows the admin to specify audit log settings on a per application basis."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000080-AS-000045",
                   "gid":"TCAT-AS-000140",
                   "rid":"TCAT-AS-000140_rule",
                   "stig_id":"TCAT-AS-000140",
                   "cci":"CCI-000166",
                   "nist":[
                      "AU-10",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME\u000fnf erver.xml file.\n    Review for all <Host> elements. If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> element is \n    not defined for each <Host> element, this is a finding.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000140\" do\r\n    title \"AccessLogValve must be configured for each application context.\"\r\n    desc  \"Tomcat has the ability to host multiple contexts (applications) on one physical server by using the \r\n    <Host><Context> element. This allows the admin to specify audit log settings on a per application basis.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000080-AS-000045\"\r\n    tag \"gid\": \"TCAT-AS-000140\"\r\n    tag \"rid\": \"TCAT-AS-000140_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000140\"\r\n    tag \"cci\": \"CCI-000166\"\r\n    tag \"nist\": [\"AU-10\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\r\n    Review for all <Host> elements. If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> element is \r\n    not defined for each <Host> element, this is a finding.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\\\conf\\\\server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\") \r\n    hosts = tcat[\"//Host\"].count \r\n    valves = tcat[\"//Valve\"].count  \r\n    describe hosts do \r\n        it { should eq valves } \r\n    end \r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000140.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000140.rb:1 ",
                      "run_time":0.008991479,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined local variable or method `tcat' for #<Inspec::Rule:0x0000000004797a08>",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000160",
                "title":"AccessLogValve must be configured for each application context.",
                "desc":"Tomcat has the ability to host multiple contexts (applications) on one physical server by using the \n    <Host><Context> element. This allows the admin to specify audit log settings on a per application basis.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat has the ability to host multiple contexts (applications) on one physical server by using the \n    <Host><Context> element. This allows the admin to specify audit log settings on a per application basis."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000089-AS-000050",
                   "gid":"TCAT-AS-000160",
                   "rid":"TCAT-AS-000160_rule",
                   "stig_id":"TCAT-AS-000160",
                   "cci":"CCI-000169",
                   "nist":[
                      "AU-12",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\n    Review for all <Host> elements. If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> \n    element is not defined for each <Host> element, this is a finding.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME\u000fnf erver.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000160\" do\r\n    title \"AccessLogValve must be configured for each application context.\"\r\n    desc  \"Tomcat has the ability to host multiple contexts (applications) on one physical server by using the \r\n    <Host><Context> element. This allows the admin to specify audit log settings on a per application basis.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000089-AS-000050\"\r\n    tag \"gid\": \"TCAT-AS-000160\"\r\n    tag \"rid\": \"TCAT-AS-000160_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000160\"\r\n    tag \"cci\": \"CCI-000169\"\r\n    tag \"nist\": [\"AU-12\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\\\conf\\\\server.xml file.\r\n    Review for all <Host> elements. If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> \r\n    element is not defined for each <Host> element, this is a finding.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\") \r\n    hosts = tcat[\"//Host\"].count \r\n    valves = tcat[\"//Valve\"].count  \r\n    describe hosts do \r\n        it { should eq valves } \r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000160.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000160.rb:1 ",
                      "run_time":0.007062103,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined local variable or method `tcat' for #<Inspec::Rule:0x00000000047b50f8>",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000170",
                "title":"Tomcat servers behind a proxy or load balancer must log client IP.",
                "desc":"When running Tomcat behind a load balancer or proxy, default behavior is for Tomcat to log the proxy or load \n    balancer IP address as the client IP. Desired behavior is to log the actual client IP rather than the proxy IP address. \n    The RemoteIpValve logging component instructs Tomcat to grab the HTTP header X-Forwarded-For and use that for access \n    logging. Tomcat will identify 127.0.0.1, class A and class C RFC1918 addresses as internal proxy addresses; however, \n    if the proxy has a routable IP or a class B private network address space (172.16.0.0/12), the user must also verify \n        the \"internalProxies\" setting is configured to reflect the proxy IP address.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"When running Tomcat behind a load balancer or proxy, default behavior is for Tomcat to log the proxy or load \n    balancer IP address as the client IP. Desired behavior is to log the actual client IP rather than the proxy IP address. \n    The RemoteIpValve logging component instructs Tomcat to grab the HTTP header X-Forwarded-For and use that for access \n    logging. Tomcat will identify 127.0.0.1, class A and class C RFC1918 addresses as internal proxy addresses; however, \n    if the proxy has a routable IP or a class B private network address space (172.16.0.0/12), the user must also verify \n        the \"internalProxies\" setting is configured to reflect the proxy IP address."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000089-AS-000050",
                   "gid":"TCAT-AS-000170",
                   "rid":"TCAT-AS-000170_rule",
                   "stig_id":"TCAT-AS-000170",
                   "cci":"CCI-000169",
                   "nist":[
                      "AU-12",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Review the System Security Plan and determine if the Tomcat server resides behind a proxy server or load balancer. \n    If the Tomcat server is not behind a proxy server or load balancer, this requirement is NA. \n    From the Tomcat server run the following command:\n    sudo grep -i RemoteIpValve $CATALINA_HOME/conf/server.xml file.\n    If the results are empty or if the requestAttributesEnabled setting is not configured as \"True\", this is a finding.\n    sudo grep -i AccessLogValve $CATALINA_HOME/conf/server.xml file.\n    If the requestAttributesEnabled setting is not configured as \"True\", this is a finding.",
                   "fix":"From the Tomcat server as a privileged user: \n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Only execute this first step if the proxy server is using a routable IP address or an RFC 1918 Class B address space: Add or edit the RemoteIpValve and configure the internalProxies setting to reflect the proxy addresses.\n    Modify the AccessLogValve and configure the requestAttributesEnabled setting = \"True\".\n    EXAMPLE:\n    <Valve className=\"org.apache.catalina.valves.RemoteIpValve\" internalProxies=\"172.16.0.10|172.16.0.11\" />\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\"\n    directory=\"logs\"\n    prefix=\"access\"\n    suffix=\".log\"\n    pattern=\"combined\"\n    renameOnRotate=\"true\"\n    requestAttributesEnabled=\"true\"\n    />\n    Restart Tomcat:\n    sudo systemctl restart tomcat\n    sudo systemctl tomcat daemon-reload"
                },
                "code":"control \"TCAT-AS-000170\" do\r\n    title \"Tomcat servers behind a proxy or load balancer must log client IP.\"\r\n    desc  \"When running Tomcat behind a load balancer or proxy, default behavior is for Tomcat to log the proxy or load \r\n    balancer IP address as the client IP. Desired behavior is to log the actual client IP rather than the proxy IP address. \r\n    The RemoteIpValve logging component instructs Tomcat to grab the HTTP header X-Forwarded-For and use that for access \r\n    logging. Tomcat will identify 127.0.0.1, class A and class C RFC1918 addresses as internal proxy addresses; however, \r\n    if the proxy has a routable IP or a class B private network address space (172.16.0.0/12), the user must also verify \r\n        the \\\"internalProxies\\\" setting is configured to reflect the proxy IP address.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000089-AS-000050\"\r\n    tag \"gid\": \"TCAT-AS-000170\"\r\n    tag \"rid\": \"TCAT-AS-000170_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000170\"\r\n    tag \"cci\": \"CCI-000169\"\r\n    tag \"nist\": [\"AU-12\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Review the System Security Plan and determine if the Tomcat server resides behind a proxy server or load balancer. \r\n    If the Tomcat server is not behind a proxy server or load balancer, this requirement is NA. \r\n    From the Tomcat server run the following command:\r\n    sudo grep -i RemoteIpValve $CATALINA_HOME/conf/server.xml file.\r\n    If the results are empty or if the requestAttributesEnabled setting is not configured as \\\"True\\\", this is a finding.\r\n    sudo grep -i AccessLogValve $CATALINA_HOME/conf/server.xml file.\r\n    If the requestAttributesEnabled setting is not configured as \\\"True\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user: \r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Only execute this first step if the proxy server is using a routable IP address or an RFC 1918 Class B address space: Add or edit the RemoteIpValve and configure the internalProxies setting to reflect the proxy addresses.\r\n    Modify the AccessLogValve and configure the requestAttributesEnabled setting = \\\"True\\\".\r\n    EXAMPLE:\r\n    <Valve className=\\\"org.apache.catalina.valves.RemoteIpValve\\\" internalProxies=\\\"172.16.0.10|172.16.0.11\\\" />\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\"\r\n    directory=\\\"logs\\\"\r\n    prefix=\\\"access\\\"\r\n    suffix=\\\".log\\\"\r\n    pattern=\\\"combined\\\"\r\n    renameOnRotate=\\\"true\\\"\r\n    requestAttributesEnabled=\\\"true\\\"\r\n    />\r\n    Restart Tomcat:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl tomcat daemon-reload\"\r\n\r\n    describe \"This is a manual check\" do \r\n        skip \"Check the SSP to determine if the server resides behind a proxy server or load balancer. If true then \r\n        requestAttributesEnabled must set to true\"\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000170.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":8.122e-06,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "resource":"",
                      "skip_message":"Check the SSP to determine if the server resides behind a proxy server or load balancer. If true then \n        requestAttributesEnabled must set to true"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000180",
                "title":"Role based access controls must be configured for logging.",
                "desc":"Application servers utilize role-based access controls in order to specify the individuals who \n    are allowed to configure application component logable events. The application server must be configured \n    to select which personnel are assigned the role of selecting which logable events are to be logged.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Application servers utilize role-based access controls in order to specify the individuals who \n    are allowed to configure application component logable events. The application server must be configured \n    to select which personnel are assigned the role of selecting which logable events are to be logged."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000090-AS-000051",
                   "gid":"TCAT-AS-000180",
                   "rid":"TCAT-AS-000180_rule",
                   "stig_id":"TCAT-AS-000180",
                   "cci":"CCI-000171",
                   "nist":[
                      "AU-12",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server: \n    Edit the $CATALINA_HOME\\conf\\server.xml file.\n    Review for all <Host> elements. If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> element is not defined for each <Host> element, this is a finding.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME\u000fnf erver.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000180\" do\r\n    title \"Role based access controls must be configured for logging.\"\r\n    desc  \"Application servers utilize role-based access controls in order to specify the individuals who \r\n    are allowed to configure application component logable events. The application server must be configured \r\n    to select which personnel are assigned the role of selecting which logable events are to be logged.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000090-AS-000051\"\r\n    tag \"gid\": \"TCAT-AS-000180\"\r\n    tag \"rid\": \"TCAT-AS-000180_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000180\"\r\n    tag \"cci\": \"CCI-000171\"\r\n    tag \"nist\": [\"AU-12\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server: \r\n    Edit the $CATALINA_HOME\\\\conf\\\\server.xml file.\r\n    Review for all <Host> elements. If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> element is not defined for each <Host> element, this is a finding.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\") \r\n    hosts = tcat[\"//Host\"].count \r\n    valves = tcat[\"//Valve\"].count  \r\n    describe hosts do \r\n        it { should eq valves } \r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000180.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000180.rb:1 ",
                      "run_time":0.004074146,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined local variable or method `tcat' for #<Inspec::Rule:0x00000000047c4fa8>",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000190",
                "title":"AccessLogValve must be configured for each application context.",
                "desc":"Tomcat has the ability to host multiple contexts (applications) on one physical server by using \n    the <Host><Context> element. This allows the admin to specify audit log settings on a per application basis.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat has the ability to host multiple contexts (applications) on one physical server by using \n    the <Host><Context> element. This allows the admin to specify audit log settings on a per application basis."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000091-AS-000052",
                   "gid":"TCAT-AS-000190",
                   "rid":"TCAT-AS-000190_rule",
                   "stig_id":"TCAT-AS-000190",
                   "cci":"CCI-000172",
                   "nist":[
                      "AU-12",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\n    Review for all <Host> elements. If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> element \n    is not defined for each <Host> element, this is a finding.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME\u000fnf erver.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000190\" do\r\n    title \"AccessLogValve must be configured for each application context.\"\r\n    desc  \"Tomcat has the ability to host multiple contexts (applications) on one physical server by using \r\n    the <Host><Context> element. This allows the admin to specify audit log settings on a per application basis.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000091-AS-000052\"\r\n    tag \"gid\": \"TCAT-AS-000190\"\r\n    tag \"rid\": \"TCAT-AS-000190_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000190\"\r\n    tag \"cci\": \"CCI-000172\"\r\n    tag \"nist\": [\"AU-12\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\\\conf\\\\server.xml file.\r\n    Review for all <Host> elements. If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> element \r\n    is not defined for each <Host> element, this is a finding.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\") \r\n    hosts = tcat[\"//Host\"].count \r\n    valves = tcat[\"//Valve\"].count  \r\n    describe hosts do \r\n        it { should eq valves } \r\n    end \r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000190.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000190.rb:1 ",
                      "run_time":0.004037291,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined local variable or method `tcat' for #<Inspec::Rule:0x00000000047ee7e0>",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000210",
                "title":"AccessLogValve must be configured for each application context.",
                "desc":"Tomcat has the ability to host multiple contexts (applications) on one physical server by using \n    the <Host><Context> element. This allows the admin to specify audit log settings on a per application basis.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat has the ability to host multiple contexts (applications) on one physical server by using \n    the <Host><Context> element. This allows the admin to specify audit log settings on a per application basis."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000095-AS-000056",
                   "gid":"TCAT-AS-000210",
                   "rid":"TCAT-AS-000210_rule",
                   "stig_id":"TCAT-AS-000210",
                   "cci":"CCI-000130",
                   "nist":[
                      "AU-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\n    Review for all <Host> elements. If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> \n    element is not defined for each <Host> element, this is a finding.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME\u000fnf erver.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000210\" do\r\n    title \"AccessLogValve must be configured for each application context.\"\r\n    desc  \"Tomcat has the ability to host multiple contexts (applications) on one physical server by using \r\n    the <Host><Context> element. This allows the admin to specify audit log settings on a per application basis.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000095-AS-000056\"\r\n    tag \"gid\": \"TCAT-AS-000210\"\r\n    tag \"rid\": \"TCAT-AS-000210_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000210\"\r\n    tag \"cci\": \"CCI-000130\"\r\n    tag \"nist\": [\"AU-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\\\conf\\\\server.xml file.\r\n    Review for all <Host> elements. If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> \r\n    element is not defined for each <Host> element, this is a finding.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\") \r\n    hosts = tcat[\"//Host\"].count \r\n    valves = tcat[\"//Valve\"].count  \r\n    describe hosts do \r\n        it { should eq valves } \r\n    end \r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000210.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000210.rb:1 ",
                      "run_time":0.004475503,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined local variable or method `tcat' for #<Inspec::Rule:0x000000000482d0d0>",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000220",
                "title":"AccessLogValve must be configured per each virtual host.",
                "desc":"Tomcat has the ability to host multiple virtual hosts on one physical server by using the <Host> element. \n    This allows the admin to separate hosted applications according to where the domain the application will be available. \n    Configuring logs on a per-host basis allows for log management that correlates to the virtual host activity.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat has the ability to host multiple virtual hosts on one physical server by using the <Host> element. \n    This allows the admin to separate hosted applications according to where the domain the application will be available. \n    Configuring logs on a per-host basis allows for log management that correlates to the virtual host activity."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000095-AS-000056",
                   "gid":"TCAT-AS-000220",
                   "rid":"TCAT-AS-000220_rule",
                   "stig_id":"TCAT-AS-000220",
                   "cci":"CCI-000130",
                   "nist":[
                      "AU-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Review for all <Host> elements. If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> \n    element is not defined for each <Host> element, this is a finding.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000220\" do\r\n    title \"AccessLogValve must be configured per each virtual host.\"\r\n    desc  \"Tomcat has the ability to host multiple virtual hosts on one physical server by using the <Host> element. \r\n    This allows the admin to separate hosted applications according to where the domain the application will be available. \r\n    Configuring logs on a per-host basis allows for log management that correlates to the virtual host activity.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000095-AS-000056\"\r\n    tag \"gid\": \"TCAT-AS-000220\"\r\n    tag \"rid\": \"TCAT-AS-000220_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000220\"\r\n    tag \"cci\": \"CCI-000130\"\r\n    tag \"nist\": [\"AU-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Review for all <Host> elements. If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> \r\n    element is not defined for each <Host> element, this is a finding.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\") \r\n    hosts = tcat[\"//Host\"].count \r\n    valves = tcat[\"//Valve\"].count  \r\n    describe hosts do \r\n        it { should eq valves } \r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000220.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000220.rb:1 ",
                      "run_time":0.003847525,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined local variable or method `tcat' for #<Inspec::Rule:0x000000000483c350>",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000230",
                "title":"AccessLogValve must be configured for Catalina engine.",
                "desc":"The <Engine> container represents the entire request processing machinery associated \n    with a particular Catalina Service. It receives and processes all requests from one or more \n    Connectors, and returns the completed response to the Connector for transmission back to the \n    client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element \n    must be nested inside a Service element, following all of the corresponding Connector elements \n    associated with the Service.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The <Engine> container represents the entire request processing machinery associated \n    with a particular Catalina Service. It receives and processes all requests from one or more \n    Connectors, and returns the completed response to the Connector for transmission back to the \n    client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element \n    must be nested inside a Service element, following all of the corresponding Connector elements \n    associated with the Service."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000095-AS-000056",
                   "gid":"TCAT-AS-000230",
                   "rid":"TCAT-AS-000230_rule",
                   "stig_id":"TCAT-AS-000230",
                   "cci":"CCI-000130",
                   "nist":[
                      "AU-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\n    Review for all <Host> elements. If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> \n    element is not defined for each <Host> element, this is a finding.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                prefix=\"localhost_access_log\" suffix=\".txt\"\n                pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME\u000fnf erver.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                prefix=\"localhost_access_log\" suffix=\".txt\"\n                pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000230\" do\r\n    title \"AccessLogValve must be configured for Catalina engine.\"\r\n    desc  \"The <Engine> container represents the entire request processing machinery associated \r\n    with a particular Catalina Service. It receives and processes all requests from one or more \r\n    Connectors, and returns the completed response to the Connector for transmission back to the \r\n    client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element \r\n    must be nested inside a Service element, following all of the corresponding Connector elements \r\n    associated with the Service.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000095-AS-000056\"\r\n    tag \"gid\": \"TCAT-AS-000230\"\r\n    tag \"rid\": \"TCAT-AS-000230_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000230\"\r\n    tag \"cci\": \"CCI-000130\"\r\n    tag \"nist\": [\"AU-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\\\conf\\\\server.xml file.\r\n    Review for all <Host> elements. If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> \r\n    element is not defined for each <Host> element, this is a finding.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\") \r\n    hosts = tcat[\"//Host\"].count \r\n    valves = tcat[\"//Valve\"].count  \r\n    describe hosts do \r\n        it { should eq valves } \r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000230.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000230.rb:1 ",
                      "run_time":0.003954125,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined local variable or method `tcat' for #<Inspec::Rule:0x0000000004847778>",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000240",
                "title":"Date and time of events must be logged.",
                "desc":"The access logfile format is defined within a Valve that implements the \n    org.apache.catalina.valves.AccessLogValve interface within the /opt/tomcat/server.xml \n    configuration file: The %t pattern code is included in the pattern element and logs \n    the date and time of the event. Including the date pattern in the log configuration \n    provides useful information about the time of the event which is critical for \n    troubleshooting and forensic investigations.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The access logfile format is defined within a Valve that implements the \n    org.apache.catalina.valves.AccessLogValve interface within the /opt/tomcat/server.xml \n    configuration file: The %t pattern code is included in the pattern element and logs \n    the date and time of the event. Including the date pattern in the log configuration \n    provides useful information about the time of the event which is critical for \n    troubleshooting and forensic investigations."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000096-AS-000059",
                   "gid":"TCAT-AS-000240",
                   "rid":"TCAT-AS-000240_rule",
                   "stig_id":"TCAT-AS-000240",
                   "cci":"CCI-000131",
                   "nist":[
                      "AU-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Review all <Valve> elements.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>\n    If the pattern= statement does notinclude %t, this is a finding.",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Modify the <Valve> element(s) nested within the <Host> element(s).  \n    Change the AccessLogValve setting to include %t in the pattern= statement. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000240\" do\r\n    title \"Date and time of events must be logged.\"\r\n    desc  \"The access logfile format is defined within a Valve that implements the \r\n    org.apache.catalina.valves.AccessLogValve interface within the /opt/tomcat/server.xml \r\n    configuration file: The %t pattern code is included in the pattern element and logs \r\n    the date and time of the event. Including the date pattern in the log configuration \r\n    provides useful information about the time of the event which is critical for \r\n    troubleshooting and forensic investigations.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000096-AS-000059\"\r\n    tag \"gid\": \"TCAT-AS-000240\"\r\n    tag \"rid\": \"TCAT-AS-000240_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000240\"\r\n    tag \"cci\": \"CCI-000131\"\r\n    tag \"nist\": [\"AU-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Review all <Valve> elements.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\r\n    If the pattern= statement does notinclude %t, this is a finding.\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Modify the <Valve> element(s) nested within the <Host> element(s).  \r\n    Change the AccessLogValve setting to include %t in the pattern= statement. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n  \r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    patterns = tomcat_server_file[\"//Valve/@pattern\"]\r\n    patterns.each do |pattern|\r\n        describe pattern do\r\n            it { should include '%t' }\r\n        end\r\n    end\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000240.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000240.rb:1 ",
                      "run_time":0.001599382,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000250",
                "title":"Remote hostname must be logged.",
                "desc":"The access logfile format is defined within a Valve that implements the \n    org.apache.catalina.valves.AccessLogValve interface within the /opt/tomcat/server.xml \n    configuration file: The %h pattern code is included in the pattern element and logs \n    the remote hostname. Including the hostname pattern in the log configuration provides \n    useful information about the connecting host that is critical for troubleshooting \n    and forensic investigations.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The access logfile format is defined within a Valve that implements the \n    org.apache.catalina.valves.AccessLogValve interface within the /opt/tomcat/server.xml \n    configuration file: The %h pattern code is included in the pattern element and logs \n    the remote hostname. Including the hostname pattern in the log configuration provides \n    useful information about the connecting host that is critical for troubleshooting \n    and forensic investigations."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000097-AS-000060",
                   "gid":"TCAT-AS-000250",
                   "rid":"TCAT-AS-000250_rule",
                   "stig_id":"TCAT-AS-000250",
                   "cci":"CCI-000132",
                   "nist":[
                      "AU-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Review all <Valve> elements.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>\n    If the pattern= statement does not include %h, this is a finding.",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Modify the <Valve> element(s) nested within the <Host> element(s).  \n    Change the AccessLogValve setting to include %h in the pattern= statement. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000250\" do\r\n    title \"Remote hostname must be logged.\"\r\n    desc  \"The access logfile format is defined within a Valve that implements the \r\n    org.apache.catalina.valves.AccessLogValve interface within the /opt/tomcat/server.xml \r\n    configuration file: The %h pattern code is included in the pattern element and logs \r\n    the remote hostname. Including the hostname pattern in the log configuration provides \r\n    useful information about the connecting host that is critical for troubleshooting \r\n    and forensic investigations.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000097-AS-000060\"\r\n    tag \"gid\": \"TCAT-AS-000250\"\r\n    tag \"rid\": \"TCAT-AS-000250_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000250\"\r\n    tag \"cci\": \"CCI-000132\"\r\n    tag \"nist\": [\"AU-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Review all <Valve> elements.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\r\n    If the pattern= statement does not include %h, this is a finding.\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Modify the <Valve> element(s) nested within the <Host> element(s).  \r\n    Change the AccessLogValve setting to include %h in the pattern= statement. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    patterns = tomcat_server_file[\"//Valve/@pattern\"]\r\n    patterns.each do |pattern|\r\n        describe pattern do\r\n            it { should include '%h' }\r\n        end\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000250.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000250.rb:1 ",
                      "run_time":0.001595092,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000260",
                "title":"HTTP status code must be logged.",
                "desc":"The access logfile format is defined within a Valve that implements the \n    org.apache.catalina.valves.AccessLogValve interface within the /opt/tomcat/server.xml \n    configuration file: The %s pattern code is included in the pattern element and logs \n    the server response code associated with the event e.g. 200 OK or 400 Bad Request. \n    Including the status pattern in the log configuration provides useful server response \n    information about the event which is critical for troubleshooting and forensic investigations.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The access logfile format is defined within a Valve that implements the \n    org.apache.catalina.valves.AccessLogValve interface within the /opt/tomcat/server.xml \n    configuration file: The %s pattern code is included in the pattern element and logs \n    the server response code associated with the event e.g. 200 OK or 400 Bad Request. \n    Including the status pattern in the log configuration provides useful server response \n    information about the event which is critical for troubleshooting and forensic investigations."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000097-AS-000060",
                   "gid":"TCAT-AS-000260",
                   "rid":"TCAT-AS-000260_rule",
                   "stig_id":"TCAT-AS-000260",
                   "cci":"CCI-000132",
                   "nist":[
                      "AU-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Review all <Valve> elements.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>\n    If the pattern= statement does not include %s, this is a finding.",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Modify the <Valve> element(s) nested within the <Host> element(s).  \n    Change the AccessLogValve setting to include %s in the pattern= statement. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000260\" do\r\n    title \"HTTP status code must be logged.\"\r\n    desc  \"The access logfile format is defined within a Valve that implements the \r\n    org.apache.catalina.valves.AccessLogValve interface within the /opt/tomcat/server.xml \r\n    configuration file: The %s pattern code is included in the pattern element and logs \r\n    the server response code associated with the event e.g. 200 OK or 400 Bad Request. \r\n    Including the status pattern in the log configuration provides useful server response \r\n    information about the event which is critical for troubleshooting and forensic investigations.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000097-AS-000060\"\r\n    tag \"gid\": \"TCAT-AS-000260\"\r\n    tag \"rid\": \"TCAT-AS-000260_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000260\"\r\n    tag \"cci\": \"CCI-000132\"\r\n    tag \"nist\": [\"AU-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Review all <Valve> elements.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\r\n    If the pattern= statement does not include %s, this is a finding.\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Modify the <Valve> element(s) nested within the <Host> element(s).  \r\n    Change the AccessLogValve setting to include %s in the pattern= statement. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    patterns = tomcat_server_file[\"//Valve/@pattern\"]\r\n    patterns.each do |pattern|\r\n        describe pattern do\r\n            it { should include '%s' }\r\n        end\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000260.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000260.rb:1 ",
                      "run_time":0.00151571,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000270",
                "title":"The first line of request must be logged.",
                "desc":"The access logfile format is defined within a Valve that implements the \n    org.apache.catalina.valves.AccessLogValve interface within the /opt/tomcat/server.xml \n    configuration file: The %r pattern code is included in the pattern element \n    and logs the first line associated with the event, namely the request method, URL path, \n    query string, and protocol (\"\"\" simply specifies a literal double quote). Including \n    the pattern in the log configuration provides useful information about the time of the event \n    which is critical for troubleshooting and forensic investigations.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The access logfile format is defined within a Valve that implements the \n    org.apache.catalina.valves.AccessLogValve interface within the /opt/tomcat/server.xml \n    configuration file: The %r pattern code is included in the pattern element \n    and logs the first line associated with the event, namely the request method, URL path, \n    query string, and protocol (\"\"\" simply specifies a literal double quote). Including \n    the pattern in the log configuration provides useful information about the time of the event \n    which is critical for troubleshooting and forensic investigations."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000097-AS-000060",
                   "gid":"TCAT-AS-000270",
                   "rid":"TCAT-AS-000270_rule",
                   "stig_id":"TCAT-AS-000270",
                   "cci":"CCI-000132",
                   "nist":[
                      "AU-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Review all <Valve> elements.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>\n    If the pattern= statement does not include %r, this is a finding.",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Modify the <Valve> element(s) nested within the <Host> element(s).  \n    Change the AccessLogValve setting to include %r in the pattern= statement. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000270\" do\r\n    title \"The first line of request must be logged.\"\r\n    desc  \"The access logfile format is defined within a Valve that implements the \r\n    org.apache.catalina.valves.AccessLogValve interface within the /opt/tomcat/server.xml \r\n    configuration file: The %r pattern code is included in the pattern element \r\n    and logs the first line associated with the event, namely the request method, URL path, \r\n    query string, and protocol (\\\"\\\"\\\" simply specifies a literal double quote). Including \r\n    the pattern in the log configuration provides useful information about the time of the event \r\n    which is critical for troubleshooting and forensic investigations.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000097-AS-000060\"\r\n    tag \"gid\": \"TCAT-AS-000270\"\r\n    tag \"rid\": \"TCAT-AS-000270_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000270\"\r\n    tag \"cci\": \"CCI-000132\"\r\n    tag \"nist\": [\"AU-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Review all <Valve> elements.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\r\n    If the pattern= statement does not include %r, this is a finding.\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Modify the <Valve> element(s) nested within the <Host> element(s).  \r\n    Change the AccessLogValve setting to include %r in the pattern= statement. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    patterns = tomcat_server_file[\"//Valve/@pattern\"]\r\n    patterns.each do |pattern|\r\n        describe pattern do\r\n            it { should include '%r' }\r\n        end\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000270.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000270.rb:1 ",
                      "run_time":0.001581729,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000280",
                "title":"AccessLogValve must be configured for each application context.",
                "desc":"Tomcat has the ability to host multiple contexts (applications) on one physical server by using \n    the <Host><Context> element. This allows the admin to specify audit log settings on a per application basis.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat has the ability to host multiple contexts (applications) on one physical server by using \n    the <Host><Context> element. This allows the admin to specify audit log settings on a per application basis."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000098-AS-000061",
                   "gid":"TCAT-AS-000280",
                   "rid":"TCAT-AS-000280_rule",
                   "stig_id":"TCAT-AS-000280",
                   "cci":"CCI-000133",
                   "nist":[
                      "AU-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME\u000fnf erver.xml file.\n    Review for all <Host> elements. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> element is not \n    defined for each <Host> element, this is a finding.",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME\u000fnf erver.xml file.\n    Create a <Valve> element that is nested within the <Host> element. \n    Specify an AccessLogValve setting in the Valve element with the following pattern statement. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000280\" do\r\n    title \"AccessLogValve must be configured for each application context.\"\r\n    desc  \"Tomcat has the ability to host multiple contexts (applications) on one physical server by using \r\n    the <Host><Context> element. This allows the admin to specify audit log settings on a per application basis.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000098-AS-000061\"\r\n    tag \"gid\": \"TCAT-AS-000280\"\r\n    tag \"rid\": \"TCAT-AS-000280_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000280\"\r\n    tag \"cci\": \"CCI-000133\"\r\n    tag \"nist\": [\"AU-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\r\n    Review for all <Host> elements. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> element is not \r\n    defined for each <Host> element, this is a finding.\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\r\n    Create a <Valve> element that is nested within the <Host> element. \r\n    Specify an AccessLogValve setting in the Valve element with the following pattern statement. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\") \r\n    hosts = tcat[\"//Host\"].count \r\n    valves = tcat[\"//Valve\"].count  \r\n    describe hosts do \r\n        it { should eq valves } \r\n    end \r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000280.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000280.rb:1 ",
                      "run_time":0.004014124,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined local variable or method `tcat' for #<Inspec::Rule:0x00000000048c7c98>",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000290",
                "title":"AccessLogValve must be configured per each virtual host.",
                "desc":"Tomcat has the ability to host multiple virtual hosts on one physical server by using \n    the <Host> container attribute. This allows the admin to separate hosted applications according\n    to where the domain the application will be available. Configuring logs on a per-host basis \n    allows for log management that correlates to the virtual host activity.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat has the ability to host multiple virtual hosts on one physical server by using \n    the <Host> container attribute. This allows the admin to separate hosted applications according\n    to where the domain the application will be available. Configuring logs on a per-host basis \n    allows for log management that correlates to the virtual host activity."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000099-AS-000062",
                   "gid":"TCAT-AS-000290",
                   "rid":"TCAT-AS-000290_rule",
                   "stig_id":"TCAT-AS-000290",
                   "cci":"CCI-000134",
                   "nist":[
                      "AU-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Review for all <Host> elements. If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> \n    element is not defined for each <Host> element, this is a finding.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000290\" do\r\n    title \"AccessLogValve must be configured per each virtual host.\"\r\n    desc  \"Tomcat has the ability to host multiple virtual hosts on one physical server by using \r\n    the <Host> container attribute. This allows the admin to separate hosted applications according\r\n    to where the domain the application will be available. Configuring logs on a per-host basis \r\n    allows for log management that correlates to the virtual host activity.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000099-AS-000062\"\r\n    tag \"gid\": \"TCAT-AS-000290\"\r\n    tag \"rid\": \"TCAT-AS-000290_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000290\"\r\n    tag \"cci\": \"CCI-000134\"\r\n    tag \"nist\": [\"AU-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Review for all <Host> elements. If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> \r\n    element is not defined for each <Host> element, this is a finding.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\") \r\n    hosts = tcat[\"//Host\"].count \r\n    valves = tcat[\"//Valve\"].count  \r\n    describe hosts do \r\n        it { should eq valves } \r\n    end \r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000290.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000290.rb:1 ",
                      "run_time":0.004038962,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined local variable or method `tcat' for #<Inspec::Rule:0x00000000048d7698>",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000300",
                "title":"AccessLogValve must be configured for Catalina engine.",
                "desc":"The <Engine> container represents the entire request processing machinery associated \n    with a particular Catalina Service. It receives and processes all requests from one or more \n    Connectors, and returns the completed response to the Connector for transmission back to the \n    client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine \n    element MUST be nested inside a Service element, following all of the corresponding Connector \n    elements associated with the Service.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The <Engine> container represents the entire request processing machinery associated \n    with a particular Catalina Service. It receives and processes all requests from one or more \n    Connectors, and returns the completed response to the Connector for transmission back to the \n    client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine \n    element MUST be nested inside a Service element, following all of the corresponding Connector \n    elements associated with the Service."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000100-AS-000063",
                   "gid":"TCAT-AS-000300",
                   "rid":"TCAT-AS-000300_rule",
                   "stig_id":"TCAT-AS-000300",
                   "cci":"CCI-001487",
                   "nist":[
                      "AU-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME\u000fnf erver.xml file.\n    Review for all <Host> elements. If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> \n    element is not defined for each <Host> element, this is a finding.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                prefix=\"localhost_access_log\" suffix=\".txt\"\n                pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                prefix=\"localhost_access_log\" suffix=\".txt\"\n                pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000300\" do\r\n    title \"AccessLogValve must be configured for Catalina engine.\"\r\n    desc  \"The <Engine> container represents the entire request processing machinery associated \r\n    with a particular Catalina Service. It receives and processes all requests from one or more \r\n    Connectors, and returns the completed response to the Connector for transmission back to the \r\n    client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine \r\n    element MUST be nested inside a Service element, following all of the corresponding Connector \r\n    elements associated with the Service.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000100-AS-000063\"\r\n    tag \"gid\": \"TCAT-AS-000300\"\r\n    tag \"rid\": \"TCAT-AS-000300_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000300\"\r\n    tag \"cci\": \"CCI-001487\"\r\n    tag \"nist\": [\"AU-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\r\n    Review for all <Host> elements. If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> \r\n    element is not defined for each <Host> element, this is a finding.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\\\conf\\\\server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\") \r\n    hosts = tcat[\"//Host\"].count \r\n    valves = tcat[\"//Valve\"].count  \r\n    describe hosts do \r\n        it { should eq valves } \r\n    end \r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000300.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000300.rb:1 ",
                      "run_time":0.004059817,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined local variable or method `tcat' for #<Inspec::Rule:0x00000000048e7f48>",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000310",
                "title":"AccessLogValve must be configured for Catalina engine.",
                "desc":"The <Engine> container represents the entire request processing machinery associated \n    with a particular Catalina Service. It receives and processes all requests from one or more \n    Connectors, and returns the completed response to the Connector for transmission back to the \n    client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine \n    element MUST be nested inside a Service element, following all of the corresponding \n    Connector elements associated with the Service.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The <Engine> container represents the entire request processing machinery associated \n    with a particular Catalina Service. It receives and processes all requests from one or more \n    Connectors, and returns the completed response to the Connector for transmission back to the \n    client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine \n    element MUST be nested inside a Service element, following all of the corresponding \n    Connector elements associated with the Service."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000101-AS-000072",
                   "gid":"TCAT-AS-000310",
                   "rid":"TCAT-AS-000310_rule",
                   "stig_id":"TCAT-AS-000310",
                   "cci":"CCI-000135",
                   "nist":[
                      "AU-3",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME\u000fnf erver.xml file.\n    Review for all <Host> elements. If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> element is not defined for each <Host> element, this is a finding.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                prefix=\"localhost_access_log\" suffix=\".txt\"\n                pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME\u000fnf erver.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                prefix=\"localhost_access_log\" suffix=\".txt\"\n                pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000310\" do\r\n    title \"AccessLogValve must be configured for Catalina engine.\"\r\n    desc  \"The <Engine> container represents the entire request processing machinery associated \r\n    with a particular Catalina Service. It receives and processes all requests from one or more \r\n    Connectors, and returns the completed response to the Connector for transmission back to the \r\n    client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine \r\n    element MUST be nested inside a Service element, following all of the corresponding \r\n    Connector elements associated with the Service.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000101-AS-000072\"\r\n    tag \"gid\": \"TCAT-AS-000310\"\r\n    tag \"rid\": \"TCAT-AS-000310_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000310\"\r\n    tag \"cci\": \"CCI-000135\"\r\n    tag \"nist\": [\"AU-3\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\r\n    Review for all <Host> elements. If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> element is not defined for each <Host> element, this is a finding.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\") \r\n    hosts = tcat[\"//Host\"].count \r\n    valves = tcat[\"//Valve\"].count  \r\n    describe hosts do \r\n        it { should eq valves } \r\n    end \r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000310.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000310.rb:1 ",
                      "run_time":0.003823717,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"undefined local variable or method `tcat' for #<Inspec::Rule:0x0000000004941c50>",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000360",
                "title":"$CATALINA_HOME/logs folder permissions must be set to 750.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files \n    owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by \n    the Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, \n    they cannot change the Tomcat configuration, deploy new web applications, or modify existing web applications. \n    The Tomcat process runs with a umask of 007 to maintain these permissions.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files \n    owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by \n    the Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, \n    they cannot change the Tomcat configuration, deploy new web applications, or modify existing web applications. \n    The Tomcat process runs with a umask of 007 to maintain these permissions."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000118-AS-000078",
                   "gid":"TCAT-AS-000360",
                   "rid":"TCAT-AS-000360_rule",
                   "stig_id":"TCAT-AS-000360",
                   "cci":"CCI-000162",
                   "nist":[
                      "AU-9",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/logs -follow -maxdepth 0 -type d \\( \\! -perm 750 \\) -ls\n    If no folders are displayed, this is not a finding.\n    If results indicate the $CATALINA_HOME/logs folder permissions are not set to 750, this is a finding.",
                   "fix":"Run the following command on the Tomcat server:\n    sudo find $CATALINA_HOME/logs -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/logs"
                },
                "code":"control \"TCAT-AS-000360\" do\r\n    title \"$CATALINA_HOME/logs folder permissions must be set to 750.\"\r\n    desc  \"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files \r\n    owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \r\n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by \r\n    the Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, \r\n    they cannot change the Tomcat configuration, deploy new web applications, or modify existing web applications. \r\n    The Tomcat process runs with a umask of 007 to maintain these permissions.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000118-AS-000078\"\r\n    tag \"gid\": \"TCAT-AS-000360\"\r\n    tag \"rid\": \"TCAT-AS-000360_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000360\"\r\n    tag \"cci\": \"CCI-000162\"\r\n    tag \"nist\": [\"AU-9\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/logs -follow -maxdepth 0 -type d \\\\( \\\\! -perm 750 \\\\) -ls\r\n    If no folders are displayed, this is not a finding.\r\n    If results indicate the $CATALINA_HOME/logs folder permissions are not set to 750, this is a finding.\"\r\n    tag \"fix\": \"Run the following command on the Tomcat server:\r\n    sudo find $CATALINA_HOME/logs -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/logs\"\r\n\r\n    describe command(\"stat -c %a $CATALINA_HOME/logs\") do \r\n        its(\"stdout.strip\") { should cmp 750 }\r\n    end \r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000360.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/logs` stdout.strip is expected to cmp == 750",
                      "run_time":0.254859107,
                      "start_time":"2020-06-17T00:47:05+00:00",
                      "message":"\nexpected: 750\n     got: 777\n\n(compared using `cmp` matcher)\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000361",
                "title":"Files in the $CATALINA_HOME/logs/ folder must have their permissions set to 640.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files \n    owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by \n    the Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, \n    they cannot change the Tomcat configuration, deploy new web applications, or modify existing web applications. \n    The Tomcat process runs with a umask of 007 to maintain these permissions.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files \n    owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by \n    the Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, \n    they cannot change the Tomcat configuration, deploy new web applications, or modify existing web applications. \n    The Tomcat process runs with a umask of 007 to maintain these permissions."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000118-AS-000078",
                   "gid":"TCAT-AS-000361",
                   "rid":"TCAT-AS-000361_rule",
                   "stig_id":"TCAT-AS-000361",
                   "cci":"CCI-000162",
                   "nist":[
                      "AU-9",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/logs/* -follow -maxdepth 0 -type f \\( \\! -perm 640 \\) -ls\n    If no files are displayed, this is not a finding.\n    If results indicate any of the file permissions contained in the $CATALINA_HOME/logs folder are not \n    set to 640, this is a finding.",
                   "fix":"Run the following command on the Tomcat server:\n    sudo find $CATALINA_HOME/logs/* -follow -maxdepth 0 -type f -print0 | sudo xargs chmod 640 $CATALINA_HOME/logs/*"
                },
                "code":"control \"TCAT-AS-000361\" do\r\n    title \"Files in the $CATALINA_HOME/logs/ folder must have their permissions set to 640.\"\r\n    desc  \"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files \r\n    owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \r\n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by \r\n    the Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, \r\n    they cannot change the Tomcat configuration, deploy new web applications, or modify existing web applications. \r\n    The Tomcat process runs with a umask of 007 to maintain these permissions.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000118-AS-000078\"\r\n    tag \"gid\": \"TCAT-AS-000361\"\r\n    tag \"rid\": \"TCAT-AS-000361_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000361\"\r\n    tag \"cci\": \"CCI-000162\"\r\n    tag \"nist\": [\"AU-9\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/logs/* -follow -maxdepth 0 -type f \\\\( \\\\! -perm 640 \\\\) -ls\r\n    If no files are displayed, this is not a finding.\r\n    If results indicate any of the file permissions contained in the $CATALINA_HOME/logs folder are not \r\n    set to 640, this is a finding.\"\r\n    tag \"fix\": \"Run the following command on the Tomcat server:\r\n    sudo find $CATALINA_HOME/logs/* -follow -maxdepth 0 -type f -print0 | sudo xargs chmod 640 $CATALINA_HOME/logs/*\"\r\n\r\n    tomcat_log_dir = command(\"ls $CATALINA_HOME/logs\").stdout.split\r\n    tomcat_log_dir.each do |web_file|\r\n        describe command(\"stat -c %a $CATALINA_HOME/logs/#{web_file}\") do\r\n            its('stdout.strip') { should cmp 640 }\r\n        end\r\n    end  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000361.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"passed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/logs/catalina.2020-06-09.log` stdout.strip is expected to cmp == 640",
                      "run_time":0.263095654,
                      "start_time":"2020-06-17T00:47:05+00:00"
                   },
                   {
                      "status":"passed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/logs/host-manager.2020-06-09.log` stdout.strip is expected to cmp == 640",
                      "run_time":0.266411938,
                      "start_time":"2020-06-17T00:47:06+00:00"
                   },
                   {
                      "status":"passed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/logs/localhost.2020-06-09.log` stdout.strip is expected to cmp == 640",
                      "run_time":0.264716569,
                      "start_time":"2020-06-17T00:47:06+00:00"
                   },
                   {
                      "status":"passed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/logs/localhost_access_log.2020-06-09.txt` stdout.strip is expected to cmp == 640",
                      "run_time":0.279863269,
                      "start_time":"2020-06-17T00:47:06+00:00"
                   },
                   {
                      "status":"passed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/logs/manager.2020-06-09.log` stdout.strip is expected to cmp == 640",
                      "run_time":0.260229777,
                      "start_time":"2020-06-17T00:47:07+00:00"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000370",
                "title":"Files in the $CATALINA_HOME/conf/ folder must have their permissions set to 640.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat \n    files owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the \n    Tomcat user group tomcat rather than root user group tomcat. This means that even if an attacker compromises \n    the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, or modify existing \n    web applications. The Tomcat process runs with a umask of 0027 to maintain these permissions.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat \n    files owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the \n    Tomcat user group tomcat rather than root user group tomcat. This means that even if an attacker compromises \n    the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, or modify existing \n    web applications. The Tomcat process runs with a umask of 0027 to maintain these permissions."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000119-AS-000079",
                   "gid":"TCAT-AS-000370",
                   "rid":"TCAT-AS-000370_rule",
                   "stig_id":"TCAT-AS-000370",
                   "cci":"CCI-000163",
                   "nist":[
                      "AU-9",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/conf/* -follow -maxdepth 0 -type f \\( \\! -perm 640 \\) -ls\n    If no files are displayed, this is not a finding.\n    If results indicate any of the file permissions contained in the $CATALINA_HOME/conf folder are not set to 640, this is a finding.",
                   "fix":"Run the following command on the Tomcat server:\n    sudo find $CATALINA_HOME/conf/* -follow -maxdepth 0 -type f -print0 | sudo xargs chmod 640 $CATALINA_HOME/conf/*"
                },
                "code":"control \"TCAT-AS-000370\" do\r\n    title \"Files in the $CATALINA_HOME/conf/ folder must have their permissions set to 640.\"\r\n    desc  \"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat \r\n    files owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \r\n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the \r\n    Tomcat user group tomcat rather than root user group tomcat. This means that even if an attacker compromises \r\n    the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, or modify existing \r\n    web applications. The Tomcat process runs with a umask of 0027 to maintain these permissions.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000119-AS-000079\"\r\n    tag \"gid\": \"TCAT-AS-000370\"\r\n    tag \"rid\": \"TCAT-AS-000370_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000370\"\r\n    tag \"cci\": \"CCI-000163\"\r\n    tag \"nist\": [\"AU-9\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/conf/* -follow -maxdepth 0 -type f \\\\( \\\\! -perm 640 \\\\) -ls\r\n    If no files are displayed, this is not a finding.\r\n    If results indicate any of the file permissions contained in the $CATALINA_HOME/conf folder are not set to 640, this is a finding.\"\r\n    tag \"fix\": \"Run the following command on the Tomcat server:\r\n    sudo find $CATALINA_HOME/conf/* -follow -maxdepth 0 -type f -print0 | sudo xargs chmod 640 $CATALINA_HOME/conf/*\"\r\n\r\n    tomcat_conf_dir = command(\"ls $CATALINA_HOME/conf\").stdout.split\r\n    tomcat_conf_dir.each do |web_file|\r\n        describe command(\"stat -c %a $CATALINA_HOME/conf/#{web_file}\") do\r\n            its('stdout.strip') { should cmp 640 }\r\n        end\r\n    end  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000370.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/conf/Catalina` stdout.strip is expected to cmp == 640",
                      "run_time":0.266885553,
                      "start_time":"2020-06-17T00:47:07+00:00",
                      "message":"\nexpected: 640\n     got: 750\n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/conf/catalina.policy` stdout.strip is expected to cmp == 640",
                      "run_time":0.263720542,
                      "start_time":"2020-06-17T00:47:07+00:00",
                      "message":"\nexpected: 640\n     got: 644\n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/conf/catalina.properties` stdout.strip is expected to cmp == 640",
                      "run_time":0.26234322,
                      "start_time":"2020-06-17T00:47:07+00:00",
                      "message":"\nexpected: 640\n     got: 644\n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/conf/context.xml` stdout.strip is expected to cmp == 640",
                      "run_time":0.26244269,
                      "start_time":"2020-06-17T00:47:08+00:00",
                      "message":"\nexpected: 640\n     got: 644\n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/conf/jaspic-providers.xml` stdout.strip is expected to cmp == 640",
                      "run_time":0.311601654,
                      "start_time":"2020-06-17T00:47:08+00:00",
                      "message":"\nexpected: 640\n     got: 644\n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/conf/jaspic-providers.xsd` stdout.strip is expected to cmp == 640",
                      "run_time":0.252276882,
                      "start_time":"2020-06-17T00:47:08+00:00",
                      "message":"\nexpected: 640\n     got: 644\n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/conf/logging.properties` stdout.strip is expected to cmp == 640",
                      "run_time":0.260873536,
                      "start_time":"2020-06-17T00:47:08+00:00",
                      "message":"\nexpected: 640\n     got: 644\n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/conf/server.xml` stdout.strip is expected to cmp == 640",
                      "run_time":0.256650655,
                      "start_time":"2020-06-17T00:47:09+00:00",
                      "message":"\nexpected: 640\n     got: 644\n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/conf/test-tomcat.service` stdout.strip is expected to cmp == 640",
                      "run_time":0.264262964,
                      "start_time":"2020-06-17T00:47:09+00:00",
                      "message":"\nexpected: 640\n     got: 644\n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/conf/tomcat-users.xml` stdout.strip is expected to cmp == 640",
                      "run_time":0.257279843,
                      "start_time":"2020-06-17T00:47:09+00:00",
                      "message":"\nexpected: 640\n     got: 644\n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/conf/tomcat-users.xsd` stdout.strip is expected to cmp == 640",
                      "run_time":0.268610967,
                      "start_time":"2020-06-17T00:47:09+00:00",
                      "message":"\nexpected: 640\n     got: 644\n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/conf/web.xml` stdout.strip is expected to cmp == 640",
                      "run_time":0.256821676,
                      "start_time":"2020-06-17T00:47:10+00:00",
                      "message":"\nexpected: 640\n     got: 644\n\n(compared using `cmp` matcher)\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000371",
                "title":"$CATALINA_HOME/conf folder permissions must be set to 750.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have all \n    Tomcat files owned by root with group Tomcat. While root has read/write privileges, group only \n    has read permissions, and world has no permissions. The exceptions are the logs, temp, and work\n     directories that are owned by the Tomcat user rather than root. This means that even if an attacker \n     compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, \n     or modify existing web applications. The Tomcat process runs with a umask of 007 to maintain these permissions.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have all \n    Tomcat files owned by root with group Tomcat. While root has read/write privileges, group only \n    has read permissions, and world has no permissions. The exceptions are the logs, temp, and work\n     directories that are owned by the Tomcat user rather than root. This means that even if an attacker \n     compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, \n     or modify existing web applications. The Tomcat process runs with a umask of 007 to maintain these permissions."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000119-AS-000079",
                   "gid":"TCAT-AS-000371",
                   "rid":"TCAT-AS-000371_rule",
                   "stig_id":"TCAT-AS-000371",
                   "cci":"CCI-000163",
                   "nist":[
                      "AU-9",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/conf -follow -maxdepth 0 -type d \\( \\! -perm 750 \\) -ls\n    If no folders are displayed, this is not a finding.\n    If results indicate the $CATALINA_HOME/conf folder permissions are not set to 750, this is a finding.",
                   "fix":"Run the following command on the Tomcat server:\n    sudo find $CATALINA_HOME/conf -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/conf"
                },
                "code":"control \"TCAT-AS-000371\" do\r\n    title \"$CATALINA_HOME/conf folder permissions must be set to 750.\"\r\n    desc  \"Tomcat file permissions must be restricted. The standard configuration is to have all \r\n    Tomcat files owned by root with group Tomcat. While root has read/write privileges, group only \r\n    has read permissions, and world has no permissions. The exceptions are the logs, temp, and work\r\n     directories that are owned by the Tomcat user rather than root. This means that even if an attacker \r\n     compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, \r\n     or modify existing web applications. The Tomcat process runs with a umask of 007 to maintain these permissions.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000119-AS-000079\"\r\n    tag \"gid\": \"TCAT-AS-000371\"\r\n    tag \"rid\": \"TCAT-AS-000371_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000371\"\r\n    tag \"cci\": \"CCI-000163\"\r\n    tag \"nist\": [\"AU-9\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/conf -follow -maxdepth 0 -type d \\\\( \\\\! -perm 750 \\\\) -ls\r\n    If no folders are displayed, this is not a finding.\r\n    If results indicate the $CATALINA_HOME/conf folder permissions are not set to 750, this is a finding.\"\r\n    tag \"fix\": \"Run the following command on the Tomcat server:\r\n    sudo find $CATALINA_HOME/conf -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/conf\"\r\n\r\n    describe command(\"stat -c %a $CATALINA_HOME/logs\") do \r\n        its(\"stdout.strip\") { should cmp 750 }\r\n    end \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000371.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/logs` stdout.strip is expected to cmp == 750",
                      "run_time":0.000266146,
                      "start_time":"2020-06-17T00:47:10+00:00",
                      "message":"\nexpected: 750\n     got: 777\n\n(compared using `cmp` matcher)\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000380",
                "title":"Jar files in the $CATALINA_HOME/bin/ folder must have their permissions set to 640.",
                "desc":"Tomcat's file permissions must be restricted. The standard configuration is to have all Tomcat files \n    owned by root with the group Tomcat. While root has read/write privileges, tomcat group only has read permissions, \n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the Tomcat \n    user rather than root. This means that even if an attacker compromises the Tomcat process, they cannot change the \n    Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat process runs \n    with a umask of 007 to maintain these permissions.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat's file permissions must be restricted. The standard configuration is to have all Tomcat files \n    owned by root with the group Tomcat. While root has read/write privileges, tomcat group only has read permissions, \n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the Tomcat \n    user rather than root. This means that even if an attacker compromises the Tomcat process, they cannot change the \n    Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat process runs \n    with a umask of 007 to maintain these permissions."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000120-AS-000080",
                   "gid":"TCAT-AS-000380",
                   "rid":"TCAT-AS-000380_rule",
                   "stig_id":"TCAT-AS-000380",
                   "cci":"CCI-000164",
                   "nist":[
                      "AU-9",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/bin/*jar -follow -maxdepth 0 -type f  \\( \\! -perm 640 \\) -ls\n    If there are no results, or if .sh extensions are found, this is not a finding.\n    If results indicate any of the jar file permissions contained in the $CATALINA_HOME/bin folder are not set to 640, this is a finding.",
                   "fix":"Run the following command on the Tomcat server:\n    sudo find $CATALINA_HOME/bin/*jar -follow -maxdepth 0 -type f -print0 | sudo xargs chmod 640 $CATALINA_HOME/bin/*jar"
                },
                "code":"control \"TCAT-AS-000380\" do\r\n    title \"Jar files in the $CATALINA_HOME/bin/ folder must have their permissions set to 640.\"\r\n    desc  \"Tomcat's file permissions must be restricted. The standard configuration is to have all Tomcat files \r\n    owned by root with the group Tomcat. While root has read/write privileges, tomcat group only has read permissions, \r\n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the Tomcat \r\n    user rather than root. This means that even if an attacker compromises the Tomcat process, they cannot change the \r\n    Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat process runs \r\n    with a umask of 007 to maintain these permissions.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000120-AS-000080\"\r\n    tag \"gid\": \"TCAT-AS-000380\"\r\n    tag \"rid\": \"TCAT-AS-000380_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000380\"\r\n    tag \"cci\": \"CCI-000164\"\r\n    tag \"nist\": [\"AU-9\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/bin/*jar -follow -maxdepth 0 -type f  \\\\( \\\\! -perm 640 \\\\) -ls\r\n    If there are no results, or if .sh extensions are found, this is not a finding.\r\n    If results indicate any of the jar file permissions contained in the $CATALINA_HOME/bin folder are not set to 640, this is a finding.\"\r\n    tag \"fix\": \"Run the following command on the Tomcat server:\r\n    sudo find $CATALINA_HOME/bin/*jar -follow -maxdepth 0 -type f -print0 | sudo xargs chmod 640 $CATALINA_HOME/bin/*jar\"\r\n    \r\n    tomcat_jar_dir = command(\"find $CATALINA_HOME/bin/*jar\").stdout.split\r\n    tomcat_jar_dir.each do |jar|\r\n        describe command(\"stat -c %a $CATALINA_HOME/bin/#{jar}\") do\r\n            its('stdout.strip') { should cmp 640 }\r\n        end\r\n    end  \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000380.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/bin//usr/local/tomcat/bin/bootstrap.jar` stdout.strip is expected to cmp == 640",
                      "run_time":0.276925992,
                      "start_time":"2020-06-17T00:47:10+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/bin//usr/local/tomcat/bin/commons-daemon.jar` stdout.strip is expected to cmp == 640",
                      "run_time":0.257120684,
                      "start_time":"2020-06-17T00:47:10+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/bin//usr/local/tomcat/bin/tomcat-juli.jar` stdout.strip is expected to cmp == 640",
                      "run_time":0.273107518,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000390",
                "title":"$CATALINA_HOME/bin folder permissions must be set to 750.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat \n    files owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the \n    Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, they cannot \n    change the Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat \n    process runs with a umask of 007 to maintain these permissions. Note that running Tomcat in a Docker environment \n    can impact how file permissions and user ownership settings are applied. Due to associated Docker configuration \n    complexities, the STIG is scoped for standalone rather than virtual Docker deployments.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat \n    files owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the \n    Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, they cannot \n    change the Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat \n    process runs with a umask of 007 to maintain these permissions. Note that running Tomcat in a Docker environment \n    can impact how file permissions and user ownership settings are applied. Due to associated Docker configuration \n    complexities, the STIG is scoped for standalone rather than virtual Docker deployments."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000121-AS-000081",
                   "gid":"TCAT-AS-000390",
                   "rid":"TCAT-AS-000390_rule",
                   "stig_id":"TCAT-AS-000390",
                   "cci":"CCI-001493",
                   "nist":[
                      "AU-9",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/bin -follow -maxdepth 0 -type d \\( \\! -perm 750 \\) -ls\n    If no folders are displayed, this is not a finding.\n    If results indicate the $CATALINA_HOME/bin folder permissions are not set to 750, this is a finding.",
                   "fix":"Run the following command on the Tomcat server:\n    sudo find $CATALINA_HOME/bin -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/bin"
                },
                "code":"control \"TCAT-AS-000390\" do\r\n    title \"$CATALINA_HOME/bin folder permissions must be set to 750.\"\r\n    desc \"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat \r\n    files owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \r\n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the \r\n    Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, they cannot \r\n    change the Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat \r\n    process runs with a umask of 007 to maintain these permissions. Note that running Tomcat in a Docker environment \r\n    can impact how file permissions and user ownership settings are applied. Due to associated Docker configuration \r\n    complexities, the STIG is scoped for standalone rather than virtual Docker deployments.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000121-AS-000081\"\r\n    tag \"gid\": \"TCAT-AS-000390\"\r\n    tag \"rid\": \"TCAT-AS-000390_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000390\"\r\n    tag \"cci\": \"CCI-001493\"\r\n    tag \"nist\": [\"AU-9\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/bin -follow -maxdepth 0 -type d \\\\( \\\\! -perm 750 \\\\) -ls\r\n    If no folders are displayed, this is not a finding.\r\n    If results indicate the $CATALINA_HOME/bin folder permissions are not set to 750, this is a finding.\"\r\n    tag \"fix\": \"Run the following command on the Tomcat server:\r\n    sudo find $CATALINA_HOME/bin -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/bin\"\r\n    \r\n    describe command(\"stat -c %a $CATALINA_HOME/bin\") do \r\n        its(\"stdout.strip\") { should cmp 750 }\r\n    end \r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000390.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/bin` stdout.strip is expected to cmp == 750",
                      "run_time":0.255390229,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "message":"\nexpected: 750\n     got: 755\n\n(compared using `cmp` matcher)\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000400",
                "title":"$CATALINA_HOME/bin folder permissions must be set to 750.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat \n    files owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the \n    Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, they cannot \n    change the Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat \n    process runs with a umask of 007 to maintain these permissions. Note that running Tomcat in a Docker environment \n    can impact how file permissions and user ownership settings are applied. Due to associated Docker configuration \n    complexities, the STIG is scoped for standalone rather than virtual Docker deployments.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat \n    files owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the \n    Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, they cannot \n    change the Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat \n    process runs with a umask of 007 to maintain these permissions. Note that running Tomcat in a Docker environment \n    can impact how file permissions and user ownership settings are applied. Due to associated Docker configuration \n    complexities, the STIG is scoped for standalone rather than virtual Docker deployments."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000122-AS-000082",
                   "gid":"TCAT-AS-000400",
                   "rid":"TCAT-AS-000400_rule",
                   "stig_id":"TCAT-AS-000400",
                   "cci":"CCI-001494",
                   "nist":[
                      "AU-9",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/bin -follow -maxdepth 0 -type d \\( \\! -perm 750 \\) -ls\n    If no folders are displayed, this is not a finding.\n    If results indicate the $CATALINA_HOME/bin folder permissions are not set to 750, this is a finding.",
                   "fix":"Run the following command on the Tomcat server:\n    sudo find $CATALINA_HOME/bin -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/bin"
                },
                "code":"control \"TCAT-AS-000400\" do\r\n    title \"$CATALINA_HOME/bin folder permissions must be set to 750.\"\r\n    desc  \"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat \r\n    files owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \r\n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the \r\n    Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, they cannot \r\n    change the Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat \r\n    process runs with a umask of 007 to maintain these permissions. Note that running Tomcat in a Docker environment \r\n    can impact how file permissions and user ownership settings are applied. Due to associated Docker configuration \r\n    complexities, the STIG is scoped for standalone rather than virtual Docker deployments.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000122-AS-000082\"\r\n    tag \"gid\": \"TCAT-AS-000400\"\r\n    tag \"rid\": \"TCAT-AS-000400_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000400\"\r\n    tag \"cci\": \"CCI-001494\"\r\n    tag \"nist\": [\"AU-9\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/bin -follow -maxdepth 0 -type d \\\\( \\\\! -perm 750 \\\\) -ls\r\n    If no folders are displayed, this is not a finding.\r\n    If results indicate the $CATALINA_HOME/bin folder permissions are not set to 750, this is a finding.\"\r\n    tag \"fix\": \"Run the following command on the Tomcat server:\r\n    sudo find $CATALINA_HOME/bin -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/bin\"\r\n\r\n    describe command(\"stat -c %a $CATALINA_HOME/bin\") do \r\n        its(\"stdout.strip\") { should cmp 750 }\r\n    end \r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000400.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/bin` stdout.strip is expected to cmp == 750",
                      "run_time":0.000246039,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "message":"\nexpected: 750\n     got: 755\n\n(compared using `cmp` matcher)\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000410",
                "title":"$CATALINA_HOME/bin folder permissions must be set to 750.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat \n    files owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the \n    Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, they cannot \n    change the Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat \n    process runs with a umask of 007 to maintain these permissions. Note that running Tomcat in a Docker environment \n    can impact how file permissions and user ownership settings are applied. Due to associated Docker configuration \n    complexities, the STIG is scoped for standalone rather than virtual Docker deployments.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat \n    files owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the \n    Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, they cannot \n    change the Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat \n    process runs with a umask of 007 to maintain these permissions. Note that running Tomcat in a Docker environment \n    can impact how file permissions and user ownership settings are applied. Due to associated Docker configuration \n    complexities, the STIG is scoped for standalone rather than virtual Docker deployments."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000123-AS-000083",
                   "gid":"TCAT-AS-000410",
                   "rid":"TCAT-AS-000410_rule",
                   "stig_id":"TCAT-AS-000410",
                   "cci":"CCI-001495",
                   "nist":[
                      "AU-9",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/bin -follow -maxdepth 0 -type d \\( \\! -perm 750 \\) -ls\n    If no folders are displayed, this is not a finding.\n    If results indicate the $CATALINA_HOME/bin folder permissions are not set to 750, this is a finding.",
                   "fix":"Run the following command on the Tomcat server:\n    sudo find $CATALINA_HOME/bin -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/bin"
                },
                "code":"control \"TCAT-AS-000410\" do\r\n    title \"$CATALINA_HOME/bin folder permissions must be set to 750.\"\r\n    desc  \"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat \r\n    files owned by root with group Tomcat. While root has read/write privileges, group only has read permissions, \r\n    and world has no permissions. The exceptions are the logs, temp, and work directories that are owned by the \r\n    Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, they cannot \r\n    change the Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat \r\n    process runs with a umask of 007 to maintain these permissions. Note that running Tomcat in a Docker environment \r\n    can impact how file permissions and user ownership settings are applied. Due to associated Docker configuration \r\n    complexities, the STIG is scoped for standalone rather than virtual Docker deployments.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000123-AS-000083\"\r\n    tag \"gid\": \"TCAT-AS-000410\"\r\n    tag \"rid\": \"TCAT-AS-000410_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000410\"\r\n    tag \"cci\": \"CCI-001495\"\r\n    tag \"nist\": [\"AU-9\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/bin -follow -maxdepth 0 -type d \\\\( \\\\! -perm 750 \\\\) -ls\r\n    If no folders are displayed, this is not a finding.\r\n    If results indicate the $CATALINA_HOME/bin folder permissions are not set to 750, this is a finding.\"\r\n    tag \"fix\": \"Run the following command on the Tomcat server:\r\n    sudo find $CATALINA_HOME/bin -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/bin\"\r\n\r\n    describe command(\"stat -c %a $CATALINA_HOME/bin\") do \r\n        its(\"stdout.strip\") { should cmp 750 }\r\n    end \r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000410.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Command: `stat -c %a $CATALINA_HOME/bin` stdout.strip is expected to cmp == 750",
                      "run_time":0.000198372,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "message":"\nexpected: 750\n     got: 755\n\n(compared using `cmp` matcher)\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000450",
                "title":"Tomcat user UMASK must be set to 0027.",
                "desc":"For Unix-based systems, umask settings affect file creation permissions. If the permissions \n    are too loose, newly created log files and applications could be accessible to unauthorized users via \n    the file system. Ensure the Tomcat OS user account has the correct file creation permission settings \n    by validating the OS umask settings for the Tomcat user. Setting umask to 0027 gives the Tomcat user \n    full rights, group users r-x permission, and all others no access. Tomcat will most likely be running \n    as a systemd service. Locate the systemd service file for Tomcat. The default location for the link to \n    the service file is in /etc/systemd/system folder. The service file name should be indicative of the \n    Tomcat process so tomcat.service is the logical name for the service file and is the name referenced \n    by the STIG.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"For Unix-based systems, umask settings affect file creation permissions. If the permissions \n    are too loose, newly created log files and applications could be accessible to unauthorized users via \n    the file system. Ensure the Tomcat OS user account has the correct file creation permission settings \n    by validating the OS umask settings for the Tomcat user. Setting umask to 0027 gives the Tomcat user \n    full rights, group users r-x permission, and all others no access. Tomcat will most likely be running \n    as a systemd service. Locate the systemd service file for Tomcat. The default location for the link to \n    the service file is in /etc/systemd/system folder. The service file name should be indicative of the \n    Tomcat process so tomcat.service is the logical name for the service file and is the name referenced \n    by the STIG."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000133-AS-000092",
                   "gid":"TCAT-AS-000450",
                   "rid":"TCAT-AS-000450_rule",
                   "stig_id":"TCAT-AS-000450",
                   "cci":"CCI-001499",
                   "nist":[
                      "CM-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Reference the system documentation and make relevant changes to the following commands if the system differs:\n    From the Tomcat server command line run the following command:\n    sudo cat /etc/systemd/system/tomcat.service | grep -i umask\n    If the umask is not = 0027, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user:\n    Use a file editor like nano or vi and edit the /etc/systemd/system/tomcat.service file.\n    Change the \"UMask=\" setting to 0027.\n    UMask =0027\n    Save the file and restart Tomcat:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000450\" do\r\n    title \"Tomcat user UMASK must be set to 0027.\"\r\n    desc  \"For Unix-based systems, umask settings affect file creation permissions. If the permissions \r\n    are too loose, newly created log files and applications could be accessible to unauthorized users via \r\n    the file system. Ensure the Tomcat OS user account has the correct file creation permission settings \r\n    by validating the OS umask settings for the Tomcat user. Setting umask to 0027 gives the Tomcat user \r\n    full rights, group users r-x permission, and all others no access. Tomcat will most likely be running \r\n    as a systemd service. Locate the systemd service file for Tomcat. The default location for the link to \r\n    the service file is in /etc/systemd/system folder. The service file name should be indicative of the \r\n    Tomcat process so tomcat.service is the logical name for the service file and is the name referenced \r\n    by the STIG.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000133-AS-000092\"\r\n    tag \"gid\": \"TCAT-AS-000450\"\r\n    tag \"rid\": \"TCAT-AS-000450_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000450\"\r\n    tag \"cci\": \"CCI-001499\"\r\n    tag \"nist\": [\"CM-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Reference the system documentation and make relevant changes to the following commands if the system differs:\r\n    From the Tomcat server command line run the following command:\r\n    sudo cat /etc/systemd/system/tomcat.service | grep -i umask\r\n    If the umask is not = 0027, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user:\r\n    Use a file editor like nano or vi and edit the /etc/systemd/system/tomcat.service file.\r\n    Change the \\\"UMask=\\\" setting to 0027.\r\n    UMask =0027\r\n    Save the file and restart Tomcat:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n    \r\n    tomcat_service_file = parse_config_file('/etc/systemd/system/tomcat.service')\r\n    describe tomcat_service_file do\r\n        its('UMask') { should cmp '0027' }\r\n    end  \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000450.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"Parse Config File /etc/systemd/system/tomcat.service",
                      "run_time":6.036e-06,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "resource":"Parse Config File /etc/systemd/system/tomcat.service",
                      "skip_message":"Can't find file: /etc/systemd/system/tomcat.service"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000470",
                "title":"Stack tracing must be disabled.",
                "desc":"Stack tracing provides debugging information from the application call stacks when a runtime \n    error is encountered. If stack tracing is enabled, Tomcat will provide this call stack information \n    to the requestor which could result in the loss of sensitive information or data that could be used \n    to compromise the system.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Stack tracing provides debugging information from the application call stacks when a runtime \n    error is encountered. If stack tracing is enabled, Tomcat will provide this call stack information \n    to the requestor which could result in the loss of sensitive information or data that could be used \n    to compromise the system."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000141-AS-000095",
                   "gid":"TCAT-AS-000470",
                   "rid":"TCAT-AS-000470_rule",
                   "stig_id":"TCAT-AS-000470",
                   "cci":"CCI-000381",
                   "nist":[
                      "CM-7",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server run the following OS command:\n    sudo cat $CATALINA_HOME/conf/server.xml | grep -i connector \n    Review each connector element, ensure each connector does not have an \"allowTrace\" setting or ensure the \"allowTrace\" setting is set to false.\n    <Connector ... allowTrace=\"false\" />\n    Do the same for each application by checking every $CATALINA_HOME/webapps/<APP_NAME>/WEBINF/web.xml file on the system.\n    sudo cat $CATALINA_HOME/webapps/<APP_NAME>/WEBINF/web.xml |grep -i connector \n    If a connector element in the server.xml file or in any of the <APP NAME>/WEBINF/web.xml files contains the \"allow Trace = true\" statement, this is a finding.\"\n    tag \"fix\": \"From the Tomcat server as a privileged user, edit the xml files containing the \"allow Trace=true\" statement.\n    Remove the \"allow Trace=true\" statement from the affected xml configuration files and restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000470\" do\r\n    title \"Stack tracing must be disabled.\"\r\n    desc  \"Stack tracing provides debugging information from the application call stacks when a runtime \r\n    error is encountered. If stack tracing is enabled, Tomcat will provide this call stack information \r\n    to the requestor which could result in the loss of sensitive information or data that could be used \r\n    to compromise the system.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000141-AS-000095\"\r\n    tag \"gid\": \"TCAT-AS-000470\"\r\n    tag \"rid\": \"TCAT-AS-000470_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000470\"\r\n    tag \"cci\": \"CCI-000381\"\r\n    tag \"nist\": [\"CM-7\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server run the following OS command:\r\n    sudo cat $CATALINA_HOME/conf/server.xml | grep -i connector \r\n    Review each connector element, ensure each connector does not have an \\\"allowTrace\\\" setting or ensure the \\\"allowTrace\\\" setting is set to false.\r\n    <Connector ... allowTrace=\\\"false\\\" />\r\n    Do the same for each application by checking every $CATALINA_HOME/webapps/<APP_NAME>/WEBINF/web.xml file on the system.\r\n    sudo cat $CATALINA_HOME/webapps/<APP_NAME>/WEBINF/web.xml |grep -i connector \r\n    If a connector element in the server.xml file or in any of the <APP NAME>/WEBINF/web.xml files contains the \\\"allow Trace = true\\\" statement, this is a finding.\\\"\r\n    tag \\\"fix\\\": \\\"From the Tomcat server as a privileged user, edit the xml files containing the \\\"allow Trace=true\\\" statement.\r\n    Remove the \\\"allow Trace=true\\\" statement from the affected xml configuration files and restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n    \r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    allow_trace = tomcat_server_file[\"//Connector/@allowTrace\"]\r\n    \r\n    if !allow_trace.empty?\r\n        allow_trace.each do |trace|\r\n            describe trace do \r\n                it { should cmp \"false\" }\r\n            end\r\n        end\r\n    else \r\n        describe allow_trace.empty? do \r\n            it { should cmp \"true\" }\r\n        end\r\n    end\r\n\r\n    apps = command(\"ls $CATALINA_HOME/webapps/\").stdout.split\r\n    ignore = ['docs', 'examples', 'host-manager', 'manager', 'ROOT']\r\n\r\n    ignore.each do |x|\r\n      if apps.include?(x)\r\n        apps.delete(x)\r\n      end\r\n    end\r\n\r\n    if !apps.empty?\r\n        apps.each do |app|\r\n            web_app = xml(\"$CATALINA_HOME/webapps/#{app}/WEB-INF/web.xml\") \r\n            web_allow_trace = web_app[\"//Connector/@allowTrace\"]\r\n\r\n            if !web_allow_trace.empty?\r\n                web_allow_trace.each do |trace|\r\n                    describe trace do \r\n                        it { should cmp \"false\" }\r\n                    end\r\n                end\r\n            else \r\n                describe web_allow_trace.empty? do \r\n                    it { should cmp \"true\" }\r\n                end\r\n            end\r\n        end\r\n    \r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000470.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000470.rb:1 ",
                      "run_time":0.001557429,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000480",
                "title":"Diagnostic tracing must be disabled.",
                "desc":"HTTP Trace provides debugging and diagnostics information for a given request. Diagnostic information, \n    such as that found in the response to a Trace request, often contains sensitive information that may useful to \n    an attacker. By preventing Tomcat from providing this information, the risk of leaking sensitive information \n    to a potential attacker is reduced. HTTP trace is configured via the connector elements in the server.xml file. \n    Each connector element represents an endpoint on the tomcat server which receives and responds to client requests \n    so each connector on the server must be evaluated for the HTTP trace setting.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"HTTP Trace provides debugging and diagnostics information for a given request. Diagnostic information, \n    such as that found in the response to a Trace request, often contains sensitive information that may useful to \n    an attacker. By preventing Tomcat from providing this information, the risk of leaking sensitive information \n    to a potential attacker is reduced. HTTP trace is configured via the connector elements in the server.xml file. \n    Each connector element represents an endpoint on the tomcat server which receives and responds to client requests \n    so each connector on the server must be evaluated for the HTTP trace setting."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000141-AS-000095",
                   "gid":"TCAT-AS-000480",
                   "rid":"TCAT-AS-000480_rule",
                   "stig_id":"TCAT-AS-000480",
                   "cci":"CCI-000381",
                   "nist":[
                      "CM-7",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server run the following OS command:\n    sudo cat $CATALINA_HOME/conf/server.xml | grep -i connector \n    Review each connector element, ensure each connector does not have an \"allowTrace\" setting or ensure the \"allowTrace\" setting is set to false.\n    <Connector ... allowTrace=\"false\" />\n    Do the same for each application by checking every $CATALINA_HOME/webapps/<APP_NAME>/WEBINF/web.xml file on the system.\n    sudo cat $CATALINA_HOME/webapps/<APP_NAME>/WEBINF/web.xml |grep -i connector \n    If a connector element in the server.xml file or in any of the <APP NAME>/WEBINF/web.xml files contains the \"allow Trace = true\" statement, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, edit the xml files containing the \"allow Trace=true\" statement.\n    Remove the \"allow Trace=true\" statement from the affected xml configuration files and restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000480\" do\r\n    title \"Diagnostic tracing must be disabled.\"\r\n    desc  \"HTTP Trace provides debugging and diagnostics information for a given request. Diagnostic information, \r\n    such as that found in the response to a Trace request, often contains sensitive information that may useful to \r\n    an attacker. By preventing Tomcat from providing this information, the risk of leaking sensitive information \r\n    to a potential attacker is reduced. HTTP trace is configured via the connector elements in the server.xml file. \r\n    Each connector element represents an endpoint on the tomcat server which receives and responds to client requests \r\n    so each connector on the server must be evaluated for the HTTP trace setting.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000141-AS-000095\"\r\n    tag \"gid\": \"TCAT-AS-000480\"\r\n    tag \"rid\": \"TCAT-AS-000480_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000480\"\r\n    tag \"cci\": \"CCI-000381\"\r\n    tag \"nist\": [\"CM-7\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server run the following OS command:\r\n    sudo cat $CATALINA_HOME/conf/server.xml | grep -i connector \r\n    Review each connector element, ensure each connector does not have an \\\"allowTrace\\\" setting or ensure the \\\"allowTrace\\\" setting is set to false.\r\n    <Connector ... allowTrace=\\\"false\\\" />\r\n    Do the same for each application by checking every $CATALINA_HOME/webapps/<APP_NAME>/WEBINF/web.xml file on the system.\r\n    sudo cat $CATALINA_HOME/webapps/<APP_NAME>/WEBINF/web.xml |grep -i connector \r\n    If a connector element in the server.xml file or in any of the <APP NAME>/WEBINF/web.xml files contains the \\\"allow Trace = true\\\" statement, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, edit the xml files containing the \\\"allow Trace=true\\\" statement.\r\n    Remove the \\\"allow Trace=true\\\" statement from the affected xml configuration files and restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    allow_trace = tomcat_server_file[\"//Connector/@allowTrace\"]\r\n    \r\n    if !allow_trace.empty?\r\n        allow_trace.each do |trace|\r\n            describe trace do \r\n                it { should cmp \"false\" }\r\n            end\r\n        end\r\n    else \r\n        describe allow_trace.empty? do \r\n            it { should cmp \"true\" }\r\n        end\r\n    end\r\n\r\n    apps = command(\"ls $CATALINA_HOME/webapps/\").stdout.split\r\n    ignore = ['docs', 'examples', 'host-manager', 'manager', 'ROOT']\r\n\r\n    ignore.each do |x|\r\n      if apps.include?(x)\r\n        apps.delete(x)\r\n      end\r\n    end\r\n\r\n    if !apps.empty?\r\n        apps.each do |app|\r\n            web_app = xml(\"$CATALINA_HOME/webapps/#{app}/WEB-INF/web.xml\") \r\n            web_allow_trace = web_app[\"//Connector/@allowTrace\"]\r\n\r\n            if !web_allow_trace.empty?\r\n                web_allow_trace.each do |trace|\r\n                    describe trace do \r\n                        it { should cmp \"false\" }\r\n                    end\r\n                end\r\n            else \r\n                describe web_allow_trace.empty? do \r\n                    it { should cmp \"true\" }\r\n                end\r\n            end\r\n        end\r\n    \r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000480.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000480.rb:1 ",
                      "run_time":0.001523152,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000490",
                "title":"The shutdown port must be disabled.",
                "desc":"Tomcat listens on TCP port 8005 to accept shutdown requests. By connecting to this port and \n    sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not \n    exposed to the network as it is bound to the loopback interface. Set the shutdown attribute in \n    $CATALINA_HOME/conf/server.xml.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat listens on TCP port 8005 to accept shutdown requests. By connecting to this port and \n    sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not \n    exposed to the network as it is bound to the loopback interface. Set the shutdown attribute in \n    $CATALINA_HOME/conf/server.xml."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000141-AS-000095",
                   "gid":"TCAT-AS-000490",
                   "rid":"TCAT-AS-000490_rule",
                   "stig_id":"TCAT-AS-000490",
                   "cci":"CCI-000381",
                   "nist":[
                      "CM-7",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server run the following OS command:\n    $ sudo grep -i shutdown $CATALINA_HOME/conf/server.xml\n    Ensure the server shutdown port attribute in $CATALINA_HOME/conf/server.xml is set to -1. \n    EXAMPLE:\n    <Server port=\"-1\" shutdown=\"SHUTDOWN\">\n    If Server port not = \"-1\" shutdown=\"SHUTDOWN\", this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/conf/server.xml file: set the Server port \n    setting to -1 and restart the Tomcat server:\n    <Server port=\"-1\" shutdown=\"SHUTDOWN\">\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000490\" do\r\n    title \"The shutdown port must be disabled.\"\r\n    desc  \"Tomcat listens on TCP port 8005 to accept shutdown requests. By connecting to this port and \r\n    sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not \r\n    exposed to the network as it is bound to the loopback interface. Set the shutdown attribute in \r\n    $CATALINA_HOME/conf/server.xml.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000141-AS-000095\"\r\n    tag \"gid\": \"TCAT-AS-000490\"\r\n    tag \"rid\": \"TCAT-AS-000490_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000490\"\r\n    tag \"cci\": \"CCI-000381\"\r\n    tag \"nist\": [\"CM-7\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server run the following OS command:\r\n    $ sudo grep -i shutdown $CATALINA_HOME/conf/server.xml\r\n    Ensure the server shutdown port attribute in $CATALINA_HOME/conf/server.xml is set to -1. \r\n    EXAMPLE:\r\n    <Server port=\\\"-1\\\" shutdown=\\\"SHUTDOWN\\\">\r\n    If Server port not = \\\"-1\\\" shutdown=\\\"SHUTDOWN\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/conf/server.xml file: set the Server port \r\n    setting to -1 and restart the Tomcat server:\r\n    <Server port=\\\"-1\\\" shutdown=\\\"SHUTDOWN\\\">\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    shutdown_port = tomcat_server_file[\"//Server/@port\"]\r\n    describe shutdown_port do \r\n        it { should cmp '-1' }\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000490.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000490.rb:1 ",
                      "run_time":0.003660218,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000500",
                "title":"Unapproved connectors must be disabled.",
                "desc":"Connectors are how Tomcat receives requests, passes them to hosted web applications, \n    and then sends back the results to the requestor. Tomcat provides HTTP and Apache JServ Protocol (AJP) \n    connectors and makes these protocols available via configured network ports. Unapproved connectors \n    provide open network connections to either of these protocols and puts the system at risk.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Connectors are how Tomcat receives requests, passes them to hosted web applications, \n    and then sends back the results to the requestor. Tomcat provides HTTP and Apache JServ Protocol (AJP) \n    connectors and makes these protocols available via configured network ports. Unapproved connectors \n    provide open network connections to either of these protocols and puts the system at risk."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000141-AS-000095",
                   "gid":"TCAT-AS-000500",
                   "rid":"TCAT-AS-000500_rule",
                   "stig_id":"TCAT-AS-000500",
                   "cci":"CCI-000381",
                   "nist":[
                      "CM-7",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Review SSP for list of approved connectors and associated TCP/IP ports. \n    Ensure only approved connectors are present. Execute the following command on the Tomcat \n    server to find configured Connectors:\n    $ grep \"Connector\" $CATALINA_HOME/conf/server.xml\n    Review results and verify all connectors and their associated network ports are approved in the SSP.\n    If connectors are found but are not approved in the SSP, this is a finding.",
                   "fix":"Obtain ISSO approvals for the configured connectors and document in the SSP.\n    Alternatively, edit the $CATALINA_HOME/conf/server.xml file, remove any unapproved connectors, \n    and restart Tomcat by running the command: \n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000500\" do\r\n    title \"Unapproved connectors must be disabled.\"\r\n    desc  \"Connectors are how Tomcat receives requests, passes them to hosted web applications, \r\n    and then sends back the results to the requestor. Tomcat provides HTTP and Apache JServ Protocol (AJP) \r\n    connectors and makes these protocols available via configured network ports. Unapproved connectors \r\n    provide open network connections to either of these protocols and puts the system at risk.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000141-AS-000095\"\r\n    tag \"gid\": \"TCAT-AS-000500\"\r\n    tag \"rid\": \"TCAT-AS-000500_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000500\"\r\n    tag \"cci\": \"CCI-000381\"\r\n    tag \"nist\": [\"CM-7\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Review SSP for list of approved connectors and associated TCP/IP ports. \r\n    Ensure only approved connectors are present. Execute the following command on the Tomcat \r\n    server to find configured Connectors:\r\n    $ grep \\\"Connector\\\" $CATALINA_HOME/conf/server.xml\r\n    Review results and verify all connectors and their associated network ports are approved in the SSP.\r\n    If connectors are found but are not approved in the SSP, this is a finding.\"\r\n    tag \"fix\": \"Obtain ISSO approvals for the configured connectors and document in the SSP.\r\n    Alternatively, edit the $CATALINA_HOME/conf/server.xml file, remove any unapproved connectors, \r\n    and restart Tomcat by running the command: \r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    describe \"This is a manual check\" do\r\n        skip \"Verify all connectors and their associated ports in the $CATALINA_HOME/conf/server.xml are approved in the SSP.\"\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000500.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":5.41e-06,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "resource":"",
                      "skip_message":"Verify all connectors and their associated ports in the $CATALINA_HOME/conf/server.xml are approved in the SSP."
                   }
                ]
             },
             {
                "id":"TCAT-AS-000510",
                "title":"DefaultServlet debug parameter must be disabled.",
                "desc":"The DefaultServlet serves static resources as well as serves the directory listings \n    (if directory listings are enabled). It is declared globally in $CATALINA_BASE/conf/web.xml \n    and by default is configured with the \"debug\" parameter set to 0, which is disabled. \n    Changing this to a value of 1 or higher sets the servlet to print debug level information. \n    DefaultServlet debug setting must be set to 0 (disabled).",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The DefaultServlet serves static resources as well as serves the directory listings \n    (if directory listings are enabled). It is declared globally in $CATALINA_BASE/conf/web.xml \n    and by default is configured with the \"debug\" parameter set to 0, which is disabled. \n    Changing this to a value of 1 or higher sets the servlet to print debug level information. \n    DefaultServlet debug setting must be set to 0 (disabled)."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000141-AS-000095",
                   "gid":"TCAT-AS-000510",
                   "rid":"TCAT-AS-000510_rule",
                   "stig_id":"TCAT-AS-000510",
                   "cci":"CCI-000381",
                   "nist":[
                      "CM-7",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server run the following OS command:\n    sudo cat $CATALINA_BASE/conf/web.xml |grep -i -A10 -B2 defaultservlet \n    The above command will include ten lines after and two lines before the occurrence of \"defaultservlet\". \n    Some systems may require that the user increase the after number (A10) in order to determine the \"debug\" param-value. \n    If the \"debug\" param-value for the \"DefaultServlet\" servlet class does not = 0, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user:\n    Edit the $CATALINA_HOME/conf/web.xml file. Examine the <init-param> elements within the <Servletclass> element, if the \n    \"debug\" <param-value>element is not \"0\" change the \"debug\" <param-value> to read \"0\".\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000510\" do\r\n    title \"DefaultServlet debug parameter must be disabled.\"\r\n    desc  \"The DefaultServlet serves static resources as well as serves the directory listings \r\n    (if directory listings are enabled). It is declared globally in $CATALINA_BASE/conf/web.xml \r\n    and by default is configured with the \\\"debug\\\" parameter set to 0, which is disabled. \r\n    Changing this to a value of 1 or higher sets the servlet to print debug level information. \r\n    DefaultServlet debug setting must be set to 0 (disabled).\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000141-AS-000095\"\r\n    tag \"gid\": \"TCAT-AS-000510\"\r\n    tag \"rid\": \"TCAT-AS-000510_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000510\"\r\n    tag \"cci\": \"CCI-000381\"\r\n    tag \"nist\": [\"CM-7\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server run the following OS command:\r\n    sudo cat $CATALINA_BASE/conf/web.xml |grep -i -A10 -B2 defaultservlet \r\n    The above command will include ten lines after and two lines before the occurrence of \\\"defaultservlet\\\". \r\n    Some systems may require that the user increase the after number (A10) in order to determine the \\\"debug\\\" param-value. \r\n    If the \\\"debug\\\" param-value for the \\\"DefaultServlet\\\" servlet class does not = 0, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user:\r\n    Edit the $CATALINA_HOME/conf/web.xml file. Examine the <init-param> elements within the <Servletclass> element, if the \r\n    \\\"debug\\\" <param-value>element is not \\\"0\\\" change the \\\"debug\\\" <param-value> to read \\\"0\\\".\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_web_file = xml(\"$CATALINA_HOME/conf/web.xml\") \r\n    servlets = tomcat_web_file[\"//servlet/servlet-name\"]\r\n    check_params = tomcat_web_file[\"//servlet/init-param/param-name\"]\r\n    index = 0\r\n    param_index = 0\r\n\r\n    only_if(\"Run only if DefaultServlet has debug enabled\") do\r\n        check_params.include?(\"debug\")\r\n    end \r\n\r\n    if !servlets.empty?\r\n        servlets.each do |servlet|\r\n            for i in 1..servlets.count\r\n                if servlet == \"default\"\r\n                    index+=1\r\n                    break\r\n                end\r\n            end\r\n        end\r\n        params = tomcat_web_file[\"//servlet[#{index}]/init-param/param-name\"]\r\n\r\n        params.each do |param|\r\n            for i in 1..params.count\r\n                if param == \"debug\"\r\n                    index+=1\r\n                    break\r\n                end\r\n            end\r\n        end\r\n\r\n        readonly = tomcat_web_file[\"//servlet[1]/init-param[#{param_index}]/param-value\"]\r\n        describe readonly do \r\n            it { should cmp \"0\" }\r\n        end\r\n    end \r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000510.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000510.rb:1 ",
                      "run_time":0.003153502,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000520",
                "title":"DefaultServlet directory listings parameter must be disabled.",
                "desc":"The DefaultServlet serves static resources as well as directory listings. It is declared \n    globally in $CATALINA_BASE/conf/web.xml and by default is configured with the directory \"listings\" \n    parameter set to disabled. If no welcome file is present and the \"listings\" setting is enabled, \n    a directory listing is shown. Directory listings must be disabled.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The DefaultServlet serves static resources as well as directory listings. It is declared \n    globally in $CATALINA_BASE/conf/web.xml and by default is configured with the directory \"listings\" \n    parameter set to disabled. If no welcome file is present and the \"listings\" setting is enabled, \n    a directory listing is shown. Directory listings must be disabled."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000141-AS-000095",
                   "gid":"TCAT-AS-000520",
                   "rid":"TCAT-AS-000520_rule",
                   "stig_id":"TCAT-AS-000520",
                   "cci":"CCI-000381",
                   "nist":[
                      "CM-7",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server run the following OS command:\n    sudo cat $CATALINA_HOME/conf/web.xml |grep -i -A10 -B2 defaultservlet \n    The above command will include ten lines after and two lines before the occurrence of \"defaultservlet\". \n    Some systems may require that the user increase the after number (A10) in order to determine the \"listings\" param-value. \n    If the \"listings\" param-value for the \"DefaultServlet\" servlet class does not = \"false\", this is a finding.",
                   "fix":"From the Tomcat server as a privileged user:\n    Edit the $CATALINA_HOME/conf/web.xml file.\n    Examine the <init-param> elements within the <Servletclass> element, if the \"listings\" <param-value>element \n    is \"true\" change the \"listings\" <param-value> to read \"false\".\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000520\" do\r\n    title \"DefaultServlet directory listings parameter must be disabled.\"\r\n    desc  \"The DefaultServlet serves static resources as well as directory listings. It is declared \r\n    globally in $CATALINA_BASE/conf/web.xml and by default is configured with the directory \\\"listings\\\" \r\n    parameter set to disabled. If no welcome file is present and the \\\"listings\\\" setting is enabled, \r\n    a directory listing is shown. Directory listings must be disabled.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000141-AS-000095\"\r\n    tag \"gid\": \"TCAT-AS-000520\"\r\n    tag \"rid\": \"TCAT-AS-000520_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000520\"\r\n    tag \"cci\": \"CCI-000381\"\r\n    tag \"nist\": [\"CM-7\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server run the following OS command:\r\n    sudo cat $CATALINA_HOME/conf/web.xml |grep -i -A10 -B2 defaultservlet \r\n    The above command will include ten lines after and two lines before the occurrence of \\\"defaultservlet\\\". \r\n    Some systems may require that the user increase the after number (A10) in order to determine the \\\"listings\\\" param-value. \r\n    If the \\\"listings\\\" param-value for the \\\"DefaultServlet\\\" servlet class does not = \\\"false\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user:\r\n    Edit the $CATALINA_HOME/conf/web.xml file.\r\n    Examine the <init-param> elements within the <Servletclass> element, if the \\\"listings\\\" <param-value>element \r\n    is \\\"true\\\" change the \\\"listings\\\" <param-value> to read \\\"false\\\".\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_web_file = xml(\"$CATALINA_HOME/conf/web.xml\") \r\n    servlets = tomcat_web_file[\"//servlet/servlet-name\"]\r\n    check_params = tomcat_web_file[\"//servlet/init-param/param-name\"]\r\n    index = 0\r\n    param_index = 0\r\n\r\n    only_if(\"Run only if DefaultServlet has listings enabled\") do\r\n        check_params.include?(\"listings\")\r\n    end \r\n\r\n    if !servlets.empty?\r\n        servlets.each do |servlet|\r\n            for i in 1..servlets.count\r\n                if servlet == \"default\"\r\n                    index+=1\r\n                    break\r\n                end\r\n            end\r\n        end\r\n        params = tomcat_web_file[\"//servlet[#{index}]/init-param/param-name\"]\r\n\r\n        params.each do |param|\r\n            for i in 1..params.count\r\n                if param == \"listings\"\r\n                    index+=1\r\n                    break\r\n                end\r\n            end\r\n        end\r\n\r\n        readonly = tomcat_web_file[\"//servlet[1]/init-param[#{param_index}]/param-value\"]\r\n        describe readonly do \r\n            it { should cmp \"false\" }\r\n        end\r\n    end \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000520.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000520.rb:1 ",
                      "run_time":0.004086664,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000530",
                "title":"The deployXML attribute must be set to false in hosted environments.",
                "desc":"The Host element controls deployment. Automatic deployment allows for simpler management, \n    but also makes it easier for an attacker to deploy a malicious application. Automatic deployment \n    is controlled by the autoDeploy and deployOnStartup attributes. If both are false, only Contexts \n    defined in server.xml will be deployed, and any changes will require a Tomcat restart. In a hosted \n    environment where web applications may not be trusted, set the deployXML attribute to false to ignore \n    any context.xml packaged with the web application that may try to assign increased privileges to the web \n    application. Note that if the security manager is enabled that the deployXML attribute will default to false.\n    This requirement is NA for test and development systems on non-production networks. For DevSecOps application \n    environments, the ISSM may authorize autodeploy functions on a production Tomcat system if the mission need \n    specifies it and an application security vulnerability testing and assurance regimen is included in the \n    DevSecOps process.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The Host element controls deployment. Automatic deployment allows for simpler management, \n    but also makes it easier for an attacker to deploy a malicious application. Automatic deployment \n    is controlled by the autoDeploy and deployOnStartup attributes. If both are false, only Contexts \n    defined in server.xml will be deployed, and any changes will require a Tomcat restart. In a hosted \n    environment where web applications may not be trusted, set the deployXML attribute to false to ignore \n    any context.xml packaged with the web application that may try to assign increased privileges to the web \n    application. Note that if the security manager is enabled that the deployXML attribute will default to false.\n    This requirement is NA for test and development systems on non-production networks. For DevSecOps application \n    environments, the ISSM may authorize autodeploy functions on a production Tomcat system if the mission need \n    specifies it and an application security vulnerability testing and assurance regimen is included in the \n    DevSecOps process."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000141-AS-000095",
                   "gid":"TCAT-AS-000530",
                   "rid":"TCAT-AS-000530_rule",
                   "stig_id":"TCAT-AS-000530",
                   "cci":"CCI-000381",
                   "nist":[
                      "CM-7",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"This requirement is NA for test and development systems on non-production networks. \n    For production application environments, the ISSM may authorize autodeploy functions on a production \n    Tomcat system if the mission need specifies it and an application security vulnerability testing \n    and assurance regimen is included in the DevSecOps process or other application development processes \n    and satisfactory results from the latest vulnerability testing are provided to the inspector during readiness review.\n    From the Tomcat server as a privileged user:\n    sudo grep -i deployXML $CATALINA_HOME/conf/server.xml\n    If the deployXML setting is configured as true and there is no documented authorization to allow automatic \n    deployment of applications, this is a finding.",
                   "fix":"Document authorization for application auto deployment in the System Security Plan (SSP).\n    From the Tomcat server as a privileged user, edit the $CATALINA_HOME/conf/server.xml file.\n    sudo nano $CATALINA_HOME/conf/server.xml\n    Locate each <host> element in the server xml file and if the deployXML=\"true\" ensure each host is authorized \n    for application auto deployment and document the authorization in the system security plan. If authorization \n    is not provided, set the deployXML=\"false\""
                },
                "code":"control \"TCAT-AS-000530\" do\r\n    title \"The deployXML attribute must be set to false in hosted environments.\"\r\n    desc  \"The Host element controls deployment. Automatic deployment allows for simpler management, \r\n    but also makes it easier for an attacker to deploy a malicious application. Automatic deployment \r\n    is controlled by the autoDeploy and deployOnStartup attributes. If both are false, only Contexts \r\n    defined in server.xml will be deployed, and any changes will require a Tomcat restart. In a hosted \r\n    environment where web applications may not be trusted, set the deployXML attribute to false to ignore \r\n    any context.xml packaged with the web application that may try to assign increased privileges to the web \r\n    application. Note that if the security manager is enabled that the deployXML attribute will default to false.\r\n    This requirement is NA for test and development systems on non-production networks. For DevSecOps application \r\n    environments, the ISSM may authorize autodeploy functions on a production Tomcat system if the mission need \r\n    specifies it and an application security vulnerability testing and assurance regimen is included in the \r\n    DevSecOps process.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000141-AS-000095\"\r\n    tag \"gid\": \"TCAT-AS-000530\"\r\n    tag \"rid\": \"TCAT-AS-000530_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000530\"\r\n    tag \"cci\": \"CCI-000381\"\r\n    tag \"nist\": [\"CM-7\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"This requirement is NA for test and development systems on non-production networks. \r\n    For production application environments, the ISSM may authorize autodeploy functions on a production \r\n    Tomcat system if the mission need specifies it and an application security vulnerability testing \r\n    and assurance regimen is included in the DevSecOps process or other application development processes \r\n    and satisfactory results from the latest vulnerability testing are provided to the inspector during readiness review.\r\n    From the Tomcat server as a privileged user:\r\n    sudo grep -i deployXML $CATALINA_HOME/conf/server.xml\r\n    If the deployXML setting is configured as true and there is no documented authorization to allow automatic \r\n    deployment of applications, this is a finding.\"\r\n    tag \"fix\": \"Document authorization for application auto deployment in the System Security Plan (SSP).\r\n    From the Tomcat server as a privileged user, edit the $CATALINA_HOME/conf/server.xml file.\r\n    sudo nano $CATALINA_HOME/conf/server.xml\r\n    Locate each <host> element in the server xml file and if the deployXML=\\\"true\\\" ensure each host is authorized \r\n    for application auto deployment and document the authorization in the system security plan. If authorization \r\n    is not provided, set the deployXML=\\\"false\\\"\"\r\n    \r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    deploy_xml = tomcat_server_file[\"//Host/@deployXML\"]\r\n    if !deploy_xml.empty?\r\n        deploy_xml.each do |item|\r\n            describe item do \r\n                it { should cmp \"false\" }\r\n            end \r\n        end \r\n    else \r\n        describe \"deployXML was not found in server.xml\" do \r\n           skip \"deployXML was not found in server.xml. Skipping this check.\"\r\n        end \r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000530.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000530.rb:1 ",
                      "run_time":0.001564909,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000540",
                "title":"Autodeploy must be disabled.",
                "desc":"Tomcat allows auto-deployment of applications while Tomcat is running. This can allow untested \n    or malicious applications to be automatically loaded into production. Autodeploy must be disabled in production. \n    This requirement is NA for test and development systems on non-production networks. For DevSecOps application \n    environments, the ISSM may authorize autodeploy functions on a production Tomcat system if the mission need \n    specifies it and an application security vulnerability testing and assurance regimen is included in the DevSecOps process.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat allows auto-deployment of applications while Tomcat is running. This can allow untested \n    or malicious applications to be automatically loaded into production. Autodeploy must be disabled in production. \n    This requirement is NA for test and development systems on non-production networks. For DevSecOps application \n    environments, the ISSM may authorize autodeploy functions on a production Tomcat system if the mission need \n    specifies it and an application security vulnerability testing and assurance regimen is included in the DevSecOps process."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000141-AS-000095",
                   "gid":"TCAT-AS-000540",
                   "rid":"TCAT-AS-000540_rule",
                   "stig_id":"TCAT-AS-000540",
                   "cci":"CCI-000381",
                   "nist":[
                      "CM-7",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"If the Tomcat system is a development or test system on a non-production network, this requirement is NA.\n    If the SSP associated with the Host contains ISSM documented approvals for AutoDeploy, this is not a finding.\n    From the Tomcat server run the following OS command:\n    sudo cat $CATALINA_HOME/conf/server.xml | grep -i -C2 autodeploy \n    If the command returns no results, this is not a finding.\n    Review the results for the autoDeploy parameter in each Host element. \n    <Host name=\"YOUR HOST NAME\" appbase=\"webapps\" unpackWARs=\"true\" autoDeploy=\"false\"> \n    If autoDeploy =\"true\", this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/conf/server.xml file.\n    Examine each <Host> </Host> element, if the element contains xpoweredBy=\"true\", modify the statement to read \", xpoweredBy=\"false\".\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000540\" do\r\n    title \"Autodeploy must be disabled.\"\r\n    desc  \"Tomcat allows auto-deployment of applications while Tomcat is running. This can allow untested \r\n    or malicious applications to be automatically loaded into production. Autodeploy must be disabled in production. \r\n    This requirement is NA for test and development systems on non-production networks. For DevSecOps application \r\n    environments, the ISSM may authorize autodeploy functions on a production Tomcat system if the mission need \r\n    specifies it and an application security vulnerability testing and assurance regimen is included in the DevSecOps process.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000141-AS-000095\"\r\n    tag \"gid\": \"TCAT-AS-000540\"\r\n    tag \"rid\": \"TCAT-AS-000540_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000540\"\r\n    tag \"cci\": \"CCI-000381\"\r\n    tag \"nist\": [\"CM-7\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"If the Tomcat system is a development or test system on a non-production network, this requirement is NA.\r\n    If the SSP associated with the Host contains ISSM documented approvals for AutoDeploy, this is not a finding.\r\n    From the Tomcat server run the following OS command:\r\n    sudo cat $CATALINA_HOME/conf/server.xml | grep -i -C2 autodeploy \r\n    If the command returns no results, this is not a finding.\r\n    Review the results for the autoDeploy parameter in each Host element. \r\n    <Host name=\\\"YOUR HOST NAME\\\" appbase=\\\"webapps\\\" unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\"> \r\n    If autoDeploy =\\\"true\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/conf/server.xml file.\r\n    Examine each <Host> </Host> element, if the element contains xpoweredBy=\\\"true\\\", modify the statement to read \\\", xpoweredBy=\\\"false\\\".\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    auto_deploy = tomcat_server_file[\"//Host/@autoDeploy\"]\r\n    if !auto_deploy.empty?\r\n        auto_deploy.each do |item|\r\n            describe item do \r\n                it { should cmp \"false\" }\r\n            end \r\n        end \r\n    else \r\n        describe \"autoDeploy was not found in server.xml\" do \r\n           skip \"audoDeploy was not found in server.xml. Skipping this check.\"\r\n        end \r\n    end\r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000540.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000540.rb:1 ",
                      "run_time":0.001513337,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000550",
                "title":"The xpoweredBy attribute must be disabled.",
                "desc":"Individual connectors can be configured to display the Tomcat server info to clients. \n    This information can be used to identify Tomcat versions which can be useful to attackers for \n    identifying vulnerable versions of Tomcat. Individual connectors must be checked for the xpoweredBy \n    attribute to ensure they do not pass Tomcat server info to clients.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Individual connectors can be configured to display the Tomcat server info to clients. \n    This information can be used to identify Tomcat versions which can be useful to attackers for \n    identifying vulnerable versions of Tomcat. Individual connectors must be checked for the xpoweredBy \n    attribute to ensure they do not pass Tomcat server info to clients."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000141-AS-000095",
                   "gid":"TCAT-AS-000550",
                   "rid":"TCAT-AS-000550_rule",
                   "stig_id":"TCAT-AS-000550",
                   "cci":"CCI-000381",
                   "nist":[
                      "CM-7",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server run the following OS command:\n    sudo cat $CATALINA_HOME/conf/server.xml |grep -i -C4 xpoweredby.\n    If any connector elements contain xpoweredBy=\"true\", this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/conf/server.xml file.\n    Examine each <Connector> </Connector> element, if the element contains xpoweredBy=\"true\", modify the statement \n    to read xpoweredBy=\"false\".\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000550\" do\r\n    title \"The xpoweredBy attribute must be disabled.\"\r\n    desc  \"Individual connectors can be configured to display the Tomcat server info to clients. \r\n    This information can be used to identify Tomcat versions which can be useful to attackers for \r\n    identifying vulnerable versions of Tomcat. Individual connectors must be checked for the xpoweredBy \r\n    attribute to ensure they do not pass Tomcat server info to clients.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000141-AS-000095\"\r\n    tag \"gid\": \"TCAT-AS-000550\"\r\n    tag \"rid\": \"TCAT-AS-000550_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000550\"\r\n    tag \"cci\": \"CCI-000381\"\r\n    tag \"nist\": [\"CM-7\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server run the following OS command:\r\n    sudo cat $CATALINA_HOME/conf/server.xml |grep -i -C4 xpoweredby.\r\n    If any connector elements contain xpoweredBy=\\\"true\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/conf/server.xml file.\r\n    Examine each <Connector> </Connector> element, if the element contains xpoweredBy=\\\"true\\\", modify the statement \r\n    to read xpoweredBy=\\\"false\\\".\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    x_powered_by = tomcat_server_file[\"//Connector/@xpoweredBy\"]\r\n    if !x_powered_by.empty?\r\n        xPoweredBy.each do |item|\r\n            describe item do \r\n                it { should cmp \"false\" }\r\n            end \r\n        end\r\n    else \r\n        describe x_powered_by do \r\n            skip \"There is no xpoweredBy param set for Connector. Skipping this check\"\r\n        end \r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000550.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000550.rb:1 ",
                      "run_time":0.001647538,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000560",
                "title":"Example applications must be removed.",
                "desc":"Tomcat provides example applications, documentation, and other directories in the default \n    installation which do not serve a production use. These files must be deleted.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat provides example applications, documentation, and other directories in the default \n    installation which do not serve a production use. These files must be deleted."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000141-AS-000095",
                   "gid":"TCAT-AS-000560",
                   "rid":"TCAT-AS-000560_rule",
                   "stig_id":"TCAT-AS-000560",
                   "cci":"CCI-000381",
                   "nist":[
                      "CM-7",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server OS type the following command:\n    sudo ls -l $CATALINA_HOME/webapps/examples. \n    If the examples folder exists or contains any content, this is a finding.",
                   "fix":"From the Tomcat server OS type the following command:\n    sudo rm -rf $CATALINA_HOME/webapps/examples"
                },
                "code":"control \"TCAT-AS-000560\" do\r\n    title \"Example applications must be removed.\"\r\n    desc  \"Tomcat provides example applications, documentation, and other directories in the default \r\n    installation which do not serve a production use. These files must be deleted.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000141-AS-000095\"\r\n    tag \"gid\": \"TCAT-AS-000560\"\r\n    tag \"rid\": \"TCAT-AS-000560_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000560\"\r\n    tag \"cci\": \"CCI-000381\"\r\n    tag \"nist\": [\"CM-7\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server OS type the following command:\r\n    sudo ls -l $CATALINA_HOME/webapps/examples. \r\n    If the examples folder exists or contains any content, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server OS type the following command:\r\n    sudo rm -rf $CATALINA_HOME/webapps/examples\"\r\n\r\n    describe command(\"ls -l $CATALINA_HOME/webapps/examples\") do\r\n        its('stdout.strip') { should eq '' }\r\n    end\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000560.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"passed",
                      "code_desc":"Command: `ls -l $CATALINA_HOME/webapps/examples` stdout.strip is expected to eq \"\"",
                      "run_time":0.257439058,
                      "start_time":"2020-06-17T00:47:11+00:00"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000570",
                "title":"Tomcat default ROOT web application must be removed.",
                "desc":"The default ROOT web application includes the version of Tomcat that is being used, links to Tomcat documentation, \n    examples, FAQs, and mailing lists. The default ROOT web application must be removed from a publicly accessible Tomcat \n    instance and a more appropriate default page shown to users. It is acceptable to replace the contents of default ROOT \n    with a new default web application.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The default ROOT web application includes the version of Tomcat that is being used, links to Tomcat documentation, \n    examples, FAQs, and mailing lists. The default ROOT web application must be removed from a publicly accessible Tomcat \n    instance and a more appropriate default page shown to users. It is acceptable to replace the contents of default ROOT \n    with a new default web application."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000141-AS-000095",
                   "gid":"TCAT-AS-000570",
                   "rid":"TCAT-AS-000570_rule",
                   "stig_id":"TCAT-AS-000570",
                   "cci":"CCI-000381",
                   "nist":[
                      "CM-7",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server OS type the following command:\n    sudo ls -l $CATALINA_HOME/webapps/ROOT\n    Review the index.jsp file also review the RELEASE-NOTES.txt file. Look for content that describes the application as \n    being licensed by the Apache Software Foundation. Check the index.jsp for other verbiage that indicates the application \n    is part of the Tomcat server. Alternatively, use a web browser and access the default web application and make the \n    determination if the web site application in the ROOT folder is provided with the Apache Tomcat server.\n    If the ROOT web application contains Tomcat default application content, this is a finding.",
                   "fix":"From the Tomcat server OS:\n    Either remove the files contained in $CATALINA_HOME/webapps/ROOT folder or replace the content of the folder with a \n    new application that serves as the new default server application."
                },
                "code":"control \"TCAT-AS-000570\" do\r\n    title \"Tomcat default ROOT web application must be removed.\"\r\n    desc  \"The default ROOT web application includes the version of Tomcat that is being used, links to Tomcat documentation, \r\n    examples, FAQs, and mailing lists. The default ROOT web application must be removed from a publicly accessible Tomcat \r\n    instance and a more appropriate default page shown to users. It is acceptable to replace the contents of default ROOT \r\n    with a new default web application.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000141-AS-000095\"\r\n    tag \"gid\": \"TCAT-AS-000570\"\r\n    tag \"rid\": \"TCAT-AS-000570_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000570\"\r\n    tag \"cci\": \"CCI-000381\"\r\n    tag \"nist\": [\"CM-7\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server OS type the following command:\r\n    sudo ls -l $CATALINA_HOME/webapps/ROOT\r\n    Review the index.jsp file also review the RELEASE-NOTES.txt file. Look for content that describes the application as \r\n    being licensed by the Apache Software Foundation. Check the index.jsp for other verbiage that indicates the application \r\n    is part of the Tomcat server. Alternatively, use a web browser and access the default web application and make the \r\n    determination if the web site application in the ROOT folder is provided with the Apache Tomcat server.\r\n    If the ROOT web application contains Tomcat default application content, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server OS:\r\n    Either remove the files contained in $CATALINA_HOME/webapps/ROOT folder or replace the content of the folder with a \r\n    new application that serves as the new default server application.\"\r\n\r\n    \r\n    describe \"This is a manual check\" do \r\n        skip \"Review the index.jsp and RELEASE_NOTES.txt files in the ROOT folder. \r\n        If they contain default application content. This is a finding.\"\r\n    end\r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000570.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":6.784e-06,
                      "start_time":"2020-06-17T00:47:11+00:00",
                      "resource":"",
                      "skip_message":"Review the index.jsp and RELEASE_NOTES.txt files in the ROOT folder. \n        If they contain default application content. This is a finding."
                   }
                ]
             },
             {
                "id":"TCAT-AS-000580",
                "title":"Documentation must be removed.",
                "desc":"Tomcat provides documentation and other directories in the default \n    installation which do not serve a production use. These files must be deleted.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat provides documentation and other directories in the default \n    installation which do not serve a production use. These files must be deleted."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000141-AS-000095",
                   "gid":"TCAT-AS-000580",
                   "rid":"TCAT-AS-000580_rule",
                   "stig_id":"TCAT-AS-000580",
                   "cci":"CCI-000381",
                   "nist":[
                      "CM-7",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server OS type the following command:\n    sudo ls -l $CATALINA_HOME/webapps/docs.\n    If the docs folder exists or contains any content, this is a finding.",
                   "fix":"From the Tomcat server OS type the following command:\n    sudo rm -rf $CATALINA_HOME/webapps/docs"
                },
                "code":"control \"TCAT-AS-000580\" do\r\n    title \"Documentation must be removed.\"\r\n    desc  \"Tomcat provides documentation and other directories in the default \r\n    installation which do not serve a production use. These files must be deleted.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000141-AS-000095\"\r\n    tag \"gid\": \"TCAT-AS-000580\"\r\n    tag \"rid\": \"TCAT-AS-000580_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000580\"\r\n    tag \"cci\": \"CCI-000381\"\r\n    tag \"nist\": [\"CM-7\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server OS type the following command:\r\n    sudo ls -l $CATALINA_HOME/webapps/docs.\r\n    If the docs folder exists or contains any content, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server OS type the following command:\r\n    sudo rm -rf $CATALINA_HOME/webapps/docs\"\r\n\r\n    describe command(\"ls -l $CATALINA_HOME/webapps/docs\") do\r\n        its('stdout.strip') { should eq '' }\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000580.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"passed",
                      "code_desc":"Command: `ls -l $CATALINA_HOME/webapps/docs` stdout.strip is expected to eq \"\"",
                      "run_time":0.256909957,
                      "start_time":"2020-06-17T00:47:11+00:00"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000590",
                "title":"Applications in privileged mode must be approved by the ISSO.",
                "desc":"The privileged attribute controls if a context (application) is allowed to use container provided \n    servlets like the Manager servlet. It is false by default and should only be changed for trusted web \n    applications. Set to true to allow the context (application) to use container servlets, like the manager \n    servlet. Use of the privileged attribute will change the context's parent class loader to be the Server class \n    loader rather than the Shared class loader. Note that in a default installation, the Common class loader is \n    used for both the Server and the Shared class loaders. Use of the privileged attribute will change the context's \n    parent class loader to be the Server class loader rather than the Shared class loader.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The privileged attribute controls if a context (application) is allowed to use container provided \n    servlets like the Manager servlet. It is false by default and should only be changed for trusted web \n    applications. Set to true to allow the context (application) to use container servlets, like the manager \n    servlet. Use of the privileged attribute will change the context's parent class loader to be the Server class \n    loader rather than the Shared class loader. Note that in a default installation, the Common class loader is \n    used for both the Server and the Shared class loaders. Use of the privileged attribute will change the context's \n    parent class loader to be the Server class loader rather than the Shared class loader."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000142-AS-000014",
                   "gid":"TCAT-AS-000590",
                   "rid":"TCAT-AS-000590_rule",
                   "stig_id":"TCAT-AS-000590",
                   "cci":"CCI-000382",
                   "nist":[
                      "CM-7",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Individual Context elements may be explicitly defined in an individual file located at /META-INF/context.xml \n    inside the application files or in the $CATALINA_HOME/conf/context.xml file. It is not recommended to store the context \n    element in the server.xml file as changes will require a server restart. The $CATALINA_HOME/conf/context element information \n    will be loaded by all web applications, the META-INF/context.xml will only be loaded by that specific application.\n    On the Tomcat server as a privileged user run the following commands:\n    grep -i privileged $CATALINA_HOME/conf/context.xml\n    Repeat the following command for each installed application:\n    grep -i privileged $CATALINA_HOME/webapps/<application name>META-INF/context.xml\n    If the privileged context attribute is set to true, confirm the application has been approved for privileged mode by the ISSO. \n    If the application is not approved to run in privileged mode, this is a finding.",
                   "fix":"On the Tomcat server as a privileged user, modify the relevant context.xml file and set the privileged \n    attribute to false (privileged=false). A restart should not be required if the context element is not maintained \n    in the server.xml file. If privileged mode is required for a particular application, verify trust of application and obtain \n    documented approval from the ISSO. Document the applications that are approved to run in privileged mode and retain approvals \n    in the system security plan (SSP) for CCRI reviews."
                },
                "code":"control \"TCAT-AS-000590\" do\r\n    title \"Applications in privileged mode must be approved by the ISSO.\"\r\n    desc  \"The privileged attribute controls if a context (application) is allowed to use container provided \r\n    servlets like the Manager servlet. It is false by default and should only be changed for trusted web \r\n    applications. Set to true to allow the context (application) to use container servlets, like the manager \r\n    servlet. Use of the privileged attribute will change the context's parent class loader to be the Server class \r\n    loader rather than the Shared class loader. Note that in a default installation, the Common class loader is \r\n    used for both the Server and the Shared class loaders. Use of the privileged attribute will change the context's \r\n    parent class loader to be the Server class loader rather than the Shared class loader.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000142-AS-000014\"\r\n    tag \"gid\": \"TCAT-AS-000590\"\r\n    tag \"rid\": \"TCAT-AS-000590_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000590\"\r\n    tag \"cci\": \"CCI-000382\"\r\n    tag \"nist\": [\"CM-7\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Individual Context elements may be explicitly defined in an individual file located at /META-INF/context.xml \r\n    inside the application files or in the $CATALINA_HOME/conf/context.xml file. It is not recommended to store the context \r\n    element in the server.xml file as changes will require a server restart. The $CATALINA_HOME/conf/context element information \r\n    will be loaded by all web applications, the META-INF/context.xml will only be loaded by that specific application.\r\n    On the Tomcat server as a privileged user run the following commands:\r\n    grep -i privileged $CATALINA_HOME/conf/context.xml\r\n    Repeat the following command for each installed application:\r\n    grep -i privileged $CATALINA_HOME/webapps/<application name>META-INF/context.xml\r\n    If the privileged context attribute is set to true, confirm the application has been approved for privileged mode by the ISSO. \r\n    If the application is not approved to run in privileged mode, this is a finding.\"\r\n    tag \"fix\": \"On the Tomcat server as a privileged user, modify the relevant context.xml file and set the privileged \r\n    attribute to false (privileged=false). A restart should not be required if the context element is not maintained \r\n    in the server.xml file. If privileged mode is required for a particular application, verify trust of application and obtain \r\n    documented approval from the ISSO. Document the applications that are approved to run in privileged mode and retain approvals \r\n    in the system security plan (SSP) for CCRI reviews.\"\r\n    \r\n\r\n    describe \"This is a manual check\" do \r\n      skip \"If there are any applications running in privilege mode ensure they are approved for privilege mode by the ISSO.\"\r\n    end\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000590.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":7.228e-06,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "resource":"",
                      "skip_message":"If there are any applications running in privilege mode ensure they are approved for privilege mode by the ISSO."
                   }
                ]
             },
             {
                "id":"TCAT-AS-000600",
                "title":"Tomcat management applications must use LDAP realm authentication.",
                "desc":"Using the local user store on a Tomcat installation does not meet a multitude of security control requirements \n    related to user account management. To address this risk, Tomcat must be configured to utilize an LDAP or Active Directory \n    installation that provides a centralized user account store that is configured to meet standard DoD user account management \n    requirements. JNDIRealm is an implementation of the Tomcat Realm interface that looks up users in an LDAP directory server \n    accessed by a JNDI provider (typically, the standard LDAP provider that is available with the JNDI API classes). \n    The realm supports a variety of approaches to using a directory for authentication.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Using the local user store on a Tomcat installation does not meet a multitude of security control requirements \n    related to user account management. To address this risk, Tomcat must be configured to utilize an LDAP or Active Directory \n    installation that provides a centralized user account store that is configured to meet standard DoD user account management \n    requirements. JNDIRealm is an implementation of the Tomcat Realm interface that looks up users in an LDAP directory server \n    accessed by a JNDI provider (typically, the standard LDAP provider that is available with the JNDI API classes). \n    The realm supports a variety of approaches to using a directory for authentication."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000148-AS-000101",
                   "gid":"TCAT-AS-000600",
                   "rid":"TCAT-AS-000600_rule",
                   "stig_id":"TCAT-AS-000600",
                   "cci":"CCI-000764",
                   "nist":[
                      "IA-2",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"If manager and host-manager applications have been deleted from the system, this is not a finding. \n    From the Tomcat server as a privileged user, run the following commands:\n    sudo grep -i -A8 JNDIRealm $CATALINA_HOME/conf/server.xml\n    If the JNDIRealm does not exist or if the JNDIRealm configuration is commented out, this is finding.",
                   "fix":"Identify the server IP that is providing LDAP services and configure the Tomcat user roles schema within LDAP. \n    Refer to the manager and host-manager web.xml files for application specific role information that can be used for setting up \n    the roles for those applications. The default location for these files is: \n    $CATALINA_HOME/webapps/<AppName>/WEB-INF/web.xml\n    From the Tomcat server console as a privileged user, edit the $CATALINA_HOME/conf/server.xml file.\n    Locate the <Realm> element in the server.xml file, add a nested <Realm> element using the JNDIRealm className and configure \n    the associated LDAP settings as per the LDAP server connection requirements.\n    EXAMPLE:\n    This is for illustration purposes only. Modify the LDAP settings on a case-by-case basis as per the individual LDAP server and schema.\n    <Realm   className=\"org.apache.catalina.realm.JNDIRealm\"\n        connectionURL=\"ldaps://localhost:686\"\n          userPattern=\"uid={0},ou=people,dc=myunit,dc=mil\"\n              roleBase=\"ou=groups,dc=myunit,dc=mil\"\n              roleName=\"cn\"\n            roleSearch=\"(uniqueMember={0})\"\n    />"
                },
                "code":"control \"TCAT-AS-000600\" do\r\n    title \"Tomcat management applications must use LDAP realm authentication.\"\r\n    desc  \"Using the local user store on a Tomcat installation does not meet a multitude of security control requirements \r\n    related to user account management. To address this risk, Tomcat must be configured to utilize an LDAP or Active Directory \r\n    installation that provides a centralized user account store that is configured to meet standard DoD user account management \r\n    requirements. JNDIRealm is an implementation of the Tomcat Realm interface that looks up users in an LDAP directory server \r\n    accessed by a JNDI provider (typically, the standard LDAP provider that is available with the JNDI API classes). \r\n    The realm supports a variety of approaches to using a directory for authentication.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000148-AS-000101\"\r\n    tag \"gid\": \"TCAT-AS-000600\"\r\n    tag \"rid\": \"TCAT-AS-000600_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000600\"\r\n    tag \"cci\": \"CCI-000764\"\r\n    tag \"nist\": [\"IA-2\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"If manager and host-manager applications have been deleted from the system, this is not a finding. \r\n    From the Tomcat server as a privileged user, run the following commands:\r\n    sudo grep -i -A8 JNDIRealm $CATALINA_HOME/conf/server.xml\r\n    If the JNDIRealm does not exist or if the JNDIRealm configuration is commented out, this is finding.\"\r\n    tag \"fix\": \"Identify the server IP that is providing LDAP services and configure the Tomcat user roles schema within LDAP. \r\n    Refer to the manager and host-manager web.xml files for application specific role information that can be used for setting up \r\n    the roles for those applications. The default location for these files is: \r\n    $CATALINA_HOME/webapps/<AppName>/WEB-INF/web.xml\r\n    From the Tomcat server console as a privileged user, edit the $CATALINA_HOME/conf/server.xml file.\r\n    Locate the <Realm> element in the server.xml file, add a nested <Realm> element using the JNDIRealm className and configure \r\n    the associated LDAP settings as per the LDAP server connection requirements.\r\n    EXAMPLE:\r\n    This is for illustration purposes only. Modify the LDAP settings on a case-by-case basis as per the individual LDAP server and schema.\r\n    <Realm   className=\\\"org.apache.catalina.realm.JNDIRealm\\\"\r\n        connectionURL=\\\"ldaps://localhost:686\\\"\r\n          userPattern=\\\"uid={0},ou=people,dc=myunit,dc=mil\\\"\r\n              roleBase=\\\"ou=groups,dc=myunit,dc=mil\\\"\r\n              roleName=\\\"cn\\\"\r\n            roleSearch=\\\"(uniqueMember={0})\\\"\r\n    />\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    realms = tomcat_server_file[\"//Realm/@className\"]\r\n\r\n    describe realms do \r\n      it {should include \"org.apache.catalina.realm.JNDIRealm\" }\r\n    end\r\n\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000600.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000600.rb:1 ",
                      "run_time":0.001633683,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000610",
                "title":"JMX authentication must be secured.",
                "desc":"Java Management Extensions (JMX) provides the means to remotely manage the Java VM. When enabling \n    the JMX agent for remote monitoring, the user must enable authentication.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Java Management Extensions (JMX) provides the means to remotely manage the Java VM. When enabling \n    the JMX agent for remote monitoring, the user must enable authentication."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000149-AS-000102",
                   "gid":"TCAT-AS-000610",
                   "rid":"TCAT-AS-000610_rule",
                   "stig_id":"TCAT-AS-000610",
                   "cci":"CCI-000765",
                   "nist":[
                      "IA-2",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server run the following command:\n    sudo grep -I jmxremote.authenticate /etc/systemd/system/tomcat.service\n    If the results are blank, this is not a finding.\n    If the results include:\n    -Dcom.sun.management.jmxremote\n    -Dcom.sun.management.jmxremote.authenticate=false, this is a finding.",
                   "fix":"If using JMX for management of the Tomcat server, start the Tomcat server by adding the following command line \n    flags to the systemd startup scripts in /etc/systemd/system/tomcat.service.\n    Environment='CATALINA_OPTS -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=true -Dcom.sun.management.jmxremote.ssl=true'\n    sudo systemctl start tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000610\" do\r\n    title \"JMX authentication must be secured.\"\r\n    desc  \"Java Management Extensions (JMX) provides the means to remotely manage the Java VM. When enabling \r\n    the JMX agent for remote monitoring, the user must enable authentication.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000149-AS-000102\"\r\n    tag \"gid\": \"TCAT-AS-000610\"\r\n    tag \"rid\": \"TCAT-AS-000610_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000610\"\r\n    tag \"cci\": \"CCI-000765\"\r\n    tag \"nist\": [\"IA-2\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server run the following command:\r\n    sudo grep -I jmxremote.authenticate /etc/systemd/system/tomcat.service\r\n    If the results are blank, this is not a finding.\r\n    If the results include:\r\n    -Dcom.sun.management.jmxremote\r\n    -Dcom.sun.management.jmxremote.authenticate=false, this is a finding.\"\r\n    tag \"fix\": \"If using JMX for management of the Tomcat server, start the Tomcat server by adding the following command line \r\n    flags to the systemd startup scripts in /etc/systemd/system/tomcat.service.\r\n    Environment='CATALINA_OPTS -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=true -Dcom.sun.management.jmxremote.ssl=true'\r\n    sudo systemctl start tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_service_file = \"/etc/systemd/system/tomcat.service\"\r\n    environment = command(\"grep -I jmxremote.authenticate #{tomcat_service_file}\").stdout.split(\" \")\r\n\r\n    if !environment.empty?\r\n        environment.each do |param| \r\n            if param.includes? \"jmxremote.authenticate\"\r\n                describe param.split(\"=\")[1] do \r\n                    it { should include \"true\" }\r\n                end\r\n            end \r\n        end\r\n    else \r\n        describe environment do \r\n            skip \"JMX authentication params not found. Skipping this check\"\r\n        end\r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000610.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"[]",
                      "run_time":4.756e-06,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "resource":"[]",
                      "skip_message":"JMX authentication params not found. Skipping this check"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000630",
                "title":"SSL must be enabled on JMX.",
                "desc":"Java Management Extensions (JMX) provides the means for enterprises to remotely manage the Java \n    VM and can be used in place of the local manager application that comes with Tomcat. JMX management is \n    configured via the Tomcat CATALINA_OPTS setting maintained in the /etc/systemd/system/tomcat.service file \n    for Ubuntu systemd UNIX. For Linux OS flavors other than Ubuntu, use the relevant OS commands. Management \n    tasks such as monitoring and control of applications is accomplished via the jmxremote servlet. If \n    authentication is disabled, an attacker only needs to know the port number in order to manage and \n    control hosted Java applications.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Java Management Extensions (JMX) provides the means for enterprises to remotely manage the Java \n    VM and can be used in place of the local manager application that comes with Tomcat. JMX management is \n    configured via the Tomcat CATALINA_OPTS setting maintained in the /etc/systemd/system/tomcat.service file \n    for Ubuntu systemd UNIX. For Linux OS flavors other than Ubuntu, use the relevant OS commands. Management \n    tasks such as monitoring and control of applications is accomplished via the jmxremote servlet. If \n    authentication is disabled, an attacker only needs to know the port number in order to manage and \n    control hosted Java applications."
                   }
                ],
                "impact":0.7,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000153-AS-000104",
                   "gid":"TCAT-AS-000630",
                   "rid":"TCAT-AS-000630_rule",
                   "stig_id":"TCAT-AS-000630",
                   "cci":"CCI-000770",
                   "nist":[
                      "IA-2",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"JMX management is configured via the Tomcat CATALINA_OPTS environment variable setting maintained \n    in the /etc/systemd/system/tomcat.service file for Ubuntu systemd UNIX. For other flavors of Linux, this location may vary.\n    As a privileged user from the Tomcat server run the following command:\n    grep -i jmxremote /etc/systemd/system/tomcat.service \n    Review output, if there are no results displayed, jmxremote management extensions are not used, and this requirement is NA.\n    If the JMXremote setting is configured and jmxremote.ssl=\"false, this is a finding.\n    EXAMPLE: \n    -Dcom.sun.management.jmxremote\n    -Dcom.sun.management.jmxremote.authenticate=false\n    -Dcom.sun.management.jmxremote.ssl=false",
                   "fix":"If using JMX for management of the Tomcat server, start the Tomcat server by adding the following command line \n    flags to the systemd startup scripts in /etc/systemd/system/tomcat.service.\n    Environment='CATALINA_OPTS -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=true -Dcom.sun.management.jmxremote.ssl=true'\n    sudo systemctl start tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000630\" do\r\n    title \"SSL must be enabled on JMX.\"\r\n    desc  \"Java Management Extensions (JMX) provides the means for enterprises to remotely manage the Java \r\n    VM and can be used in place of the local manager application that comes with Tomcat. JMX management is \r\n    configured via the Tomcat CATALINA_OPTS setting maintained in the /etc/systemd/system/tomcat.service file \r\n    for Ubuntu systemd UNIX. For Linux OS flavors other than Ubuntu, use the relevant OS commands. Management \r\n    tasks such as monitoring and control of applications is accomplished via the jmxremote servlet. If \r\n    authentication is disabled, an attacker only needs to know the port number in order to manage and \r\n    control hosted Java applications.\"\r\n    impact 0.7\r\n    tag \"gtitle\": \"SRG-APP-000153-AS-000104\"\r\n    tag \"gid\": \"TCAT-AS-000630\"\r\n    tag \"rid\": \"TCAT-AS-000630_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000630\"\r\n    tag \"cci\": \"CCI-000770\"\r\n    tag \"nist\": [\"IA-2\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"JMX management is configured via the Tomcat CATALINA_OPTS environment variable setting maintained \r\n    in the /etc/systemd/system/tomcat.service file for Ubuntu systemd UNIX. For other flavors of Linux, this location may vary.\r\n    As a privileged user from the Tomcat server run the following command:\r\n    grep -i jmxremote /etc/systemd/system/tomcat.service \r\n    Review output, if there are no results displayed, jmxremote management extensions are not used, and this requirement is NA.\r\n    If the JMXremote setting is configured and jmxremote.ssl=\\\"false, this is a finding.\r\n    EXAMPLE: \r\n    -Dcom.sun.management.jmxremote\r\n    -Dcom.sun.management.jmxremote.authenticate=false\r\n    -Dcom.sun.management.jmxremote.ssl=false\"\r\n    tag \"fix\": \"If using JMX for management of the Tomcat server, start the Tomcat server by adding the following command line \r\n    flags to the systemd startup scripts in /etc/systemd/system/tomcat.service.\r\n    Environment='CATALINA_OPTS -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.authenticate=true -Dcom.sun.management.jmxremote.ssl=true'\r\n    sudo systemctl start tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_service_file = \"/etc/systemd/system/tomcat.service\"\r\n    environment = command(\"grep -i jmxremote #{tomcat_service_file}\").stdout.split(\" \")\r\n\r\n    if !environment.empty?\r\n        environment.each do |param| \r\n            if param.includes? \"jmxremote.ssl\"\r\n                describe param.split(\"=\")[1] do \r\n                    it { should include \"true\" }\r\n                end\r\n            end \r\n        end\r\n    else \r\n        describe environment do \r\n            skip \"JMX SSL param not found. Skipping this check\"\r\n        end\r\n    end \r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000630.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"[]",
                      "run_time":4.084e-06,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "resource":"[]",
                      "skip_message":"JMX SSL param not found. Skipping this check"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000680",
                "title":"TLS 1.2 must be used on secured connectors.",
                "desc":"Encryption is the standard method for protecting data during transmission. If data is not encrypted \n    with a secure protocol such as TLS 1.2, the data can be plainly read (i.e., clear text) and easily compromised. \n    Versions of TLS <1.1 and SSL versions have known vulnerabilities and must not be used.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Encryption is the standard method for protecting data during transmission. If data is not encrypted \n    with a secure protocol such as TLS 1.2, the data can be plainly read (i.e., clear text) and easily compromised. \n    Versions of TLS <1.1 and SSL versions have known vulnerabilities and must not be used."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000172-AS-000120",
                   "gid":"TCAT-AS-000680",
                   "rid":"TCAT-AS-000680_rule",
                   "stig_id":"TCAT-AS-000680",
                   "cci":"CCI-000197",
                   "nist":[
                      "IA-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo cat $CATALINA_HOME/conf/server.xml.  \n    Examine each <Connector> </Connector> statement.  \n    For every HTTP protocol connector, verify the SSLEnabledProtocols=\"TLSv1.2\" flag is set on each connector.\n    If the SSLEnabledProtocols setting is not set to TLSv1.2 or greater, this is a finding.",
                   "fix":"As a privileged user on the Tomcat server, edit the $CATALINA_HOME/conf/server.xml and modify the <Connector> ...</Connector> element.\n    Add the \"SSLEnabledProtocols=\" flag to the connector or modify the existing flag.  \n    Set SSLEnabledProtocols=\"TLS1.2\".  Save the server.xml file and restart Tomcat:\n    sudo systemctl restart tomcat\n    sudo systemctl reload-daemon"
                },
                "code":"control \"TCAT-AS-000680\" do\r\n    title \"TLS 1.2 must be used on secured connectors.\"\r\n    desc  \"Encryption is the standard method for protecting data during transmission. If data is not encrypted \r\n    with a secure protocol such as TLS 1.2, the data can be plainly read (i.e., clear text) and easily compromised. \r\n    Versions of TLS <1.1 and SSL versions have known vulnerabilities and must not be used.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000172-AS-000120\"\r\n    tag \"gid\": \"TCAT-AS-000680\"\r\n    tag \"rid\": \"TCAT-AS-000680_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000680\"\r\n    tag \"cci\": \"CCI-000197\"\r\n    tag \"nist\": [\"IA-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo cat $CATALINA_HOME/conf/server.xml.  \r\n    Examine each <Connector> </Connector> statement.  \r\n    For every HTTP protocol connector, verify the SSLEnabledProtocols=\\\"TLSv1.2\\\" flag is set on each connector.\r\n    If the SSLEnabledProtocols setting is not set to TLSv1.2 or greater, this is a finding.\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server, edit the $CATALINA_HOME/conf/server.xml and modify the <Connector> ...</Connector> element.\r\n    Add the \\\"SSLEnabledProtocols=\\\" flag to the connector or modify the existing flag.  \r\n    Set SSLEnabledProtocols=\\\"TLS1.2\\\".  Save the server.xml file and restart Tomcat:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl reload-daemon\"\r\n    \r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    connectors_count = tomcat_server_file[\"//Connector\"].count \r\n    ssl_enabled_protocols = tomcat_server_file[\"//Connector/@SSLEnabledProtocols\"]\r\n\r\n    describe connectors_count do \r\n        puts \"Each connector should have SSLEnabledProtocols attribute\"\r\n        it { should eq ssl_enabled_protocols.count }\r\n    end\r\n\r\n    ssl_enabled_protocols.each do |item|\r\n        describe item do \r\n            it { should cmp \"TLSv1.2\" }\r\n        end\r\n    end \r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000680.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000680.rb:1 ",
                      "run_time":0.001512863,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000690",
                "title":"LDAP authentication must be secured.",
                "desc":"LDAP does not provide encryption by default. This can lead to authentication credentials being transmitted \n    across network connections in clear text. To address this risk, Tomcat must be configured to use secure LDAP (LDAPS).",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"LDAP does not provide encryption by default. This can lead to authentication credentials being transmitted \n    across network connections in clear text. To address this risk, Tomcat must be configured to use secure LDAP (LDAPS)."
                   }
                ],
                "impact":0.7,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000172-AS-000121",
                   "gid":"TCAT-AS-000690",
                   "rid":"TCAT-AS-000690_rule",
                   "stig_id":"TCAT-AS-000690",
                   "cci":"CCI-000197",
                   "nist":[
                      "IA-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server as a privileged user, run the following commands:\n    sudo grep -i -A8 JNDIRealm $CATALINA_HOME/conf/server.xml\n    If the JNDIRealm connectionURL setting is not configured to use LDAPS, if it does not exist, or is commented out, this is a finding.\n    EXAMPLE:\n    This is an example. Substitute localhost for the LDAP server IP and configure other LDAP-related settings as well.\n    <Realm   className=\"org.apache.catalina.realm.JNDIRealm\"\n    connectionURL=\"ldaps://localhost:686\"\n    ...\n    />",
                   "fix":"Identify the server IP that is providing LDAP services and configure the Tomcat user roles schema within LDAP. Refer to the manager and host-manager web.xml files for application specific role information that can be used for setting up the roles for those applications. The default location for these files is: $CATALINA_HOME/webapps/<AppName>/WEB-INF/web.xml\n    From the Tomcat server console as a privileged user, edit the $CATALINA_HOME/conf/server.xml file.\n    Locate the <Realm> element in the server.xml file, add a nested <Realm> element using the JNDIRealm className and configure the associated LDAP settings as per the LDAP server connection requirements.\n    EXAMPLE:\n    This is for illustration purposes only. The user must modify the LDAP settings on a case by case basis as per the individual LDAP server and schema.\n    <Realm className=\"org.apache.catalina.realm.JNDIRealm\"\n        connectionURL=\"ldaps://localhost:686\"\n        userPattern=\"uid={0},ou=people,dc=myunit,dc=mil\"\n        roleBase=\"ou=groups,dc=myunit,dc=mil\"\n        roleName=\"cn\"\n        roleSearch=\"(uniqueMember={0})\"\n    />"
                },
                "code":"control \"TCAT-AS-000690\" do\r\n    title \"LDAP authentication must be secured.\"\r\n    desc  \"LDAP does not provide encryption by default. This can lead to authentication credentials being transmitted \r\n    across network connections in clear text. To address this risk, Tomcat must be configured to use secure LDAP (LDAPS).\"\r\n    impact 0.7\r\n    tag \"gtitle\": \"SRG-APP-000172-AS-000121\"\r\n    tag \"gid\": \"TCAT-AS-000690\"\r\n    tag \"rid\": \"TCAT-AS-000690_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000690\"\r\n    tag \"cci\": \"CCI-000197\"\r\n    tag \"nist\": [\"IA-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server as a privileged user, run the following commands:\r\n    sudo grep -i -A8 JNDIRealm $CATALINA_HOME/conf/server.xml\r\n    If the JNDIRealm connectionURL setting is not configured to use LDAPS, if it does not exist, or is commented out, this is a finding.\r\n    EXAMPLE:\r\n    This is an example. Substitute localhost for the LDAP server IP and configure other LDAP-related settings as well.\r\n    <Realm   className=\\\"org.apache.catalina.realm.JNDIRealm\\\"\r\n    connectionURL=\\\"ldaps://localhost:686\\\"\r\n    ...\r\n    />\"\r\n    tag \"fix\": \"Identify the server IP that is providing LDAP services and configure the Tomcat user roles schema within LDAP. Refer to the manager and host-manager web.xml files for application specific role information that can be used for setting up the roles for those applications. The default location for these files is: $CATALINA_HOME/webapps/<AppName>/WEB-INF/web.xml\r\n    From the Tomcat server console as a privileged user, edit the $CATALINA_HOME/conf/server.xml file.\r\n    Locate the <Realm> element in the server.xml file, add a nested <Realm> element using the JNDIRealm className and configure the associated LDAP settings as per the LDAP server connection requirements.\r\n    EXAMPLE:\r\n    This is for illustration purposes only. The user must modify the LDAP settings on a case by case basis as per the individual LDAP server and schema.\r\n    <Realm className=\\\"org.apache.catalina.realm.JNDIRealm\\\"\r\n        connectionURL=\\\"ldaps://localhost:686\\\"\r\n        userPattern=\\\"uid={0},ou=people,dc=myunit,dc=mil\\\"\r\n        roleBase=\\\"ou=groups,dc=myunit,dc=mil\\\"\r\n        roleName=\\\"cn\\\"\r\n        roleSearch=\\\"(uniqueMember={0})\\\"\r\n    />\"\r\n\r\n    \r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    realms = tomcat_server_file['//Realm/@className']\r\n    index = 0\r\n\r\n    if realms.include? \"org.apache.catalina.realm.JNDIRealm\"\r\n      for i in 0..realms.count\r\n        if realms[i] == \"org.apache.catalina.realm.JNDIRealm\"\r\n          break\r\n        else\r\n          index+=1\r\n        end\r\n      end\r\n    end\r\n\r\n    connection_url = tomcat_server_file[\"//Realm[#{index}]/@connectionURL\"]\r\n    if !connection_url.empty?\r\n      ldaps = connection_url[0].strip.split(\":\")[0]\r\n      describe ldaps do \r\n        it { should cmp \"ldaps\" }\r\n      end\r\n    else \r\n      describe connection_url.empty? do \r\n        puts \"the connectionURL attribute must be defined and must use LDAPS\"\r\n        it { should  cmp \"false\" }\r\n      end\r\n    end\r\nend\r\n",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000690.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000690.rb:1 ",
                      "run_time":0.003608901,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000700",
                "title":"DoD root CA certificates must be installed in Tomcat trust store.",
                "desc":"Tomcat truststores are used to validate client certificates. On the Ubuntu OS, by default Tomcat \n    uses the \"cacerts\" file as the CA trust store. The file is located in the /etc/ssl/certs/java/ folder\n    with a link to the file in $JAVA_HOME/lib/security/cacerts. However, this location can be modified by \n    setting the value of the javax.net.ssl.trustStore system property. Setting this property within an OS \n    environment variable will change the location to point to a different trust store. The Java OS environment \n    variables in the systemd Tomcat startup file must be checked in order to identify the location of the trust \n    store on the file system. (The STIG uses the name tomcat.service as a reference, but technically this file \n    can be called anything). If the property is not set, then the default location is used for the truststore.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat truststores are used to validate client certificates. On the Ubuntu OS, by default Tomcat \n    uses the \"cacerts\" file as the CA trust store. The file is located in the /etc/ssl/certs/java/ folder\n    with a link to the file in $JAVA_HOME/lib/security/cacerts. However, this location can be modified by \n    setting the value of the javax.net.ssl.trustStore system property. Setting this property within an OS \n    environment variable will change the location to point to a different trust store. The Java OS environment \n    variables in the systemd Tomcat startup file must be checked in order to identify the location of the trust \n    store on the file system. (The STIG uses the name tomcat.service as a reference, but technically this file \n    can be called anything). If the property is not set, then the default location is used for the truststore."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000175-AS-000124",
                   "gid":"TCAT-AS-000700",
                   "rid":"TCAT-AS-000700_rule",
                   "stig_id":"TCAT-AS-000700",
                   "cci":"CCI-000185",
                   "nist":[
                      "IA-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"For the systemd Ubuntu OS, check the tomcat.service file to read the content of the JAVA_OPTS environment variable setting.\n    sudo cat /etc/systemd/system/tomcat.service |grep -i truststore\n    EXAMPLE output:\n    set JAVA_OPTS=\"-Djavax.net.ssl.trustStore=/path/to/truststore\" \"-Djavax.net.ssl.trustStorePassword=************\"\n    If the variable is not set, use the default location command below. If the variable is set, use the alternate \n    location command below and include the path and truststore file. \n    -Default location:\n    keytool -list -cacerts -v | grep -i issuer\n    -Alternate location:\n    keytool -list -keystore <location of trust store file> -v |grep -i issuer\n    If there are no CA certificates issued by a Certificate Authority (CA) that is part of the DoD PKI/PKE, this is a finding.",
                   "fix":"Obtain and install the DoD PKI CA certificate bundles by accessing the DoD PKI office web site at cyber.mil/pki-pke.\n    Import the DoD CA certificates."
                },
                "code":"control \"TCAT-AS-000700\" do\r\n    title \"DoD root CA certificates must be installed in Tomcat trust store.\"\r\n    desc  \"Tomcat truststores are used to validate client certificates. On the Ubuntu OS, by default Tomcat \r\n    uses the \\\"cacerts\\\" file as the CA trust store. The file is located in the /etc/ssl/certs/java/ folder\r\n    with a link to the file in $JAVA_HOME/lib/security/cacerts. However, this location can be modified by \r\n    setting the value of the javax.net.ssl.trustStore system property. Setting this property within an OS \r\n    environment variable will change the location to point to a different trust store. The Java OS environment \r\n    variables in the systemd Tomcat startup file must be checked in order to identify the location of the trust \r\n    store on the file system. (The STIG uses the name tomcat.service as a reference, but technically this file \r\n    can be called anything). If the property is not set, then the default location is used for the truststore.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000175-AS-000124\"\r\n    tag \"gid\": \"TCAT-AS-000700\"\r\n    tag \"rid\": \"TCAT-AS-000700_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000700\"\r\n    tag \"cci\": \"CCI-000185\"\r\n    tag \"nist\": [\"IA-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"For the systemd Ubuntu OS, check the tomcat.service file to read the content of the JAVA_OPTS environment variable setting.\r\n    sudo cat /etc/systemd/system/tomcat.service |grep -i truststore\r\n    EXAMPLE output:\r\n    set JAVA_OPTS=\\\"-Djavax.net.ssl.trustStore=/path/to/truststore\\\" \\\"-Djavax.net.ssl.trustStorePassword=************\\\"\r\n    If the variable is not set, use the default location command below. If the variable is set, use the alternate \r\n    location command below and include the path and truststore file. \r\n    -Default location:\r\n    keytool -list -cacerts -v | grep -i issuer\r\n    -Alternate location:\r\n    keytool -list -keystore <location of trust store file> -v |grep -i issuer\r\n    If there are no CA certificates issued by a Certificate Authority (CA) that is part of the DoD PKI/PKE, this is a finding.\"\r\n    tag \"fix\": \"Obtain and install the DoD PKI CA certificate bundles by accessing the DoD PKI office web site at cyber.mil/pki-pke.\r\n    Import the DoD CA certificates.\"\r\n    \r\n    describe \"This is a manual check\" do \r\n        skip \"Check the truststore settings in the tomcat.service file. If the variable is not set then run the command: \r\n        'keytool -list -cacerts -v | grep -i issuer' if the variable is already set then add an alternate location with the\r\n        command: 'keytool -list -keystore <location of trust store file> -v |grep -i issuer'\"\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000700.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":5.463e-06,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "resource":"",
                      "skip_message":"Check the truststore settings in the tomcat.service file. If the variable is not set then run the command: \n        'keytool -list -cacerts -v | grep -i issuer' if the variable is already set then add an alternate location with the\n        command: 'keytool -list -keystore <location of trust store file> -v |grep -i issuer'"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000710",
                "title":"Keystore file must be protected.",
                "desc":"Keystore file contains authentication information used to access application data and data resources. \n    Access to the file must be protected. The default location is in the .keystore file stored in the home folder \n    of the user account used to run Tomcat although some administrators may choose to locate the file elsewhere. \n    The location will also be specified in the server.xml file.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Keystore file contains authentication information used to access application data and data resources. \n    Access to the file must be protected. The default location is in the .keystore file stored in the home folder \n    of the user account used to run Tomcat although some administrators may choose to locate the file elsewhere. \n    The location will also be specified in the server.xml file."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000176-AS-000125",
                   "gid":"TCAT-AS-000710",
                   "rid":"TCAT-AS-000710_rule",
                   "stig_id":"TCAT-AS-000710",
                   "cci":"CCI-000186",
                   "nist":[
                      "IA-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Identify the location of the .keystore file. Refer to system documentation or \n    review the server.xml file for a specified .keystore file location.\n    From the Tomcat server console run the following command to check the server.xml file:\n    sudo grep -i keystorefile $CATALINA_HOME/conf/server.xml\n    Extract the location of the file from the output. \n    Example:\n    [keystorefile=/opt/tomcat/conf/<filename.jks>]\n    sudo ls -la [keystorefile location]\n    If the file permissions are not set to 640 USER:root GROUP:tomcat, this is a finding.\n    If the keystore file is not stored within the tomcat folder path, i.e. [/opt/tomcat/], this is a finding.",
                   "fix":"Run the following commands on the Tomcat server:\n    sudo chmod 640 [keystorefile]\n    sudo chown root [keystorefile]\n    sudo chgrp tomcat [keystorefile]\n    Store the keystore file in a secured folder, preferably within the Tomcat folder path."
                },
                "code":"control \"TCAT-AS-000710\" do\r\n    title \"Keystore file must be protected.\"\r\n    desc  \"Keystore file contains authentication information used to access application data and data resources. \r\n    Access to the file must be protected. The default location is in the .keystore file stored in the home folder \r\n    of the user account used to run Tomcat although some administrators may choose to locate the file elsewhere. \r\n    The location will also be specified in the server.xml file.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000176-AS-000125\"\r\n    tag \"gid\": \"TCAT-AS-000710\"\r\n    tag \"rid\": \"TCAT-AS-000710_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000710\"\r\n    tag \"cci\": \"CCI-000186\"\r\n    tag \"nist\": [\"IA-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Identify the location of the .keystore file. Refer to system documentation or \r\n    review the server.xml file for a specified .keystore file location.\r\n    From the Tomcat server console run the following command to check the server.xml file:\r\n    sudo grep -i keystorefile $CATALINA_HOME/conf/server.xml\r\n    Extract the location of the file from the output. \r\n    Example:\r\n    [keystorefile=/opt/tomcat/conf/<filename.jks>]\r\n    sudo ls -la [keystorefile location]\r\n    If the file permissions are not set to 640 USER:root GROUP:tomcat, this is a finding.\r\n    If the keystore file is not stored within the tomcat folder path, i.e. [/opt/tomcat/], this is a finding.\"\r\n    tag \"fix\": \"Run the following commands on the Tomcat server:\r\n    sudo chmod 640 [keystorefile]\r\n    sudo chown root [keystorefile]\r\n    sudo chgrp tomcat [keystorefile]\r\n    Store the keystore file in a secured folder, preferably within the Tomcat folder path.\"\r\n    \r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    keystore_file=tomcat_server_file[\"//Connector/@keystoreFile\"][0]\r\n    keystore_dir=keystore_file.split('/').slice(0,3).join('/')\r\n    \r\n    describe keystore_dir do \r\n        it { should cmp \"/opt/tomcat\" }\r\n    end\r\n\r\n    if file(keystore_file).exist?\r\n        desribe file(keystore_file) do \r\n            its('mode') { should cmp '640' }\r\n            its('owner') { should cmp 'root' }\r\n            its('group') { should cmp 'tomcat' }\r\n        end\r\n    else\r\n        describe file(keystore_file).exist? do \r\n            it { should cmp \"true\" }\r\n        end\r\n    end\r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000710.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000710.rb:1 ",
                      "run_time":0.003152105,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000720",
                "title":"Default password for keystore must be changed.",
                "desc":"Tomcat currently operates only on JKS, PKCS11 or PKCS12 format keystores. The JKS format is \n    Java's standard \"Java KeyStore\" format, and is the format created by the keytool command-line utility \n    which is included in the JDK. The PKCS12 format is an internet standard, and is managed using OpenSSL \n    or Microsoft's Key-Manager. When a new JKS keystore is created, if a password is not specified during \n    creation, the default password used by Tomcat is \"changeit\" (all lowercase). If the default password \n    is not changed, the keystore is at risk of compromise.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat currently operates only on JKS, PKCS11 or PKCS12 format keystores. The JKS format is \n    Java's standard \"Java KeyStore\" format, and is the format created by the keytool command-line utility \n    which is included in the JDK. The PKCS12 format is an internet standard, and is managed using OpenSSL \n    or Microsoft's Key-Manager. When a new JKS keystore is created, if a password is not specified during \n    creation, the default password used by Tomcat is \"changeit\" (all lowercase). If the default password \n    is not changed, the keystore is at risk of compromise."
                   }
                ],
                "impact":0.7,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000176-AS-000125",
                   "gid":"TCAT-AS-000720",
                   "rid":"TCAT-AS-000720_rule",
                   "stig_id":"TCAT-AS-000720",
                   "cci":"CCI-000186",
                   "nist":[
                      "IA-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console run the following command to check the keystore:\n    sudo keytool -list -v \n    When prompted for the keystore password, type \"changeit\".\n    If the contents of the keystore are displayed, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user:\n    sudo keytool -storepasswd \n    When prompted for the keystore password, select a strong password, minimum 10 characters, mixed case alpha-numeric.\n    Document the password and store in a secured location that is only accessible to authorized personnel."
                },
                "code":"control \"TCAT-AS-000720\" do\r\n    title \"Default password for keystore must be changed.\"\r\n    desc  \"Tomcat currently operates only on JKS, PKCS11 or PKCS12 format keystores. The JKS format is \r\n    Java's standard \\\"Java KeyStore\\\" format, and is the format created by the keytool command-line utility \r\n    which is included in the JDK. The PKCS12 format is an internet standard, and is managed using OpenSSL \r\n    or Microsoft's Key-Manager. When a new JKS keystore is created, if a password is not specified during \r\n    creation, the default password used by Tomcat is \\\"changeit\\\" (all lowercase). If the default password \r\n    is not changed, the keystore is at risk of compromise.\"\r\n    impact 0.7\r\n    tag \"gtitle\": \"SRG-APP-000176-AS-000125\"\r\n    tag \"gid\": \"TCAT-AS-000720\"\r\n    tag \"rid\": \"TCAT-AS-000720_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000720\"\r\n    tag \"cci\": \"CCI-000186\"\r\n    tag \"nist\": [\"IA-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console run the following command to check the keystore:\r\n    sudo keytool -list -v \r\n    When prompted for the keystore password, type \\\"changeit\\\".\r\n    If the contents of the keystore are displayed, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user:\r\n    sudo keytool -storepasswd \r\n    When prompted for the keystore password, select a strong password, minimum 10 characters, mixed case alpha-numeric.\r\n    Document the password and store in a secured location that is only accessible to authorized personnel.\"\r\n    \r\n    keytool = command(\"keytool -list -v\")\r\n    \r\n    describe keytool do\r\n        its('exit_status') { should eq 0 }\r\n    end\r\n\r\n    if keytool.exist?\r\n        describe command(\"keytool -list -v -storepass changeit\") do\r\n            its('exist_status') { should eq 0 }\r\n        end\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000720.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Command: `keytool -list -v` exit_status is expected to eq 0",
                      "run_time":0.00022653,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"\nexpected: 0\n     got: 1\n\n(compared using ==)\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000750",
                "title":"Tomcat must use FIPS-validated ciphers on secured connectors.",
                "desc":"Connectors are how Tomcat receives requests over a network port, passes them to hosted web applications \n    via HTTP or AJP, and then sends back the results to the requestor. Cryptographic ciphers are associated with \n    the connector to create a secured connector. To ensure encryption strength is adequately maintained, \n    the ciphers used must be FIPS 140-2-validated. Crypto libraries are provided by either the Java instance that \n    Tomcat uses or by the OpenSSL implementation.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Connectors are how Tomcat receives requests over a network port, passes them to hosted web applications \n    via HTTP or AJP, and then sends back the results to the requestor. Cryptographic ciphers are associated with \n    the connector to create a secured connector. To ensure encryption strength is adequately maintained, \n    the ciphers used must be FIPS 140-2-validated. Crypto libraries are provided by either the Java instance that \n    Tomcat uses or by the OpenSSL implementation."
                   }
                ],
                "impact":0.7,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000179-AS-000129",
                   "gid":"TCAT-AS-000750",
                   "rid":"TCAT-AS-000750_rule",
                   "stig_id":"TCAT-AS-000750",
                   "cci":"CCI-000803",
                   "nist":[
                      "IA-7",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo grep -i fipsmode $CATALINA_HOME/conf/server.xml. \n    If there are no results displayed or if FIPSMode is not set to FIPSMode=\"on\", this is a finding.",
                   "fix":"From the Tomcat server as a privileged user:\n    sudo nano $CATALINA_HOME/conf/server.xml.  \n    In the <Listener/> element, locate the AprLifecycleListener, either add or modify the FIPSMode setting and set it to FIPSMode=\"on\"\n    EXAMPLE: \n    <Listener\n        className=\"org.apache.catalina.core.AprLifecycleListener\"\n        SSLEngine=\"on\"\n        FIPSMode=\"on\"\n    />\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000750\" do\r\n    title \"Tomcat must use FIPS-validated ciphers on secured connectors.\"\r\n    desc  \"Connectors are how Tomcat receives requests over a network port, passes them to hosted web applications \r\n    via HTTP or AJP, and then sends back the results to the requestor. Cryptographic ciphers are associated with \r\n    the connector to create a secured connector. To ensure encryption strength is adequately maintained, \r\n    the ciphers used must be FIPS 140-2-validated. Crypto libraries are provided by either the Java instance that \r\n    Tomcat uses or by the OpenSSL implementation.\"\r\n    impact 0.7\r\n    tag \"gtitle\": \"SRG-APP-000179-AS-000129\"\r\n    tag \"gid\": \"TCAT-AS-000750\"\r\n    tag \"rid\": \"TCAT-AS-000750_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000750\"\r\n    tag \"cci\": \"CCI-000803\"\r\n    tag \"nist\": [\"IA-7\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo grep -i fipsmode $CATALINA_HOME/conf/server.xml. \r\n    If there are no results displayed or if FIPSMode is not set to FIPSMode=\\\"on\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user:\r\n    sudo nano $CATALINA_HOME/conf/server.xml.  \r\n    In the <Listener/> element, locate the AprLifecycleListener, either add or modify the FIPSMode setting and set it to FIPSMode=\\\"on\\\"\r\n    EXAMPLE: \r\n    <Listener\r\n        className=\\\"org.apache.catalina.core.AprLifecycleListener\\\"\r\n        SSLEngine=\\\"on\\\"\r\n        FIPSMode=\\\"on\\\"\r\n    />\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    listeners = tomcat_server_file[\"//Listener/@className\"]\r\n    index = 0\r\n\r\n    if listeners.include? \"org.apache.catalina.core.AprLifecycleListener\"\r\n        for i in 0..listeners.count\r\n            if listeners[i] == \"org.apache.catalina.core.AprLifecycleListener\"\r\n                break\r\n            else\r\n                index+=1\r\n            end\r\n        end\r\n    end\r\n    \r\n    fips_mode = tomcat_server_file[\"//Listener[#{index}]/@FIPSMode\"]\r\n    if !fips_mode.empty?\r\n        describe fips_mode do \r\n            it { should cmp \"on\" }\r\n        end\r\n    else \r\n        describe fips_mode.empty? do \r\n            puts \"FIPSMode attribute must be defined and must be set to 'on'. This check has failed.\"\r\n            it { should  cmp \"false\" }\r\n        end\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000750.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000750.rb:1 ",
                      "run_time":0.003983787,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000780",
                "title":"Access to JMX management interface must be restricted.",
                "desc":"Java Management Extensions (JMX) is used to provide programmatic access to Tomcat for management \n    purposes. This includes monitoring and control of java applications running on Tomcat. If network access \n    to the JMX port is not restricted, attackers can gain access to the application used to manage the system.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Java Management Extensions (JMX) is used to provide programmatic access to Tomcat for management \n    purposes. This includes monitoring and control of java applications running on Tomcat. If network access \n    to the JMX port is not restricted, attackers can gain access to the application used to manage the system."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000211-AS-000146",
                   "gid":"TCAT-AS-000780",
                   "rid":"TCAT-AS-000780_rule",
                   "stig_id":"TCAT-AS-000780",
                   "cci":"CCI-001082",
                   "nist":[
                      "SC-2",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Review the system security plan and network documentation. \n    Identify the management networks that are used for system management. \n    From the Tomcat server as a privileged user, run the following command:\n    sudo grep -i jmxremote /etc/systemd/system/tomcat.service\n    If there are no results, the JMX process is not being used, and this is not a finding.\n    If output includes jmxremote information, review the -Dcom.sun.management.jmxremote.host setting. \n    Compare the IP address associated with the JMX process with the network information in the SSP. \n    Ensure the IP address space is dedicated for system management purposes.\n    If the IP address that is associated with the JMX process is not dedicated to system management usage, this is a finding.\n    If jmxremote is in use but the host IP address is not specified, this is a finding.",
                   "fix":"Make an operational determination regarding the use of JMX. If JMX management is decided upon, \n    identify the management networks that are used for system management. Update the system \n    security plan and network documentation with the information. \n    Edit the /etc/systemd/system/tomcat.service file.\n    Add or modify the existing CATALINA_OPTS  -Dcom.sun.management.jmxremote.host setting. \n    Set the host parameter to an IP address that is only available on a management network.\n    EXAMPLE:\n    CATALINA_OPTS='-Dcom.sun.management.jmxremote.host=192.168.0.150'\n    Restart Tomcat:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload\n    Verify jmxmanagement access is restricted to the management network IP address range."
                },
                "code":"control \"TCAT-AS-000780\" do\r\n    title \"Access to JMX management interface must be restricted.\"\r\n    desc  \"Java Management Extensions (JMX) is used to provide programmatic access to Tomcat for management \r\n    purposes. This includes monitoring and control of java applications running on Tomcat. If network access \r\n    to the JMX port is not restricted, attackers can gain access to the application used to manage the system.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000211-AS-000146\"\r\n    tag \"gid\": \"TCAT-AS-000780\"\r\n    tag \"rid\": \"TCAT-AS-000780_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000780\"\r\n    tag \"cci\": \"CCI-001082\"\r\n    tag \"nist\": [\"SC-2\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Review the system security plan and network documentation. \r\n    Identify the management networks that are used for system management. \r\n    From the Tomcat server as a privileged user, run the following command:\r\n    sudo grep -i jmxremote /etc/systemd/system/tomcat.service\r\n    If there are no results, the JMX process is not being used, and this is not a finding.\r\n    If output includes jmxremote information, review the -Dcom.sun.management.jmxremote.host setting. \r\n    Compare the IP address associated with the JMX process with the network information in the SSP. \r\n    Ensure the IP address space is dedicated for system management purposes.\r\n    If the IP address that is associated with the JMX process is not dedicated to system management usage, this is a finding.\r\n    If jmxremote is in use but the host IP address is not specified, this is a finding.\"\r\n    tag \"fix\": \"Make an operational determination regarding the use of JMX. If JMX management is decided upon, \r\n    identify the management networks that are used for system management. Update the system \r\n    security plan and network documentation with the information. \r\n    Edit the /etc/systemd/system/tomcat.service file.\r\n    Add or modify the existing CATALINA_OPTS  -Dcom.sun.management.jmxremote.host setting. \r\n    Set the host parameter to an IP address that is only available on a management network.\r\n    EXAMPLE:\r\n    CATALINA_OPTS='-Dcom.sun.management.jmxremote.host=192.168.0.150'\r\n    Restart Tomcat:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\r\n    Verify jmxmanagement access is restricted to the management network IP address range.\"\r\n    \r\n    describe \"This is a manual check\" do\r\n        skip \"Review the System Security Plan. Compare the IP address associated with the JMX process with the network information in the SSP. \r\n        Ensure the IP address space is dedicated for system management purposes. If the IP address that is associated with the JMX process \r\n        is not dedicated to system management usage, this is a finding.\"\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000780.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":5.885e-06,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "resource":"",
                      "skip_message":"Review the System Security Plan. Compare the IP address associated with the JMX process with the network information in the SSP. \n        Ensure the IP address space is dedicated for system management purposes. If the IP address that is associated with the JMX process \n        is not dedicated to system management usage, this is a finding."
                   }
                ]
             },
             {
                "id":"TCAT-AS-000790",
                "title":"Access to Tomcat manager application must be restricted.",
                "desc":"The Tomcat manager application is used to manage the Tomcat server and the applications that run on Tomcat. \n    By default, the manager application is only accessible via the localhost. Exposing the management application to \n    any network interface that is available to non-administrative personnel leaves the Tomcat server vulnerable to \n    attempts to access the management application. To mitigate this risk, the management application should only be \n    run on the localhost or on network interfaces tied to a dedicated management network. \n    This setting is managed in the $CATALINA_HOME/conf/server.xml file.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The Tomcat manager application is used to manage the Tomcat server and the applications that run on Tomcat. \n    By default, the manager application is only accessible via the localhost. Exposing the management application to \n    any network interface that is available to non-administrative personnel leaves the Tomcat server vulnerable to \n    attempts to access the management application. To mitigate this risk, the management application should only be \n    run on the localhost or on network interfaces tied to a dedicated management network. \n    This setting is managed in the $CATALINA_HOME/conf/server.xml file."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000211-AS-000146",
                   "gid":"TCAT-AS-000790",
                   "rid":"TCAT-AS-000790_rule",
                   "stig_id":"TCAT-AS-000790",
                   "cci":"CCI-001082",
                   "nist":[
                      "SC-2",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Review system documentation (SSP) and identify the documented management networks as well as the documented \n    client networks. If the manager application has been deleted from the system, this is not a finding. \n    Run the following command as a privileged user:\n    sudo grep -i -A1 \"RemoteAddrValve\\|RemoteCIDRValve\" $CATALINA_HOME/webapps/manager/META-INF/context.xml \n    If there are no results, then no address valves exist and this is a finding.\n    If the Remote Address Valve settings are commented out or not configured to restrict access to localhost or the management network, this is a finding.\n    EXAMPLES:\n    - RemoteAddrValve Localhost only IPV4 and IPV6 example\n    <Valve className=\"org.apache.catalina.valves.RemoteAddrValve\"\n    allow=\"127\\.\\d+\\.\\d+\\.\\d+|::1|0:0:0:0:0:0:0:1\"/>\n    -Localhost and Management network CIDR block IPV4 and IPV6 example\n    <Valve className=\"org.apache.catalina.valves.RemoteCIDRValve\"\n    allow=\"127.0.0.1, ::1\",192.168.1.0/24/>",
                   "fix":"Update system documentation (SSP) and identify the documented management networks as well as the documented client networks.\n    As a privileged user, edit the $CATALINA_HOME/webapps/manager/META-INF/context.xml file.\n    Configure the RemoteAddrValve or RemoteCIDRValve to restrict access to the management application. \n    This can be a restriction to the localhost or to specific management networks or hosts on the management network. \n    Choice of address or CIDR block usage is based on operational requirements.\n    Order is allow from, deny from. See Tomcat Valve component documentation at the Tomcat web site for specific details and additional configuration options.\n    Test the access restrictions once configured to assure compliance.\n    EXAMPLES:\n    - RemoteAddrValve Localhost only IPV4 and IPV6\n    <Valve className=\"org.apache.catalina.valves.RemoteAddrValve\"\n    allow=\"127\\.\\d+\\.\\d+\\.\\d+|::1|0:0:0:0:0:0:0:1\"/>\n    -Localhost and Management network CIDR block IPV4 and IPV6\n    <Valve className=\"org.apache.catalina.valves.RemoteCIDRValve\"\n    allow=\"127.0.0.1, ::1\",192.168.1.0/24/>"
                },
                "code":"control \"TCAT-AS-000790\" do\r\n    title \"Access to Tomcat manager application must be restricted.\"\r\n    desc  \"The Tomcat manager application is used to manage the Tomcat server and the applications that run on Tomcat. \r\n    By default, the manager application is only accessible via the localhost. Exposing the management application to \r\n    any network interface that is available to non-administrative personnel leaves the Tomcat server vulnerable to \r\n    attempts to access the management application. To mitigate this risk, the management application should only be \r\n    run on the localhost or on network interfaces tied to a dedicated management network. \r\n    This setting is managed in the $CATALINA_HOME/conf/server.xml file.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000211-AS-000146\"\r\n    tag \"gid\": \"TCAT-AS-000790\"\r\n    tag \"rid\": \"TCAT-AS-000790_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000790\"\r\n    tag \"cci\": \"CCI-001082\"\r\n    tag \"nist\": [\"SC-2\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Review system documentation (SSP) and identify the documented management networks as well as the documented \r\n    client networks. If the manager application has been deleted from the system, this is not a finding. \r\n    Run the following command as a privileged user:\r\n    sudo grep -i -A1 \\\"RemoteAddrValve\\\\|RemoteCIDRValve\\\" $CATALINA_HOME/webapps/manager/META-INF/context.xml \r\n    If there are no results, then no address valves exist and this is a finding.\r\n    If the Remote Address Valve settings are commented out or not configured to restrict access to localhost or the management network, this is a finding.\r\n    EXAMPLES:\r\n    - RemoteAddrValve Localhost only IPV4 and IPV6 example\r\n    <Valve className=\\\"org.apache.catalina.valves.RemoteAddrValve\\\"\r\n    allow=\\\"127\\\\.\\\\d+\\\\.\\\\d+\\\\.\\\\d+|::1|0:0:0:0:0:0:0:1\\\"/>\r\n    -Localhost and Management network CIDR block IPV4 and IPV6 example\r\n    <Valve className=\\\"org.apache.catalina.valves.RemoteCIDRValve\\\"\r\n    allow=\\\"127.0.0.1, ::1\\\",192.168.1.0/24/>\"\r\n    tag \"fix\": \"Update system documentation (SSP) and identify the documented management networks as well as the documented client networks.\r\n    As a privileged user, edit the $CATALINA_HOME/webapps/manager/META-INF/context.xml file.\r\n    Configure the RemoteAddrValve or RemoteCIDRValve to restrict access to the management application. \r\n    This can be a restriction to the localhost or to specific management networks or hosts on the management network. \r\n    Choice of address or CIDR block usage is based on operational requirements.\r\n    Order is allow from, deny from. See Tomcat Valve component documentation at the Tomcat web site for specific details and additional configuration options.\r\n    Test the access restrictions once configured to assure compliance.\r\n    EXAMPLES:\r\n    - RemoteAddrValve Localhost only IPV4 and IPV6\r\n    <Valve className=\\\"org.apache.catalina.valves.RemoteAddrValve\\\"\r\n    allow=\\\"127\\\\.\\\\d+\\\\.\\\\d+\\\\.\\\\d+|::1|0:0:0:0:0:0:0:1\\\"/>\r\n    -Localhost and Management network CIDR block IPV4 and IPV6\r\n    <Valve className=\\\"org.apache.catalina.valves.RemoteCIDRValve\\\"\r\n    allow=\\\"127.0.0.1, ::1\\\",192.168.1.0/24/>\"\r\n    \r\n    describe \"This is a manual check\" do\r\n        skip \"Review system documentation (SSP) for the dedicated management network and locate the settings \r\n        for the Remote Address Valve located at $CATALINA_HOME/webapps/manager/META-INF/context.xml. \r\n        If the management network is not restricted to localhost or the management network. This is finding.\"\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000790.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":4.303e-06,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "resource":"",
                      "skip_message":"Review system documentation (SSP) for the dedicated management network and locate the settings \n        for the Remote Address Valve located at $CATALINA_HOME/webapps/manager/META-INF/context.xml. \n        If the management network is not restricted to localhost or the management network. This is finding."
                   }
                ]
             },
             {
                "id":"TCAT-AS-000800",
                "title":"Tomcat servers must mutually authenticate proxy or load balancer connections.",
                "desc":"Tomcat servers are often placed behind a proxy when exposed to both trusted and untrusted networks. \n    This is done for security and performance reasons. Tomcat does provide an HTTP server that can be configured \n    to make hosted applications available to clients directly. However, this HTTP server has performance limitations \n    and is not intended to be used on an enterprise scale. Exposing this service to untrusted networks also violates \n    the layered security model and creates elevated risk of attack. To address these issues, a proxy or load balancer \n    can be placed in front of the Tomcat server. To ensure the proxied connection is not spoofed, SSL mutual \n    authentication must be employed between Tomcat and the proxy.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat servers are often placed behind a proxy when exposed to both trusted and untrusted networks. \n    This is done for security and performance reasons. Tomcat does provide an HTTP server that can be configured \n    to make hosted applications available to clients directly. However, this HTTP server has performance limitations \n    and is not intended to be used on an enterprise scale. Exposing this service to untrusted networks also violates \n    the layered security model and creates elevated risk of attack. To address these issues, a proxy or load balancer \n    can be placed in front of the Tomcat server. To ensure the proxied connection is not spoofed, SSL mutual \n    authentication must be employed between Tomcat and the proxy."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000219-AS-000147",
                   "gid":"TCAT-AS-000800",
                   "rid":"TCAT-AS-000800_rule",
                   "stig_id":"TCAT-AS-000800",
                   "cci":"CCI-001184",
                   "nist":[
                      "SC-23",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Review system security plan and/or system architecture documentation and interview the system admin. \n    Identify any proxy servers or load balancers that provide services for the Tomcat server. If there are no load balancers \n    or proxies in use, this is not a finding. If there is a documented risk acceptance for not mutually authenticating proxy \n    of load balancer connections due to operational issues, this is not a finding. Using the aforementioned documentation, \n    identify each Tomcat IP address that is served by a load balancer or proxy. From the Tomcat server as a privileged user, \n    review the $CATALINA_HOME/conf/server.xml file. Review each <Connector> element for the address setting and the clientAuth setting.\n    sudo grep -i -B1 -A5 connector $CATALINA_HOME/conf/server.xml\n    If a connector has a configured IP address that is proxied or load balanced and the clientAuth setting is not \"true\", this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/conf/server.xml file. \n    Modify each <Connector> element where the IP address is behind a proxy or load balancer.\n    Set clientAuth=\"true\" then identify the applications that are associated with the connector \n    and edit the associated web.xml files. Assure the <auth-method> is set to CLIENT-CERT."
                },
                "code":"control \"TCAT-AS-000800\" do\r\n    title \"Tomcat servers must mutually authenticate proxy or load balancer connections.\"\r\n    desc  \"Tomcat servers are often placed behind a proxy when exposed to both trusted and untrusted networks. \r\n    This is done for security and performance reasons. Tomcat does provide an HTTP server that can be configured \r\n    to make hosted applications available to clients directly. However, this HTTP server has performance limitations \r\n    and is not intended to be used on an enterprise scale. Exposing this service to untrusted networks also violates \r\n    the layered security model and creates elevated risk of attack. To address these issues, a proxy or load balancer \r\n    can be placed in front of the Tomcat server. To ensure the proxied connection is not spoofed, SSL mutual \r\n    authentication must be employed between Tomcat and the proxy.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000219-AS-000147\"\r\n    tag \"gid\": \"TCAT-AS-000800\"\r\n    tag \"rid\": \"TCAT-AS-000800_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000800\"\r\n    tag \"cci\": \"CCI-001184\"\r\n    tag \"nist\": [\"SC-23\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Review system security plan and/or system architecture documentation and interview the system admin. \r\n    Identify any proxy servers or load balancers that provide services for the Tomcat server. If there are no load balancers \r\n    or proxies in use, this is not a finding. If there is a documented risk acceptance for not mutually authenticating proxy \r\n    of load balancer connections due to operational issues, this is not a finding. Using the aforementioned documentation, \r\n    identify each Tomcat IP address that is served by a load balancer or proxy. From the Tomcat server as a privileged user, \r\n    review the $CATALINA_HOME/conf/server.xml file. Review each <Connector> element for the address setting and the clientAuth setting.\r\n    sudo grep -i -B1 -A5 connector $CATALINA_HOME/conf/server.xml\r\n    If a connector has a configured IP address that is proxied or load balanced and the clientAuth setting is not \\\"true\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/conf/server.xml file. \r\n    Modify each <Connector> element where the IP address is behind a proxy or load balancer.\r\n    Set clientAuth=\\\"true\\\" then identify the applications that are associated with the connector \r\n    and edit the associated web.xml files. Assure the <auth-method> is set to CLIENT-CERT.\"\r\n\r\n    describe \"This is a manual fix\" do \r\n        skip \"Review the SSP or interview the system admin. If there are any Tomcat IP addresses that are served by a load balancer\r\n        or proxy. Check each <Connector> element for the IP address and ensure the clientAuth setting is 'True'\"\r\n    end\r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000800.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual fix",
                      "run_time":4.122e-06,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "resource":"",
                      "skip_message":"Review the SSP or interview the system admin. If there are any Tomcat IP addresses that are served by a load balancer\n        or proxy. Check each <Connector> element for the IP address and ensure the clientAuth setting is 'True'"
                   }
                ]
             },
             {
                "id":"TCAT-AS-000810",
                "title":"Idle timeout for management application must be set to 10 minutes.",
                "desc":"Tomcat can set idle session timeouts on a per application basis. The management application is provided with the Tomcat \n    installation and is used to manage the applications that are installed on the Tomcat Server. Setting the idle timeout for the \n    management application will kill the admin user's session after 10 minutes of inactivity. This will limit the opportunity for \n    unauthorized persons to hijack the admin session. This setting will also affect the default timeout behavior of all hosted web \n    applications. To adjust the individual hosted application settings that are not related to management of the system, modify \n    the individual application web.xml file if application timeout requirements differ from the STIG.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat can set idle session timeouts on a per application basis. The management application is provided with the Tomcat \n    installation and is used to manage the applications that are installed on the Tomcat Server. Setting the idle timeout for the \n    management application will kill the admin user's session after 10 minutes of inactivity. This will limit the opportunity for \n    unauthorized persons to hijack the admin session. This setting will also affect the default timeout behavior of all hosted web \n    applications. To adjust the individual hosted application settings that are not related to management of the system, modify \n    the individual application web.xml file if application timeout requirements differ from the STIG."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000220-AS-000148",
                   "gid":"TCAT-AS-000810",
                   "rid":"TCAT-AS-000810_rule",
                   "stig_id":"TCAT-AS-000810",
                   "cci":"CCI-001185",
                   "nist":[
                      "SC-23",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"If the manager application has been deleted from the system, this is not a finding. \n    From the Tomcat server as a privileged user, run the following commands:\n    sudo grep -i session-timeout $CATALINA_HOME/webapps/manager/META-INF/web.xml \n    sudo grep -i session-timeout \n    $CATALINA_HOME/conf/web.xml\n    If the session-timeout setting is not configured to be 10 minutes in at least one of these files, this is a finding.",
                   "fix":"If the manager application has been deleted from the system, this is not a finding. \n    From the Tomcat server as a privileged user:\n    To affect session timeout for all applications including the management application, edit the $CATALINA_HOME/conf/web.xml file.\n    To affect session timeout for the management application only, edit the $CATALINA_HOME/webapps/manager/META-INF/web.xml file. \n    Locate the session-timeout setting located within the session-config element.\n    Modify the session-timeout setting to be 10 minutes.\n    Save the file.\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000810\" do\r\n    title \"Idle timeout for management application must be set to 10 minutes.\"\r\n    desc  \"Tomcat can set idle session timeouts on a per application basis. The management application is provided with the Tomcat \r\n    installation and is used to manage the applications that are installed on the Tomcat Server. Setting the idle timeout for the \r\n    management application will kill the admin user's session after 10 minutes of inactivity. This will limit the opportunity for \r\n    unauthorized persons to hijack the admin session. This setting will also affect the default timeout behavior of all hosted web \r\n    applications. To adjust the individual hosted application settings that are not related to management of the system, modify \r\n    the individual application web.xml file if application timeout requirements differ from the STIG.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000220-AS-000148\"\r\n    tag \"gid\": \"TCAT-AS-000810\"\r\n    tag \"rid\": \"TCAT-AS-000810_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000810\"\r\n    tag \"cci\": \"CCI-001185\"\r\n    tag \"nist\": [\"SC-23\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"If the manager application has been deleted from the system, this is not a finding. \r\n    From the Tomcat server as a privileged user, run the following commands:\r\n    sudo grep -i session-timeout $CATALINA_HOME/webapps/manager/META-INF/web.xml \r\n    sudo grep -i session-timeout \r\n    $CATALINA_HOME/conf/web.xml\r\n    If the session-timeout setting is not configured to be 10 minutes in at least one of these files, this is a finding.\"\r\n    tag \"fix\": \"If the manager application has been deleted from the system, this is not a finding. \r\n    From the Tomcat server as a privileged user:\r\n    To affect session timeout for all applications including the management application, edit the $CATALINA_HOME/conf/web.xml file.\r\n    To affect session timeout for the management application only, edit the $CATALINA_HOME/webapps/manager/META-INF/web.xml file. \r\n    Locate the session-timeout setting located within the session-config element.\r\n    Modify the session-timeout setting to be 10 minutes.\r\n    Save the file.\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n  \r\n    tomcat_web_xmls = [\"$CATALINA_HOME/conf/web.xml\", \"$CATALINA_HOME/webapps/manager/META-INF/web.xml\"]\r\n    tomcat_web_xmls.each do |web_xml|\r\n        if file(\"#{web_xml}\").exist?\r\n            describe xml(\"#{web_xml}\")[\"//session-timeout\"] do \r\n                it { should cmp \"10\" }\r\n            end\r\n        end\r\n    end\r\nend\r\n",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000810.rb"
                },
                "waiver_data":{
 
                },
                "results":[
 
                ]
             },
             {
                "id":"TCAT-AS-000820",
                "title":"Tomcat must be configured to generate session IDs using a FIPS 140-2 approved random number generator.",
                "desc":"If RECYCLE_FACADES is true or if a security manager is in use, a new facade object will be created for \n    each request. This reduces the chances that a bug in an application might expose data from one request to another. \n    This setting is configured using environment variable settings. For Linux OS flavors other than Ubuntu, use the \n    relevant OS commands. For Ubuntu, this setting can be managed in the /etc/systemd/system/tomcat.service file via \n    the CATALINA_OPTS variable. This setting is defined in the file and referenced during tomcat startup in order to \n    load tomcat environment variables. Technically, the tomcat.service referenced in the check and fix could be called \n    a different name; but for STIG purposes and to provide a standard setting that can be referred to and obviously is \n    used for Tomcat, tomcat.service was chosen.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"If RECYCLE_FACADES is true or if a security manager is in use, a new facade object will be created for \n    each request. This reduces the chances that a bug in an application might expose data from one request to another. \n    This setting is configured using environment variable settings. For Linux OS flavors other than Ubuntu, use the \n    relevant OS commands. For Ubuntu, this setting can be managed in the /etc/systemd/system/tomcat.service file via \n    the CATALINA_OPTS variable. This setting is defined in the file and referenced during tomcat startup in order to \n    load tomcat environment variables. Technically, the tomcat.service referenced in the check and fix could be called \n    a different name; but for STIG purposes and to provide a standard setting that can be referred to and obviously is \n    used for Tomcat, tomcat.service was chosen."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000223-AS-000150",
                   "gid":"TCAT-AS-000820",
                   "rid":"TCAT-AS-000820_rule",
                   "stig_id":"TCAT-AS-000820",
                   "cci":"CCI-001664",
                   "nist":[
                      "SC-23",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server as a privileged user, run the following command:\n    sudo grep -i  recycle_facades /etc/systemd/system/tomcat.service \n    If there are no results, or if the org.apache.catalina.connector. \n    RECYCLE_FACADES is not configured to load at startup, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user: \n    edit the /etc/systemd/system/tomcat.service file and either add or edit the org.apache.catalina.connector.RECYCLE_FACADES setting.\n    Set the org.apache.catalina.connector. RECYCLE_FACADES=true. \n    EXAMPLE:\n    Environment='CATALINA_OPTS -Dorg.apache.catalina.connector. RECYCLE_FACADES=true'\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000820\" do\r\n    title \"Tomcat must be configured to generate session IDs using a FIPS 140-2 approved random number generator.\"\r\n    desc  \"If RECYCLE_FACADES is true or if a security manager is in use, a new facade object will be created for \r\n    each request. This reduces the chances that a bug in an application might expose data from one request to another. \r\n    This setting is configured using environment variable settings. For Linux OS flavors other than Ubuntu, use the \r\n    relevant OS commands. For Ubuntu, this setting can be managed in the /etc/systemd/system/tomcat.service file via \r\n    the CATALINA_OPTS variable. This setting is defined in the file and referenced during tomcat startup in order to \r\n    load tomcat environment variables. Technically, the tomcat.service referenced in the check and fix could be called \r\n    a different name; but for STIG purposes and to provide a standard setting that can be referred to and obviously is \r\n    used for Tomcat, tomcat.service was chosen.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000223-AS-000150\"\r\n    tag \"gid\": \"TCAT-AS-000820\"\r\n    tag \"rid\": \"TCAT-AS-000820_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000820\"\r\n    tag \"cci\": \"CCI-001664\"\r\n    tag \"nist\": [\"SC-23\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server as a privileged user, run the following command:\r\n    sudo grep -i  recycle_facades /etc/systemd/system/tomcat.service \r\n    If there are no results, or if the org.apache.catalina.connector. \r\n    RECYCLE_FACADES is not configured to load at startup, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user: \r\n    edit the /etc/systemd/system/tomcat.service file and either add or edit the org.apache.catalina.connector.RECYCLE_FACADES setting.\r\n    Set the org.apache.catalina.connector. RECYCLE_FACADES=true. \r\n    EXAMPLE:\r\n    Environment='CATALINA_OPTS -Dorg.apache.catalina.connector. RECYCLE_FACADES=true'\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_service_file = \"/etc/systemd/system/tomcat.service\"\r\n    environment = command(\"grep RECYCLE_FACADES #{tomcat_service_file}\").stdout.split(\" \")\r\n\r\n    if !environment.empty?\r\n        environment.each do |param| \r\n            if param.include? \"RECYCLE_FACADES\"\r\n                describe param.split(\"=\")[1] do \r\n                    it { should include \"true\" }\r\n                end\r\n            end \r\n        end\r\n    else \r\n        describe environment do \r\n            skip \"RECYCLE_FACADES param not found. RECYCLE_FACADES must be set to load at startup. This check has failed.\"\r\n        end\r\n    end \r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000820.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"[]",
                      "run_time":4.278e-06,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "resource":"[]",
                      "skip_message":"RECYCLE_FACADES param not found. RECYCLE_FACADES must be set to load at startup. This check has failed."
                   }
                ]
             },
             {
                "id":"TCAT-AS-000840",
                "title":"Secured connectors must use FIPS 140-2-validated cipher algorithms.",
                "desc":"The HTTP protocol is not session oriented so application servers will use session IDs to track application \n    user sessions. Unique session IDs address man-in-the-middle attacks, including session hijacking or insertion of \n    false information into a session. If the attacker is unable to identify or guess the session information related \n    to pending application traffic, they will have more difficulty in hijacking the session or otherwise manipulating \n    valid sessions.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The HTTP protocol is not session oriented so application servers will use session IDs to track application \n    user sessions. Unique session IDs address man-in-the-middle attacks, including session hijacking or insertion of \n    false information into a session. If the attacker is unable to identify or guess the session information related \n    to pending application traffic, they will have more difficulty in hijacking the session or otherwise manipulating \n    valid sessions."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000224-AS-000152",
                   "gid":"TCAT-AS-000840",
                   "rid":"TCAT-AS-000840_rule",
                   "stig_id":"TCAT-AS-000840",
                   "cci":"CCI-001188",
                   "nist":[
                      "SC-23",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo grep -i fipsmode $CATALINA_HOME/conf/server.xml.  \n    If there are no results displayed or if FIPSMode is not set to FIPSMode=\"on\", this is a finding.",
                   "fix":"From the Tomcat server as a privileged user:\n    sudo nano $CATALINA_HOME/conf/server.xml.  \n    In the <Listener/> element, locate the AprLifecycleListener, either add or modify the FIPSMode setting and set it to FIPSMode=\"on\".\n    EXAMPLE: \n    <Listener\n        className=\"org.apache.catalina.core.AprLifecycleListener\"\n        SSLEngine=\"on\"\n        FIPSMode=\"on\"\n    />\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000840\" do\r\n    title \"Secured connectors must use FIPS 140-2-validated cipher algorithms.\"\r\n    desc  \"The HTTP protocol is not session oriented so application servers will use session IDs to track application \r\n    user sessions. Unique session IDs address man-in-the-middle attacks, including session hijacking or insertion of \r\n    false information into a session. If the attacker is unable to identify or guess the session information related \r\n    to pending application traffic, they will have more difficulty in hijacking the session or otherwise manipulating \r\n    valid sessions.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000224-AS-000152\"\r\n    tag \"gid\": \"TCAT-AS-000840\"\r\n    tag \"rid\": \"TCAT-AS-000840_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000840\"\r\n    tag \"cci\": \"CCI-001188\"\r\n    tag \"nist\": [\"SC-23\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo grep -i fipsmode $CATALINA_HOME/conf/server.xml.  \r\n    If there are no results displayed or if FIPSMode is not set to FIPSMode=\\\"on\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user:\r\n    sudo nano $CATALINA_HOME/conf/server.xml.  \r\n    In the <Listener/> element, locate the AprLifecycleListener, either add or modify the FIPSMode setting and set it to FIPSMode=\\\"on\\\".\r\n    EXAMPLE: \r\n    <Listener\r\n        className=\\\"org.apache.catalina.core.AprLifecycleListener\\\"\r\n        SSLEngine=\\\"on\\\"\r\n        FIPSMode=\\\"on\\\"\r\n    />\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    listeners = tomcat_server_file[\"//Listener/@className\"]\r\n    index = 0\r\n\r\n    if listeners.include? \"org.apache.catalina.core.AprLifecycleListener\"\r\n        for i in 0..listeners.count\r\n            if listeners[i] == \"org.apache.catalina.core.AprLifecycleListener\"\r\n                break\r\n            else\r\n                index+=1\r\n            end\r\n        end\r\n    end\r\n    \r\n    fips_mode = tomcat_server_file[\"//Listener[#{index}]/@FIPSMode\"]\r\n    if !fips_mode.empty?\r\n        describe fips_mode do \r\n            it { should cmp \"on\" }\r\n        end\r\n    else \r\n        describe fips_mode.empty? do \r\n            puts \"FIPSMode attribute must be defined and must be set to 'on'. This check has failed.\"\r\n            it { should  cmp \"false\" }\r\n        end\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000840.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000840.rb:1 ",
                      "run_time":0.001860509,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000860",
                "title":"Clusters must operate on a trusted network.",
                "desc":"Operating a Tomcat cluster on an untrusted network creates potential for unauthorized persons to view or \n    manipulate cluster session traffic. When operating a Tomcat cluster, care must be taken to isolate the cluster \n    traffic from untrusted sources. Options include using a private VLAN, VPN, or IPSEC tunnel or by encrypting cluster \n    traffic by using the EncryptInterceptor. The EncryptInterceptor adds encryption to the channel messages carrying session \n    data between Tomcat cluster nodes. Place the <Cluster> element inside either the <Engine> container or the <Host> container.\n    Placing it in the engine means supporting clustering in all virtual hosts of Tomcat and sharing the messaging component. \n    When the user places the <Cluster> inside the <Engine> element, the cluster will append the host name of each session \n    manager to the manager's name so that two contexts with the same name (but sitting inside two different hosts) will be \n    distinguishable.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Operating a Tomcat cluster on an untrusted network creates potential for unauthorized persons to view or \n    manipulate cluster session traffic. When operating a Tomcat cluster, care must be taken to isolate the cluster \n    traffic from untrusted sources. Options include using a private VLAN, VPN, or IPSEC tunnel or by encrypting cluster \n    traffic by using the EncryptInterceptor. The EncryptInterceptor adds encryption to the channel messages carrying session \n    data between Tomcat cluster nodes. Place the <Cluster> element inside either the <Engine> container or the <Host> container.\n    Placing it in the engine means supporting clustering in all virtual hosts of Tomcat and sharing the messaging component. \n    When the user places the <Cluster> inside the <Engine> element, the cluster will append the host name of each session \n    manager to the manager's name so that two contexts with the same name (but sitting inside two different hosts) will be \n    distinguishable."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000225-AS-000154",
                   "gid":"TCAT-AS-000860",
                   "rid":"TCAT-AS-000860_rule",
                   "stig_id":"TCAT-AS-000860",
                   "cci":"CCI-001190",
                   "nist":[
                      "SC-24",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Review System Security Plan (SSP) documentation determine if the Tomcat server is part of an \n    application server cluster. Also identify Tomcat network interfaces and the proxy/load balancer that front-ends the cluster.\n    From the Tomcat server as a privileged user, run the following command:\n    sudo grep -i -A2 -B2 \"Cluster\" $CATALINA_HOME/conf/server.xml\n    If the <Cluster/> element is commented out, or there are no results returned, this requirement is NA.\n    If a cluster is in use, run the following command as a privileged user:\n    grep -i EncryptInterceptor $CATALINA_HOME/conf/server.xml file.  \n    If the Tomcat server is clustered and the EncryptionInterceptor is not in use or if the cluster traffic \n    is not on a private network or VLAN, this is a finding.",
                   "fix":"Update the System Security Plan (SSP) and document the network interfaces, their related IP addresses, \n    and which interfaces transport Tomcat cluster traffic. Also document which interface is multi-cast enabled if using \n    the McastService membership class versus Static. \n    To obtain the information needed for the SSP:\n    sudo grep -i -A3 \"<Membership className\" $CATALINA_HOME/conf.server.xml\n    Document the address=\"<ipAddress>\" value.\n    Review the OS routing tables. Identify and document which interface is configured to route the Tomcat class D IP multicast traffic. \n    sudo netstat -r \n    END of Documentation instructions.\n    From the Tomcat server as a privileged user, edit the $CATALINA_HOME/conf/server.xml file.\n    sudo nano $CATALINA_HOME/conf/server.xml\n    Locate the <Interceptor/> element nested within the <Channel/> element.\n    Add the <Interceptor className=\"org.apache.catalina.tribes.group.\n    interceptors.EncryptInterceptor\"/> to the server.xml and save the file.\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    NOTE:\n    The EncryptInterceptor adds encryption to the channel messages carrying session data between nodes. This feature \n    was added in Tomcat 9.0.13. If using the TcpFailureDetector interceptor, the EncryptInterceptor must be inserted \n    into the interceptor chain BEFORE the TcpFailureDetector. When validating cluster members, TcpFailureDetector \n    writes channel data directly to the other members without using the remainder of the interceptor chain, but on \n    the receiving side, the message still goes through the chain (in reverse). Because of this asymmetry, the \n    EncryptInterceptor must execute before the TcpFailureDetector on the sender and after it on the receiver, \n    otherwise message corruption will occur."
                },
                "code":"control \"TCAT-AS-000860\" do\r\n    title \"Clusters must operate on a trusted network.\"\r\n    desc  \"Operating a Tomcat cluster on an untrusted network creates potential for unauthorized persons to view or \r\n    manipulate cluster session traffic. When operating a Tomcat cluster, care must be taken to isolate the cluster \r\n    traffic from untrusted sources. Options include using a private VLAN, VPN, or IPSEC tunnel or by encrypting cluster \r\n    traffic by using the EncryptInterceptor. The EncryptInterceptor adds encryption to the channel messages carrying session \r\n    data between Tomcat cluster nodes. Place the <Cluster> element inside either the <Engine> container or the <Host> container.\r\n    Placing it in the engine means supporting clustering in all virtual hosts of Tomcat and sharing the messaging component. \r\n    When the user places the <Cluster> inside the <Engine> element, the cluster will append the host name of each session \r\n    manager to the manager's name so that two contexts with the same name (but sitting inside two different hosts) will be \r\n    distinguishable.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000225-AS-000154\"\r\n    tag \"gid\": \"TCAT-AS-000860\"\r\n    tag \"rid\": \"TCAT-AS-000860_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000860\"\r\n    tag \"cci\": \"CCI-001190\"\r\n    tag \"nist\": [\"SC-24\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Review System Security Plan (SSP) documentation determine if the Tomcat server is part of an \r\n    application server cluster. Also identify Tomcat network interfaces and the proxy/load balancer that front-ends the cluster.\r\n    From the Tomcat server as a privileged user, run the following command:\r\n    sudo grep -i -A2 -B2 \\\"Cluster\\\" $CATALINA_HOME/conf/server.xml\r\n    If the <Cluster/> element is commented out, or there are no results returned, this requirement is NA.\r\n    If a cluster is in use, run the following command as a privileged user:\r\n    grep -i EncryptInterceptor $CATALINA_HOME/conf/server.xml file.  \r\n    If the Tomcat server is clustered and the EncryptionInterceptor is not in use or if the cluster traffic \r\n    is not on a private network or VLAN, this is a finding.\"\r\n    tag \"fix\": \"Update the System Security Plan (SSP) and document the network interfaces, their related IP addresses, \r\n    and which interfaces transport Tomcat cluster traffic. Also document which interface is multi-cast enabled if using \r\n    the McastService membership class versus Static. \r\n    To obtain the information needed for the SSP:\r\n    sudo grep -i -A3 \\\"<Membership className\\\" $CATALINA_HOME/conf.server.xml\r\n    Document the address=\\\"<ipAddress>\\\" value.\r\n    Review the OS routing tables. Identify and document which interface is configured to route the Tomcat class D IP multicast traffic. \r\n    sudo netstat -r \r\n    END of Documentation instructions.\r\n    From the Tomcat server as a privileged user, edit the $CATALINA_HOME/conf/server.xml file.\r\n    sudo nano $CATALINA_HOME/conf/server.xml\r\n    Locate the <Interceptor/> element nested within the <Channel/> element.\r\n    Add the <Interceptor className=\\\"org.apache.catalina.tribes.group.\r\n    interceptors.EncryptInterceptor\\\"/> to the server.xml and save the file.\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    NOTE:\r\n    The EncryptInterceptor adds encryption to the channel messages carrying session data between nodes. This feature \r\n    was added in Tomcat 9.0.13. If using the TcpFailureDetector interceptor, the EncryptInterceptor must be inserted \r\n    into the interceptor chain BEFORE the TcpFailureDetector. When validating cluster members, TcpFailureDetector \r\n    writes channel data directly to the other members without using the remainder of the interceptor chain, but on \r\n    the receiving side, the message still goes through the chain (in reverse). Because of this asymmetry, the \r\n    EncryptInterceptor must execute before the TcpFailureDetector on the sender and after it on the receiver, \r\n    otherwise message corruption will occur.\"\r\n    \r\n    describe \"This is a manual check\" do \r\n        skip \"Review System Security Plan (SSP) documentation determine if the Tomcat server is part of an \r\n        application server cluster. Also identify Tomcat network interfaces and the proxy/load balancer that \r\n        front-ends the cluster.\"\r\n    end\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000860.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":4.955e-06,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "resource":"",
                      "skip_message":"Review System Security Plan (SSP) documentation determine if the Tomcat server is part of an \n        application server cluster. Also identify Tomcat network interfaces and the proxy/load balancer that \n        front-ends the cluster."
                   }
                ]
             },
             {
                "id":"TCAT-AS-000920",
                "title":"ErrorReportValve showServerInfo must be set to false.",
                "desc":"The Error Report Valve is a simple error handler for HTTP status codes that will generate and return HTML \n    error pages. It can also be configured to return pre-defined static HTML pages for specific status codes and/or \n    exception types. Disabling showServerInfo will only return the HTTP status code and remove all CSS from the default \n    non-error related HTTP responses.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The Error Report Valve is a simple error handler for HTTP status codes that will generate and return HTML \n    error pages. It can also be configured to return pre-defined static HTML pages for specific status codes and/or \n    exception types. Disabling showServerInfo will only return the HTTP status code and remove all CSS from the default \n    non-error related HTTP responses."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000266-AS-000169",
                   "gid":"TCAT-AS-000920",
                   "rid":"TCAT-AS-000920_rule",
                   "stig_id":"TCAT-AS-000920",
                   "cci":"CCI-001312",
                   "nist":[
                      "SI-11",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server run the following command:\n    sudo grep -i ErrorReportValve $CATALINA_HOME\\conf\\server.xml file.\n    If the ErrorReportValve element is not defined and showServerInfo set to \"false\", this is a finding.\n    EXAMPLE:\n    <Host ...>\n      ...\n      <Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showServerInfo=\"false\"/>\n      ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Create or modify an ErrorReportValve <Valve> element nested beneath each <Host> element.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.ErrorReportValve\" \n    showServerInfo=\"false\" />\n    ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000920\" do\r\n    title \"ErrorReportValve showServerInfo must be set to false.\"\r\n    desc  \"The Error Report Valve is a simple error handler for HTTP status codes that will generate and return HTML \r\n    error pages. It can also be configured to return pre-defined static HTML pages for specific status codes and/or \r\n    exception types. Disabling showServerInfo will only return the HTTP status code and remove all CSS from the default \r\n    non-error related HTTP responses.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000266-AS-000169\"\r\n    tag \"gid\": \"TCAT-AS-000920\"\r\n    tag \"rid\": \"TCAT-AS-000920_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000920\"\r\n    tag \"cci\": \"CCI-001312\"\r\n    tag \"nist\": [\"SI-11\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server run the following command:\r\n    sudo grep -i ErrorReportValve $CATALINA_HOME\\\\conf\\\\server.xml file.\r\n    If the ErrorReportValve element is not defined and showServerInfo set to \\\"false\\\", this is a finding.\r\n    EXAMPLE:\r\n    <Host ...>\r\n      ...\r\n      <Valve className=\\\"org.apache.catalina.valves.ErrorReportValve\\\" showServerInfo=\\\"false\\\"/>\r\n      ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Create or modify an ErrorReportValve <Valve> element nested beneath each <Host> element.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.ErrorReportValve\\\" \r\n    showServerInfo=\\\"false\\\" />\r\n    ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    valves = tomcat_server_file[\"//Valve/@className\"]\r\n\r\n    if valves.include?(\"org.apache.catalina.valves.ErrorReportValve\")\r\n      valves.each do |valve|\r\n        if valve == \"org.apache.catalina.valves.ErrorReportValve\"\r\n          describe tomcat_server_file[\"//Valve/@showServerInfo\"] do \r\n            it { should cmp \"false\" }\r\n          end\r\n        end\r\n      end\r\n    else\r\n      describe valves do \r\n        it { should include \"org.apache.catalina.valves.ErrorReportValve\" }\r\n      end\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000920.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000920.rb:1 ",
                      "run_time":0.001604374,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000930",
                "title":"Default error pages for manager application must be customized.",
                "desc":"Default error pages that accompany the manager application provide sensitive information to potential attackers. \n    These error pages provide responses to 401, 402, and 403 error codes and must be modified so the error responses do not \n    provide clients with any sensitive information.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Default error pages that accompany the manager application provide sensitive information to potential attackers. \n    These error pages provide responses to 401, 402, and 403 error codes and must be modified so the error responses do not \n    provide clients with any sensitive information."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000267-AS-000170",
                   "gid":"TCAT-AS-000930",
                   "rid":"TCAT-AS-000930_rule",
                   "stig_id":"TCAT-AS-000930",
                   "cci":"CCI-001314",
                   "nist":[
                      "SI-11",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo cat $CATALINA_HOME/webapps/manager/WEB-INF/jsp/401.jsp \n    Repeat for the 402.jsp and 403.jsp files. \n    The default error files contain default passwords and user accounts. \n    If the error files contained in this folder are not customized and default account information removed, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user:\n    Use a file editor like nano or vi and edit the 401, 402, and 403 jsp files. Remove sensitive account information \n    and make the files reflect generic error information that assists users but does not provide sensitive data to users.\n    Save the file and restart Tomcat:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000930\" do\r\n    title \"Default error pages for manager application must be customized.\"\r\n    desc  \"Default error pages that accompany the manager application provide sensitive information to potential attackers. \r\n    These error pages provide responses to 401, 402, and 403 error codes and must be modified so the error responses do not \r\n    provide clients with any sensitive information.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000267-AS-000170\"\r\n    tag \"gid\": \"TCAT-AS-000930\"\r\n    tag \"rid\": \"TCAT-AS-000930_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000930\"\r\n    tag \"cci\": \"CCI-001314\"\r\n    tag \"nist\": [\"SI-11\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo cat $CATALINA_HOME/webapps/manager/WEB-INF/jsp/401.jsp \r\n    Repeat for the 402.jsp and 403.jsp files. \r\n    The default error files contain default passwords and user accounts. \r\n    If the error files contained in this folder are not customized and default account information removed, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user:\r\n    Use a file editor like nano or vi and edit the 401, 402, and 403 jsp files. Remove sensitive account information \r\n    and make the files reflect generic error information that assists users but does not provide sensitive data to users.\r\n    Save the file and restart Tomcat:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    describe \"This is a manual check\" do \r\n        skip \"For the $CATALINA_HOME/webapps/manager/WEB-INF/jsp/401.jsp and \r\n        the ..402.jsp and ..403.jsp pages. Remove default and sensitive infomation.\"\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000930.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":8.28e-06,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "resource":"",
                      "skip_message":"For the $CATALINA_HOME/webapps/manager/WEB-INF/jsp/401.jsp and \n        the ..402.jsp and ..403.jsp pages. Remove default and sensitive infomation."
                   }
                ]
             },
             {
                "id":"TCAT-AS-000940",
                "title":"ErrorReportValve showReport must be set to false.",
                "desc":"The Error Report Valve is a simple error handler for HTTP status codes that will generate and return HTML error \n    pages. It can also be configured to return pre-defined static HTML pages for specific status codes and/or exception types. \n    Disabling showReport will result in no error message or stack trace being send to the client. This setting can be tailored \n    on a per-application basis within each application specific web.xml.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The Error Report Valve is a simple error handler for HTTP status codes that will generate and return HTML error \n    pages. It can also be configured to return pre-defined static HTML pages for specific status codes and/or exception types. \n    Disabling showReport will result in no error message or stack trace being send to the client. This setting can be tailored \n    on a per-application basis within each application specific web.xml."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000267-AS-000170",
                   "gid":"TCAT-AS-000940",
                   "rid":"TCAT-AS-000940_rule",
                   "stig_id":"TCAT-AS-000940",
                   "cci":"CCI-001314",
                   "nist":[
                      "SI-11",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server run the following command:\n    sudo grep -i ErrorReportValve $CATALINA_HOME\u000fnf erver.xml file.\n    If the \"org.apache.catalina.valves.ErrorReportValve\" className is not defined, or if showReport is set to \"false\", this is a finding.\n    EXAMPLE:\n    <Host ...>\n    ...\n      <Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showReport=\"false\"/>\n    ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Create or modify the ErrorReportValve <Valve> element nested beneath each <Host> element, define the ErrorReportValve className, and set \"showReport=false\".\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.ErrorReportValve\" \n    showReport=\"false\" />\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000940\" do\r\n    title \"ErrorReportValve showReport must be set to false.\"\r\n    desc  \"The Error Report Valve is a simple error handler for HTTP status codes that will generate and return HTML error \r\n    pages. It can also be configured to return pre-defined static HTML pages for specific status codes and/or exception types. \r\n    Disabling showReport will result in no error message or stack trace being send to the client. This setting can be tailored \r\n    on a per-application basis within each application specific web.xml.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000267-AS-000170\"\r\n    tag \"gid\": \"TCAT-AS-000940\"\r\n    tag \"rid\": \"TCAT-AS-000940_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000940\"\r\n    tag \"cci\": \"CCI-001314\"\r\n    tag \"nist\": [\"SI-11\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server run the following command:\r\n    sudo grep -i ErrorReportValve $CATALINA_HOME\\conf\\server.xml file.\r\n    If the \\\"org.apache.catalina.valves.ErrorReportValve\\\" className is not defined, or if showReport is set to \\\"false\\\", this is a finding.\r\n    EXAMPLE:\r\n    <Host ...>\r\n    ...\r\n      <Valve className=\\\"org.apache.catalina.valves.ErrorReportValve\\\" showReport=\\\"false\\\"/>\r\n    ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Create or modify the ErrorReportValve <Valve> element nested beneath each <Host> element, define the ErrorReportValve className, and set \\\"showReport=false\\\".\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.ErrorReportValve\\\" \r\n    showReport=\\\"false\\\" />\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    valves = tomcat_server_file[\"//Valve/@className\"]\r\n\r\n    if valves.include?(\"org.apache.catalina.valves.ErrorReportValve\")\r\n      valves.each do |valve|\r\n        if valve == \"org.apache.catalina.valves.ErrorReportValve\"\r\n          describe tomcat_server_file[\"//Valve/@showReport\"] do \r\n            it { should cmp \"false\" }\r\n          end\r\n        end\r\n      end\r\n    else\r\n      describe valves do \r\n        it { should include \"org.apache.catalina.valves.ErrorReportValve\" }\r\n      end\r\n    end\r\n      \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000940.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-000940.rb:1 ",
                      "run_time":0.001612161,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-000950",
                "title":"Tomcat server version must not be sent with warnings and errors.",
                "desc":"Remove version string from HTTP error messages by repacking CATALINA_HOME/server/lib/catalina.jar \n    with an updated ServerInfo.properties file. This will modify the server information that is provided in \n    error and warning responses.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Remove version string from HTTP error messages by repacking CATALINA_HOME/server/lib/catalina.jar \n    with an updated ServerInfo.properties file. This will modify the server information that is provided in \n    error and warning responses."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000267-AS-000170",
                   "gid":"TCAT-AS-000950",
                   "rid":"TCAT-AS-000950_rule",
                   "stig_id":"TCAT-AS-000950",
                   "cci":"CCI-001314",
                   "nist":[
                      "SI-11",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server, cd to the $CATALINA_HOME/lib folder. \n    As a privileged user run the following case-sensitive command:\n    sudo jar -xf catalina.jar org/apache/catalina/util/ServerInfo.properties\n    Check the ServerInfo.properties file.\n    sudo grep -i server org/apache/catalina/util/ServerInfo.properties\n    If server.info=Apache Tomcat or server.number=the actual Tomcat version, this is a finding.",
                   "fix":"From the Tomcat server, cd to the $CATALINA_HOME/lib folder. \n    As a privileged user run the following case-sensitive command:\n    sudo jar -xf catalina.jar org/apache/catalina/util/ServerInfo.properties\n    Edit the ServerInfo.properties file.\n    sudo nano org/apache/catalina/util/ServerInfo.properties\n    Change server.info and server.number to read:\n    server.info=Nunya\n    server.number=1.2.3.4\n    Save the ServerInfo.properties file.\n    Run the following command to update the catalina.jar file:\n    sudo jar -uf catalina.jar org/apache/catalina/util/ServerInfo.properties\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo rm -rf opt/"
                },
                "code":"control \"TCAT-AS-000950\" do\r\n    title \"Tomcat server version must not be sent with warnings and errors.\"\r\n    desc  \"Remove version string from HTTP error messages by repacking CATALINA_HOME/server/lib/catalina.jar \r\n    with an updated ServerInfo.properties file. This will modify the server information that is provided in \r\n    error and warning responses.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000267-AS-000170\"\r\n    tag \"gid\": \"TCAT-AS-000950\"\r\n    tag \"rid\": \"TCAT-AS-000950_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000950\"\r\n    tag \"cci\": \"CCI-001314\"\r\n    tag \"nist\": [\"SI-11\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server, cd to the $CATALINA_HOME/lib folder. \r\n    As a privileged user run the following case-sensitive command:\r\n    sudo jar -xf catalina.jar org/apache/catalina/util/ServerInfo.properties\r\n    Check the ServerInfo.properties file.\r\n    sudo grep -i server org/apache/catalina/util/ServerInfo.properties\r\n    If server.info=Apache Tomcat or server.number=the actual Tomcat version, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server, cd to the $CATALINA_HOME/lib folder. \r\n    As a privileged user run the following case-sensitive command:\r\n    sudo jar -xf catalina.jar org/apache/catalina/util/ServerInfo.properties\r\n    Edit the ServerInfo.properties file.\r\n    sudo nano org/apache/catalina/util/ServerInfo.properties\r\n    Change server.info and server.number to read:\r\n    server.info=Nunya\r\n    server.number=1.2.3.4\r\n    Save the ServerInfo.properties file.\r\n    Run the following command to update the catalina.jar file:\r\n    sudo jar -uf catalina.jar org/apache/catalina/util/ServerInfo.properties\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo rm -rf opt/\"\r\n\r\n    describe \"This is a manual check\" do \r\n        skip \"Edit the ServerInfo.properties file to modify the server information \r\n        that is provided in error and warning responses.\"\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000950.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":4.679e-06,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "resource":"",
                      "skip_message":"Edit the ServerInfo.properties file to modify the server information \n        that is provided in error and warning responses."
                   }
                ]
             },
             {
                "id":"TCAT-AS-000970",
                "title":"Idle timeout for management application must be set to 10 minutes.",
                "desc":"Tomcat can set idle session timeouts on a per application basis. The management application is provided \n    with the Tomcat installation and is used to manage the applications that are installed on the Tomcat Server. \n    Setting the idle timeout for the management application will kill the admin user's session after 10 minutes of inactivity. \n    This will limit the opportunity for unauthorized persons to hijack the admin session. This setting will also affect the \n    default timeout behavior of all hosted web applications. To adjust the individual hosted application settings that are \n    not related to management of the system, modify the individual application web.xml file if application timeout requirements \n    differ from the STIG.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat can set idle session timeouts on a per application basis. The management application is provided \n    with the Tomcat installation and is used to manage the applications that are installed on the Tomcat Server. \n    Setting the idle timeout for the management application will kill the admin user's session after 10 minutes of inactivity. \n    This will limit the opportunity for unauthorized persons to hijack the admin session. This setting will also affect the \n    default timeout behavior of all hosted web applications. To adjust the individual hosted application settings that are \n    not related to management of the system, modify the individual application web.xml file if application timeout requirements \n    differ from the STIG."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000295-AS-000263",
                   "gid":"TCAT-AS-000970",
                   "rid":"TCAT-AS-000970_rule",
                   "stig_id":"TCAT-AS-000970",
                   "cci":"CCI-002361",
                   "nist":[
                      "AC-12",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"If the manager application has been deleted from the system, this is not a finding. \n    From the Tomcat server as a privileged user, run the following commands:\n    sudo grep -i session-timeout $CATALINA_HOME/webapps/manager/META-INF/web.xml \n    sudo grep -i session-timeout \n    $CATALINA_HOME/conf/web.xml\n    If the session-timeout setting is not configured to be 10 minutes in at least one of these files, this is a finding.",
                   "fix":"If the manager application has been deleted from the system, this is not a finding. \n    From the Tomcat server as a privileged user:\n    To affect session timeout for all applications including the management application, edit the:\n    $CATALINA_HOME/conf/web.xml file.\n    To affect session timeout for the management application only, edit the:\n    $CATALINA_HOME/webapps/manager/META-INF/web.xml file. \n    Locate the session-timeout setting located within the session-config element.\n    Modify the session-timeout setting to be 10 minutes.\n    Save the file.\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-000970\" do\r\n    title \"Idle timeout for management application must be set to 10 minutes.\"\r\n    desc  \"Tomcat can set idle session timeouts on a per application basis. The management application is provided \r\n    with the Tomcat installation and is used to manage the applications that are installed on the Tomcat Server. \r\n    Setting the idle timeout for the management application will kill the admin user's session after 10 minutes of inactivity. \r\n    This will limit the opportunity for unauthorized persons to hijack the admin session. This setting will also affect the \r\n    default timeout behavior of all hosted web applications. To adjust the individual hosted application settings that are \r\n    not related to management of the system, modify the individual application web.xml file if application timeout requirements \r\n    differ from the STIG.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000295-AS-000263\"\r\n    tag \"gid\": \"TCAT-AS-000970\"\r\n    tag \"rid\": \"TCAT-AS-000970_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-000970\"\r\n    tag \"cci\": \"CCI-002361\"\r\n    tag \"nist\": [\"AC-12\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"If the manager application has been deleted from the system, this is not a finding. \r\n    From the Tomcat server as a privileged user, run the following commands:\r\n    sudo grep -i session-timeout $CATALINA_HOME/webapps/manager/META-INF/web.xml \r\n    sudo grep -i session-timeout \r\n    $CATALINA_HOME/conf/web.xml\r\n    If the session-timeout setting is not configured to be 10 minutes in at least one of these files, this is a finding.\"\r\n    tag \"fix\": \"If the manager application has been deleted from the system, this is not a finding. \r\n    From the Tomcat server as a privileged user:\r\n    To affect session timeout for all applications including the management application, edit the:\r\n    $CATALINA_HOME/conf/web.xml file.\r\n    To affect session timeout for the management application only, edit the:\r\n    $CATALINA_HOME/webapps/manager/META-INF/web.xml file. \r\n    Locate the session-timeout setting located within the session-config element.\r\n    Modify the session-timeout setting to be 10 minutes.\r\n    Save the file.\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_web_files = [\"$CATALINA_HOME/conf/web.xml\", \"$CATALINA_HOME/webapps/manager/META-INF/web.xml\"]\r\n    tomcat_web_files.each do |web_file|\r\n        if file(web_file).exist?\r\n            describe xml(web_file)[\"//session-timeout\"] do \r\n                it { should cmp \"10\" }\r\n            end\r\n        end\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-000970.rb"
                },
                "waiver_data":{
 
                },
                "results":[
 
                ]
             },
             {
                "id":"TCAT-AS-001020",
                "title":"LockOutRealms must be used for management of Tomcat.",
                "desc":"A LockOutRealm adds the ability to lock a user out after multiple failed logins. LockOutRealm is an \n    implementation of the Tomcat Realm interface that extends the CombinedRealm to provide user lock out \n    functionality if there are too many failed authentication attempts in a given period of time. A LockOutRealm \n    is created by wrapping around a standard realm such as a JNDI Directory Realm which connects Tomcat to an LDAP Directory. \n    A Catalina container (Engine, Host, or Context) may contain no more than one Realm element (although this one Realm may \n    itself contain multiple nested Realms). In addition, the Realm associated with an Engine or a Host is automatically \n    inherited by lower-level containers unless the lower level container explicitly defines its own Realm. If no Realm \n    is configured for the Engine, an instance of the Null Realm will be configured for the Engine automatically.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"A LockOutRealm adds the ability to lock a user out after multiple failed logins. LockOutRealm is an \n    implementation of the Tomcat Realm interface that extends the CombinedRealm to provide user lock out \n    functionality if there are too many failed authentication attempts in a given period of time. A LockOutRealm \n    is created by wrapping around a standard realm such as a JNDI Directory Realm which connects Tomcat to an LDAP Directory. \n    A Catalina container (Engine, Host, or Context) may contain no more than one Realm element (although this one Realm may \n    itself contain multiple nested Realms). In addition, the Realm associated with an Engine or a Host is automatically \n    inherited by lower-level containers unless the lower level container explicitly defines its own Realm. If no Realm \n    is configured for the Engine, an instance of the Null Realm will be configured for the Engine automatically."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000315-AS-000094",
                   "gid":"TCAT-AS-001020",
                   "rid":"TCAT-AS-001020_rule",
                   "stig_id":"TCAT-AS-001020",
                   "cci":"CCI-002314",
                   "nist":[
                      "AC-17",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo grep -i  LockOutRealm $CATALINA_HOME/conf/server.xml.  \n    If there are no results or if the LockOutRealm is not used for the Tomcat management application context, this is a finding.",
                   "fix":"From the Tomcat server console as a privileged user edit the $CATALINA_HOME/conf/server.xml file\n    sudo nano $CATALINA_HOME/conf/server.xml file\n    Locate or add the LockOutRealm element. Make sure the LockOutRealm element is applied to the management application at a \n    minimum (if the management application is in use on the system). This is done by ensuring the LockOutRealm is nested under \n    the Engine, Host or directly within the management application Context container.\n    EXAMPLE:\n    <Realm className=\"org.apache.catalina.realm.LockOutRealm\" failureCount=\"5\" lockOutTime=\"600\">\n    ...\n    </Realm>"
                },
                "code":"control \"TCAT-AS-001020\" do\r\n    title \"LockOutRealms must be used for management of Tomcat.\"\r\n    desc  \"A LockOutRealm adds the ability to lock a user out after multiple failed logins. LockOutRealm is an \r\n    implementation of the Tomcat Realm interface that extends the CombinedRealm to provide user lock out \r\n    functionality if there are too many failed authentication attempts in a given period of time. A LockOutRealm \r\n    is created by wrapping around a standard realm such as a JNDI Directory Realm which connects Tomcat to an LDAP Directory. \r\n    A Catalina container (Engine, Host, or Context) may contain no more than one Realm element (although this one Realm may \r\n    itself contain multiple nested Realms). In addition, the Realm associated with an Engine or a Host is automatically \r\n    inherited by lower-level containers unless the lower level container explicitly defines its own Realm. If no Realm \r\n    is configured for the Engine, an instance of the Null Realm will be configured for the Engine automatically.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000315-AS-000094\"\r\n    tag \"gid\": \"TCAT-AS-001020\"\r\n    tag \"rid\": \"TCAT-AS-001020_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001020\"\r\n    tag \"cci\": \"CCI-002314\"\r\n    tag \"nist\": [\"AC-17\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo grep -i  LockOutRealm $CATALINA_HOME/conf/server.xml.  \r\n    If there are no results or if the LockOutRealm is not used for the Tomcat management application context, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server console as a privileged user edit the $CATALINA_HOME/conf/server.xml file\r\n    sudo nano $CATALINA_HOME/conf/server.xml file\r\n    Locate or add the LockOutRealm element. Make sure the LockOutRealm element is applied to the management application at a \r\n    minimum (if the management application is in use on the system). This is done by ensuring the LockOutRealm is nested under \r\n    the Engine, Host or directly within the management application Context container.\r\n    EXAMPLE:\r\n    <Realm className=\\\"org.apache.catalina.realm.LockOutRealm\\\" failureCount=\\\"5\\\" lockOutTime=\\\"600\\\">\r\n    ...\r\n    </Realm>\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    realms = tomcat_server_file[\"//Realm/@className\"]\r\n    \r\n    describe realms do \r\n        it { should include \"org.apache.catalina.realm.LockOutRealm\" }\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001020.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001020.rb:1 ",
                      "run_time":0.001618103,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001030",
                "title":"LockOutRealms failureCount attribute must be set to 5 failed logins for admin users.",
                "desc":"A LockOutRealm adds the ability to lock a user out after multiple failed logins. Setting the failureCount \n    attribute to 5 will lock out a user account after 5 failed attempts. LockOutRealm is an implementation of the Tomcat \n    Realm interface that extends the CombinedRealm to provide user lock out functionality if there are too many failed \n    authentication attempts in a given period of time. A LockOutRealm is created by wrapping around a standard realm such \n    as a JNDI Directory Realm which connects Tomcat to an LDAP Directory. A Catalina container (Engine, Host, or Context) \n    may contain no more than one Realm element (although this one Realm may itself contain multiple nested Realms). \n    In addition, the Realm associated with an Engine or a Host is automatically inherited by lower-level containers unless \n    the lower level container explicitly defines its own Realm. If no Realm is configured for the Engine, an instance of \n    the Null Realm will be configured for the Engine automatically.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"A LockOutRealm adds the ability to lock a user out after multiple failed logins. Setting the failureCount \n    attribute to 5 will lock out a user account after 5 failed attempts. LockOutRealm is an implementation of the Tomcat \n    Realm interface that extends the CombinedRealm to provide user lock out functionality if there are too many failed \n    authentication attempts in a given period of time. A LockOutRealm is created by wrapping around a standard realm such \n    as a JNDI Directory Realm which connects Tomcat to an LDAP Directory. A Catalina container (Engine, Host, or Context) \n    may contain no more than one Realm element (although this one Realm may itself contain multiple nested Realms). \n    In addition, the Realm associated with an Engine or a Host is automatically inherited by lower-level containers unless \n    the lower level container explicitly defines its own Realm. If no Realm is configured for the Engine, an instance of \n    the Null Realm will be configured for the Engine automatically."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000316-AS-000199",
                   "gid":"TCAT-AS-001030",
                   "rid":"TCAT-AS-001030_rule",
                   "stig_id":"TCAT-AS-001030",
                   "cci":"CCI-002322",
                   "nist":[
                      "AC-17",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo grep -i  LockOutRealm $CATALINA_HOME/conf/server.xml.  \n    If there are no results or if the LockOutRealm failureCount setting is not configured to 5, this is a finding.",
                   "fix":"From the Tomcat server console as a privileged user edit the $CATALINA_HOME/conf/server.xml file\n    sudo nano $CATALINA_HOME/conf/server.xml file\n    Locate or add the LockOutRealm element. Set LockOutRealm failureCount=\"5\"\n    EXAMPLE:\n        <Realm className=\"org.apache.catalina.realm.LockOutRealm\" failureCount=\"5\" lockOutTime=\"600\">\n    ...\n    </Realm>"
                },
                "code":"control \"TCAT-AS-001030\" do\r\n    title \"LockOutRealms failureCount attribute must be set to 5 failed logins for admin users.\"\r\n    desc  \"A LockOutRealm adds the ability to lock a user out after multiple failed logins. Setting the failureCount \r\n    attribute to 5 will lock out a user account after 5 failed attempts. LockOutRealm is an implementation of the Tomcat \r\n    Realm interface that extends the CombinedRealm to provide user lock out functionality if there are too many failed \r\n    authentication attempts in a given period of time. A LockOutRealm is created by wrapping around a standard realm such \r\n    as a JNDI Directory Realm which connects Tomcat to an LDAP Directory. A Catalina container (Engine, Host, or Context) \r\n    may contain no more than one Realm element (although this one Realm may itself contain multiple nested Realms). \r\n    In addition, the Realm associated with an Engine or a Host is automatically inherited by lower-level containers unless \r\n    the lower level container explicitly defines its own Realm. If no Realm is configured for the Engine, an instance of \r\n    the Null Realm will be configured for the Engine automatically.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000316-AS-000199\"\r\n    tag \"gid\": \"TCAT-AS-001030\"\r\n    tag \"rid\": \"TCAT-AS-001030_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001030\"\r\n    tag \"cci\": \"CCI-002322\"\r\n    tag \"nist\": [\"AC-17\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo grep -i  LockOutRealm $CATALINA_HOME/conf/server.xml.  \r\n    If there are no results or if the LockOutRealm failureCount setting is not configured to 5, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server console as a privileged user edit the $CATALINA_HOME/conf/server.xml file\r\n    sudo nano $CATALINA_HOME/conf/server.xml file\r\n    Locate or add the LockOutRealm element. Set LockOutRealm failureCount=\\\"5\\\"\r\n    EXAMPLE:\r\n        <Realm className=\\\"org.apache.catalina.realm.LockOutRealm\\\" failureCount=\\\"5\\\" lockOutTime=\\\"600\\\">\r\n    ...\r\n    </Realm>\"\r\n    \r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    \r\n    describe tomcat_server_file[\"//Realm/@failureCount\"] do \r\n        it { should cmp \"5\" } \r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001030.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001030.rb:1 ",
                      "run_time":0.001577097,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001040",
                "title":"LockOutRealms lockOutTime attribute must be set to 600 seconds (10 minutes) for admin users.",
                "desc":"A LockOutRealm adds the ability to specify a lockout time that prevents further attempts after multiple failed logins. \n    Setting the lockOutTime attribute to 600 will lock out a user account for 10 minutes. Further authentication failures during \n    the lock out time will cause the lock out timer to reset to zero, effectively extending the lockout time. Valid authentication \n    attempts during the lockout period will not succeed but will also not reset the lockout time. LockOutRealm is an implementation \n    of the Tomcat Realm interface that extends the CombinedRealm to provide user lock out functionality if there are too many failed \n    authentication attempts in a given period of time. A LockOutRealm is created by wrapping around a standard realm such as a \n    JNDI Directory Realm which connects Tomcat to an LDAP Directory. A Catalina container (Engine, Host, or Context) may contain no \n    more than one Realm element (although this one Realm may itself contain multiple nested Realms). In addition, the Realm associated \n    with an Engine or a Host is automatically inherited by lower-level containers unless the lower level container explicitly defines \n    its own Realm. If no Realm is configured for the Engine, an instance of the Null Realm will be configured for the Engine automatically.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"A LockOutRealm adds the ability to specify a lockout time that prevents further attempts after multiple failed logins. \n    Setting the lockOutTime attribute to 600 will lock out a user account for 10 minutes. Further authentication failures during \n    the lock out time will cause the lock out timer to reset to zero, effectively extending the lockout time. Valid authentication \n    attempts during the lockout period will not succeed but will also not reset the lockout time. LockOutRealm is an implementation \n    of the Tomcat Realm interface that extends the CombinedRealm to provide user lock out functionality if there are too many failed \n    authentication attempts in a given period of time. A LockOutRealm is created by wrapping around a standard realm such as a \n    JNDI Directory Realm which connects Tomcat to an LDAP Directory. A Catalina container (Engine, Host, or Context) may contain no \n    more than one Realm element (although this one Realm may itself contain multiple nested Realms). In addition, the Realm associated \n    with an Engine or a Host is automatically inherited by lower-level containers unless the lower level container explicitly defines \n    its own Realm. If no Realm is configured for the Engine, an instance of the Null Realm will be configured for the Engine automatically."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000316-AS-000199",
                   "gid":"TCAT-AS-001040",
                   "rid":"TCAT-AS-001040_rule",
                   "stig_id":"TCAT-AS-001040",
                   "cci":"CCI-002322",
                   "nist":[
                      "AC-17",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo grep -i  LockOutRealm $CATALINA_HOME/conf/server.xml.  \n    If there are no results or if the LockOutRealm lockOutTime setting is not configured to 600 (10 minutes), this is a finding.",
                   "fix":"From the Tomcat server console as a privileged user, edit the $CATALINA_HOME/conf/server.xml file.\n    sudo nano $CATALINA_HOME/conf/server.xml file\n    Locate or add the LockOutRealm element. Set lockOutTime=\"600\"\n    EXAMPLE:\n        <Realm className=\"org.apache.catalina.realm.LockOutRealm\" failureCount=\"5\" lockOutTime=\"600\">\n    ...\n    </Realm>"
                },
                "code":"control \"TCAT-AS-001040\" do\r\n    title \"LockOutRealms lockOutTime attribute must be set to 600 seconds (10 minutes) for admin users.\"\r\n    desc  \"A LockOutRealm adds the ability to specify a lockout time that prevents further attempts after multiple failed logins. \r\n    Setting the lockOutTime attribute to 600 will lock out a user account for 10 minutes. Further authentication failures during \r\n    the lock out time will cause the lock out timer to reset to zero, effectively extending the lockout time. Valid authentication \r\n    attempts during the lockout period will not succeed but will also not reset the lockout time. LockOutRealm is an implementation \r\n    of the Tomcat Realm interface that extends the CombinedRealm to provide user lock out functionality if there are too many failed \r\n    authentication attempts in a given period of time. A LockOutRealm is created by wrapping around a standard realm such as a \r\n    JNDI Directory Realm which connects Tomcat to an LDAP Directory. A Catalina container (Engine, Host, or Context) may contain no \r\n    more than one Realm element (although this one Realm may itself contain multiple nested Realms). In addition, the Realm associated \r\n    with an Engine or a Host is automatically inherited by lower-level containers unless the lower level container explicitly defines \r\n    its own Realm. If no Realm is configured for the Engine, an instance of the Null Realm will be configured for the Engine automatically.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000316-AS-000199\"\r\n    tag \"gid\": \"TCAT-AS-001040\"\r\n    tag \"rid\": \"TCAT-AS-001040_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001040\"\r\n    tag \"cci\": \"CCI-002322\"\r\n    tag \"nist\": [\"AC-17\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo grep -i  LockOutRealm $CATALINA_HOME/conf/server.xml.  \r\n    If there are no results or if the LockOutRealm lockOutTime setting is not configured to 600 (10 minutes), this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server console as a privileged user, edit the $CATALINA_HOME/conf/server.xml file.\r\n    sudo nano $CATALINA_HOME/conf/server.xml file\r\n    Locate or add the LockOutRealm element. Set lockOutTime=\\\"600\\\"\r\n    EXAMPLE:\r\n        <Realm className=\\\"org.apache.catalina.realm.LockOutRealm\\\" failureCount=\\\"5\\\" lockOutTime=\\\"600\\\">\r\n    ...\r\n    </Realm>\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    \r\n    describe tomcat_server_file[\"//Realm/@lockOutTime\"] do \r\n        it { should cmp \"600\" } \r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001040.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001040.rb:1 ",
                      "run_time":0.001534958,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001050",
                "title":"Tomcat user account must be set to nologin.",
                "desc":"When installing Tomcat, a user account is created on the OS. This account is used in order for Tomcat to be able to \n    operate on the OS but does not require the ability to actually log in to the system. Therefore when the account is created, \n    the account must not be provided access to a login shell or other program on the system. This is done by specifying the \"nologin\" \n    parameter in the command/shell field of the passwd file.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"When installing Tomcat, a user account is created on the OS. This account is used in order for Tomcat to be able to \n    operate on the OS but does not require the ability to actually log in to the system. Therefore when the account is created, \n    the account must not be provided access to a login shell or other program on the system. This is done by specifying the \"nologin\" \n    parameter in the command/shell field of the passwd file."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000340-AS-000185",
                   "gid":"TCAT-AS-001050",
                   "rid":"TCAT-AS-001050_rule",
                   "stig_id":"TCAT-AS-001050",
                   "cci":"CCI-002235",
                   "nist":[
                      "AC-6",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the command line of the Tomcat server type the following command:\n    sudo cat /etc/passwd|grep -i tomcat\n    If the command/shell field of the passwd file is not set to \"/usr/sbin/nologin\", this is a finding.",
                   "fix":"From the Tomcat command line type the following command:\n    sudo usermod -s /usr/sbin/nologin tomcat"
                },
                "code":"control \"TCAT-AS-001050\" do\r\n    title \"Tomcat user account must be set to nologin.\"\r\n    desc  \"When installing Tomcat, a user account is created on the OS. This account is used in order for Tomcat to be able to \r\n    operate on the OS but does not require the ability to actually log in to the system. Therefore when the account is created, \r\n    the account must not be provided access to a login shell or other program on the system. This is done by specifying the \\\"nologin\\\" \r\n    parameter in the command/shell field of the passwd file.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000340-AS-000185\"\r\n    tag \"gid\": \"TCAT-AS-001050\"\r\n    tag \"rid\": \"TCAT-AS-001050_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001050\"\r\n    tag \"cci\": \"CCI-002235\"\r\n    tag \"nist\": [\"AC-6\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the command line of the Tomcat server type the following command:\r\n    sudo cat /etc/passwd|grep -i tomcat\r\n    If the command/shell field of the passwd file is not set to \\\"/usr/sbin/nologin\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat command line type the following command:\r\n    sudo usermod -s /usr/sbin/nologin tomcat\"\r\n\r\n    output = command(\"cat /etc/passwd | grep -i tomcat\")\r\n    if output.exit_status == 0\r\n        nologin = output.stdout.strip.split(\":\")[-1]\r\n        describe nologin do \r\n            it { should cmp \"/usr/sbin/nologin\" }\r\n        end \r\n    else \r\n        describe output do \r\n            puts \"tomcat is not defined in /etc/passwd. This check has failed.\"\r\n            its('exit_status') { should cmp 0 }\r\n        end\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001050.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Command: `cat /etc/passwd | grep -i tomcat` exit_status is expected to cmp == 0",
                      "run_time":0.000270801,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"\nexpected: 0\n     got: 1\n\n(compared using `cmp` matcher)\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-001060",
                "title":"Tomcat user account must be a non-privileged user.",
                "desc":"Use a distinct non-privileged user account for running Tomcat. If Tomcat processes are compromised and a privileged \n    user account is used to operate the Tomcat server processes, the entire system becomes compromised.\n    Sample passwd file:\n    tomcat:x:1001:1001::/opt/tomcat/usr/sbin/nologin\n    The user ID is stored in field 3 of the passwd file.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Use a distinct non-privileged user account for running Tomcat. If Tomcat processes are compromised and a privileged \n    user account is used to operate the Tomcat server processes, the entire system becomes compromised.\n    Sample passwd file:\n    tomcat:x:1001:1001::/opt/tomcat/usr/sbin/nologin\n    The user ID is stored in field 3 of the passwd file."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000340-AS-000185",
                   "gid":"TCAT-AS-001060",
                   "rid":"TCAT-AS-001060_rule",
                   "stig_id":"TCAT-AS-001060",
                   "cci":"CCI-002235",
                   "nist":[
                      "AC-6",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Run the following command to identify the Tomcat process UID:\n    ps -ef | { head -1; grep catalina; } | cut -f1 -d\n    Run the following command to obtain the OS user ID tied to the Tomcat process:\n    cat /etc/passwd|grep -i <UID>|cut -f3 -d:\n    If the user ID field of the passwd file is set to < 1000 or = 0, this is a finding.",
                   "fix":"From the Tomcat server, create a tomcat user by adding a new non-privileged user OS account with the following command:\n    sudo useradd tomcat\n    Edit the systemd tomcat.service file or create one if it does notexist. Use the new \"tomcat\" user account by setting; USER=tomcat\n    Location of the file should be /etc/systemd/system/tomcat.service\n    Enable the Tomcat service:\n    sudo restorecon /etc/systemd/system/tomcat.service\n    sudo chmod 644 /etc/systemd/system/tomcat.service\n    sudo systemctl enable tomcat.service\n    Start Tomcat:\n    sudo systemctl start tomcat"
                },
                "code":"control \"TCAT-AS-001060\" do\r\n    title \"Tomcat user account must be a non-privileged user.\"\r\n    desc  \"Use a distinct non-privileged user account for running Tomcat. If Tomcat processes are compromised and a privileged \r\n    user account is used to operate the Tomcat server processes, the entire system becomes compromised.\r\n    Sample passwd file:\r\n    tomcat:x:1001:1001::/opt/tomcat/usr/sbin/nologin\r\n    The user ID is stored in field 3 of the passwd file.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000340-AS-000185\"\r\n    tag \"gid\": \"TCAT-AS-001060\"\r\n    tag \"rid\": \"TCAT-AS-001060_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001060\"\r\n    tag \"cci\": \"CCI-002235\"\r\n    tag \"nist\": [\"AC-6\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Run the following command to identify the Tomcat process UID:\r\n    ps -ef | { head -1; grep catalina; } | cut -f1 -d\" \"\r\n    Run the following command to obtain the OS user ID tied to the Tomcat process:\r\n    cat /etc/passwd|grep -i <UID>|cut -f3 -d:\r\n    If the user ID field of the passwd file is set to < 1000 or = 0, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server, create a tomcat user by adding a new non-privileged user OS account with the following command:\r\n    sudo useradd tomcat\r\n    Edit the systemd tomcat.service file or create one if it does notexist. Use the new \\\"tomcat\\\" user account by setting; USER=tomcat\r\n    Location of the file should be /etc/systemd/system/tomcat.service\r\n    Enable the Tomcat service:\r\n    sudo restorecon /etc/systemd/system/tomcat.service\r\n    sudo chmod 644 /etc/systemd/system/tomcat.service\r\n    sudo systemctl enable tomcat.service\r\n    Start Tomcat:\r\n    sudo systemctl start tomcat\"\r\n\r\n    passwd = command(\"cat /etc/passwd | grep -i tomcat\")\r\n    if passwd.exit_status == 0\r\n        tomcat_user_id = passwd.stdout.strip.split(\":\")[2].to_i \r\n        describe tomcat_user_id do \r\n            it { should_not be < 1000 }\r\n        end \r\n    else\r\n        describe passwd do \r\n            puts \"tomcat should be defined in /etc/passwd \"\r\n            its('exit_status') { should cmp 0 }\r\n        end\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001060.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Command: `cat /etc/passwd | grep -i tomcat` exit_status is expected to cmp == 0",
                      "run_time":0.001679387,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"\nexpected: 0\n     got: 1\n\n(compared using `cmp` matcher)\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-001070",
                "title":"$CATALINA_HOME/bin folder permissions must be set to 750.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root \n    with group Tomcat. While root has read/write privileges, group only has read permissions, and world has no permissions. \n    The exceptions are the logs, temp, and work directories that are owned by the Tomcat user rather than root. This means \n    that even if an attacker compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web \n    applications, or modify existing web applications. The Tomcat process runs with a umask of 007 to maintain these permissions. \n    Note that running Tomcat in a Docker environment can impact how file permissions and user ownership settings are applied. \n    Due to associated Docker configuration complexities, the STIG is scoped for standalone rather than virtual Docker deployments.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root \n    with group Tomcat. While root has read/write privileges, group only has read permissions, and world has no permissions. \n    The exceptions are the logs, temp, and work directories that are owned by the Tomcat user rather than root. This means \n    that even if an attacker compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web \n    applications, or modify existing web applications. The Tomcat process runs with a umask of 007 to maintain these permissions. \n    Note that running Tomcat in a Docker environment can impact how file permissions and user ownership settings are applied. \n    Due to associated Docker configuration complexities, the STIG is scoped for standalone rather than virtual Docker deployments."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000340-AS-000185",
                   "gid":"TCAT-AS-001070",
                   "rid":"TCAT-AS-001070_rule",
                   "stig_id":"TCAT-AS-001070",
                   "cci":"CCI-002235",
                   "nist":[
                      "AC-6",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/bin -follow -maxdepth 0 -type d \\( \\! -perm 750 \\) -ls\n    If no folders are displayed, this is not a finding.\n    If results indicate the $CATALINA_HOME/bin folder permissions are not set to 750, this is a finding.",
                   "fix":"Run the following command on the Tomcat server:\n    sudo find  $CATALINA_HOME/bin -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/bin"
                },
                "code":"control \"TCAT-AS-001070\" do\r\n    title \"$CATALINA_HOME/bin folder permissions must be set to 750.\"\r\n    desc  \"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root \r\n    with group Tomcat. While root has read/write privileges, group only has read permissions, and world has no permissions. \r\n    The exceptions are the logs, temp, and work directories that are owned by the Tomcat user rather than root. This means \r\n    that even if an attacker compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web \r\n    applications, or modify existing web applications. The Tomcat process runs with a umask of 007 to maintain these permissions. \r\n    Note that running Tomcat in a Docker environment can impact how file permissions and user ownership settings are applied. \r\n    Due to associated Docker configuration complexities, the STIG is scoped for standalone rather than virtual Docker deployments.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000340-AS-000185\"\r\n    tag \"gid\": \"TCAT-AS-001070\"\r\n    tag \"rid\": \"TCAT-AS-001070_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001070\"\r\n    tag \"cci\": \"CCI-002235\"\r\n    tag \"nist\": [\"AC-6\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/bin -follow -maxdepth 0 -type d \\\\( \\\\! -perm 750 \\\\) -ls\r\n    If no folders are displayed, this is not a finding.\r\n    If results indicate the $CATALINA_HOME/bin folder permissions are not set to 750, this is a finding.\"\r\n    tag \"fix\": \"Run the following command on the Tomcat server:\r\n    sudo find  $CATALINA_HOME/bin -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/bin\"\r\n    \r\n    tomcat_bin_dir = file(\"$CATALINA_HOME/bin\")\r\n    desribe tomcat_bin_dir do \r\n        its('mode') { should cmp '750' }\r\n    end\r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001070.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001070.rb:1 ",
                      "run_time":0.008994326,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `desribe' for #<Inspec::Rule:0x0000000003a6d648>\nDid you mean?  describe",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001080",
                "title":"Application user name must be logged.",
                "desc":"The access logfile format is defined within a Valve that implements the org.apache.catalina.valves.AccessLogValve \n    interface within the /opt/tomcat/server.xml configuration file: The %u pattern code is included in the pattern element \n    and logs the username used to authenticate to an application. Including the username pattern in the log configuration \n    provides useful information about the application user who is logging in, which is critical for troubleshooting and \n    forensic investigations.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The access logfile format is defined within a Valve that implements the org.apache.catalina.valves.AccessLogValve \n    interface within the /opt/tomcat/server.xml configuration file: The %u pattern code is included in the pattern element \n    and logs the username used to authenticate to an application. Including the username pattern in the log configuration \n    provides useful information about the application user who is logging in, which is critical for troubleshooting and \n    forensic investigations."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000343-AS-000030",
                   "gid":"TCAT-AS-001080",
                   "rid":"TCAT-AS-001080_rule",
                   "stig_id":"TCAT-AS-001080",
                   "cci":"CCI-002234",
                   "nist":[
                      "AC-6",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Review all <Valve> elements. If the pattern= statement does notinclude %u, this is a finding. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Modify the <Valve> element that is nested beneath the <Host> element. Change the AccessLogValve setting to include %u in the pattern= statement. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001080\" do\r\n    title \"Application user name must be logged.\"\r\n    desc  \"The access logfile format is defined within a Valve that implements the org.apache.catalina.valves.AccessLogValve \r\n    interface within the /opt/tomcat/server.xml configuration file: The %u pattern code is included in the pattern element \r\n    and logs the username used to authenticate to an application. Including the username pattern in the log configuration \r\n    provides useful information about the application user who is logging in, which is critical for troubleshooting and \r\n    forensic investigations.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000343-AS-000030\"\r\n    tag \"gid\": \"TCAT-AS-001080\"\r\n    tag \"rid\": \"TCAT-AS-001080_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001080\"\r\n    tag \"cci\": \"CCI-002234\"\r\n    tag \"nist\": [\"AC-6\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Review all <Valve> elements. If the pattern= statement does notinclude %u, this is a finding. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Modify the <Valve> element that is nested beneath the <Host> element. Change the AccessLogValve setting to include %u in the pattern= statement. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    patterns = tomcat_server_file[\"//Valve/@pattern\"]\r\n    patterns.each do |pattern|\r\n        describe pattern do\r\n            it { should include '%u' }\r\n        end\r\n    end\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001080.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001080.rb:1 ",
                      "run_time":0.002543737,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001200",
                "title":"$CATALINA_HOME folder must be owned by the root user, group tomcat.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have the folder where \n    Tomcat is installed owned by the root user with the group set to tomcat. The CATALINA_HOME environment variable \n    should be set to the location of the root directory of the \"binary\" distribution of Tomcat.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have the folder where \n    Tomcat is installed owned by the root user with the group set to tomcat. The CATALINA_HOME environment variable \n    should be set to the location of the root directory of the \"binary\" distribution of Tomcat."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000380-AS-000088",
                   "gid":"TCAT-AS-001200",
                   "rid":"TCAT-AS-001200_rule",
                   "stig_id":"TCAT-AS-001200",
                   "cci":"CCI-001813",
                   "nist":[
                      "CM-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME -follow -maxdepth 0 \\(  ! -user root -o ! -group tomcat \\) -ls\n    If no folders are displayed, this is not a finding.\n    If results indicate the $CATALINA_HOME folder ownership and group membership is not set to root:tomcat, this is a finding.",
                   "fix":"Run the following commands on the Tomcat server:\n    sudo find $CATALINA_HOME -maxdepth 0 \\( ! -user root \\) | sudo xargs chown root\n    sudo find $CATALINA_HOME -maxdepth 0 \\( ! -group tomcat \\) | sudo xargs chgrp tomcat"
                },
                "code":"control \"TCAT-AS-001200\" do\r\n    title \"$CATALINA_HOME folder must be owned by the root user, group tomcat.\"\r\n    desc  \"Tomcat file permissions must be restricted. The standard configuration is to have the folder where \r\n    Tomcat is installed owned by the root user with the group set to tomcat. The CATALINA_HOME environment variable \r\n    should be set to the location of the root directory of the \\\"binary\\\" distribution of Tomcat.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000380-AS-000088\"\r\n    tag \"gid\": \"TCAT-AS-001200\"\r\n    tag \"rid\": \"TCAT-AS-001200_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001200\"\r\n    tag \"cci\": \"CCI-001813\"\r\n    tag \"nist\": [\"CM-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME -follow -maxdepth 0 \\\\(  ! -user root -o ! -group tomcat \\\\) -ls\r\n    If no folders are displayed, this is not a finding.\r\n    If results indicate the $CATALINA_HOME folder ownership and group membership is not set to root:tomcat, this is a finding.\"\r\n    tag \"fix\": \"Run the following commands on the Tomcat server:\r\n    sudo find $CATALINA_HOME -maxdepth 0 \\\\( ! -user root \\\\) | sudo xargs chown root\r\n    sudo find $CATALINA_HOME -maxdepth 0 \\\\( ! -group tomcat \\\\) | sudo xargs chgrp tomcat\"\r\n\r\n    tomcat_dir = file(\"$CATALINA_HOME\")\r\n    desribe tomcat_dir do \r\n        its('owner') { should cmp 'root' }\r\n        its('group') { should cmp 'tomcat' }\r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001200.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001200.rb:1 ",
                      "run_time":0.005286862,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `desribe' for #<Inspec::Rule:0x00000000048023f8>\nDid you mean?  describe",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001220",
                "title":"$CATALINA_HOME/conf/ folder must be a owned by root,  group tomcat.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have Tomcat files contained \n    in the conf/ folder as members of the \"tomcat\" group. While root has read/write privileges, group only has read \n    permissions, and world has no permissions. The exceptions are the logs, temp, and work directories that are owned \n    by the Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, they \n    cannot change the Tomcat configuration, deploy new web applications, or modify existing web applications. \n    The Tomcat process runs with a umask of 007 to maintain these permissions. Note that running Tomcat in a Docker environment \n    can impact how file permissions and user ownership settings are applied. Due to associated Docker configuration complexities, \n    the STIG is scoped for standalone rather than virtual Docker deployments.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have Tomcat files contained \n    in the conf/ folder as members of the \"tomcat\" group. While root has read/write privileges, group only has read \n    permissions, and world has no permissions. The exceptions are the logs, temp, and work directories that are owned \n    by the Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, they \n    cannot change the Tomcat configuration, deploy new web applications, or modify existing web applications. \n    The Tomcat process runs with a umask of 007 to maintain these permissions. Note that running Tomcat in a Docker environment \n    can impact how file permissions and user ownership settings are applied. Due to associated Docker configuration complexities, \n    the STIG is scoped for standalone rather than virtual Docker deployments."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000380-AS-000088",
                   "gid":"TCAT-AS-001220",
                   "rid":"TCAT-AS-001220_rule",
                   "stig_id":"TCAT-AS-001220",
                   "cci":"CCI-001813",
                   "nist":[
                      "CM-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/conf -follow -maxdepth 0 \\(  ! -user root -o ! -group tomcat \\) -ls\n    If no folders are displayed, this is not a finding.\n    If results indicate the $CATALINA_HOME/conf folder ownership and group membership is not set to root:tomcat, this is a finding.",
                   "fix":"Run the following commands on the Tomcat server:\n    sudo find $CATALINA_HOME/conf -maxdepth 0 \\( ! -user root \\) | sudo xargs chown root\n    sudo find $CATALINA_HOME/conf -maxdepth 0 \\( ! -group tomcat \\) | sudo xargs chgrp tomcat"
                },
                "code":"control \"TCAT-AS-001220\" do\r\n    title \"$CATALINA_HOME/conf/ folder must be a owned by root,  group tomcat.\"\r\n    desc  \"Tomcat file permissions must be restricted. The standard configuration is to have Tomcat files contained \r\n    in the conf/ folder as members of the \\\"tomcat\\\" group. While root has read/write privileges, group only has read \r\n    permissions, and world has no permissions. The exceptions are the logs, temp, and work directories that are owned \r\n    by the Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, they \r\n    cannot change the Tomcat configuration, deploy new web applications, or modify existing web applications. \r\n    The Tomcat process runs with a umask of 007 to maintain these permissions. Note that running Tomcat in a Docker environment \r\n    can impact how file permissions and user ownership settings are applied. Due to associated Docker configuration complexities, \r\n    the STIG is scoped for standalone rather than virtual Docker deployments.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000380-AS-000088\"\r\n    tag \"gid\": \"TCAT-AS-001220\"\r\n    tag \"rid\": \"TCAT-AS-001220_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001220\"\r\n    tag \"cci\": \"CCI-001813\"\r\n    tag \"nist\": [\"CM-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/conf -follow -maxdepth 0 \\\\(  ! -user root -o ! -group tomcat \\\\) -ls\r\n    If no folders are displayed, this is not a finding.\r\n    If results indicate the $CATALINA_HOME/conf folder ownership and group membership is not set to root:tomcat, this is a finding.\"\r\n    tag \"fix\": \"Run the following commands on the Tomcat server:\r\n    sudo find $CATALINA_HOME/conf -maxdepth 0 \\\\( ! -user root \\\\) | sudo xargs chown root\r\n    sudo find $CATALINA_HOME/conf -maxdepth 0 \\\\( ! -group tomcat \\\\) | sudo xargs chgrp tomcat\"\r\n    \r\n    tomcat_conf_dir = file(\"$CATALINA_HOME/conf\")\r\n    desribe tomcat_conf_dir do \r\n        its('owner') { should cmp 'root' }\r\n        its('group') { should cmp 'tomcat' }\r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001220.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001220.rb:1 ",
                      "run_time":0.006568113,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `desribe' for #<Inspec::Rule:0x000000000492e3f8>\nDid you mean?  describe",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001230",
                "title":"$CATALINA_HOME/conf folder permissions must be set to 750.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root with \n    group Tomcat. While root has read/write privileges, group only has read permissions, and world has no permissions. The exceptions \n    are the logs, temp, and work directories that are owned by the Tomcat user rather than root. This means that even if an attacker \n    compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, or modify existing web \n    applications. The Tomcat process runs with a umask of 007 to maintain these permissions.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root with \n    group Tomcat. While root has read/write privileges, group only has read permissions, and world has no permissions. The exceptions \n    are the logs, temp, and work directories that are owned by the Tomcat user rather than root. This means that even if an attacker \n    compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, or modify existing web \n    applications. The Tomcat process runs with a umask of 007 to maintain these permissions."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000380-AS-000088",
                   "gid":"TCAT-AS-001230",
                   "rid":"TCAT-AS-001230_rule",
                   "stig_id":"TCAT-AS-001230",
                   "cci":"CCI-001813",
                   "nist":[
                      "CM-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/conf -follow -maxdepth 0 -type d \\( \\! -perm 750 \\) -ls\n    If no folders are displayed, this is not a finding.\n    If results indicate the $CATALINA_HOME/conf folder permissions are not set to 750, this is a finding.",
                   "fix":"Run the following commands on the Tomcat server:\n    sudo find  $CATALINA_HOME/conf -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/conf"
                },
                "code":"control \"TCAT-AS-001230\" do\r\n    title \"$CATALINA_HOME/conf folder permissions must be set to 750.\"\r\n    desc  \"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root with \r\n    group Tomcat. While root has read/write privileges, group only has read permissions, and world has no permissions. The exceptions \r\n    are the logs, temp, and work directories that are owned by the Tomcat user rather than root. This means that even if an attacker \r\n    compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, or modify existing web \r\n    applications. The Tomcat process runs with a umask of 007 to maintain these permissions.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000380-AS-000088\"\r\n    tag \"gid\": \"TCAT-AS-001230\"\r\n    tag \"rid\": \"TCAT-AS-001230_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001230\"\r\n    tag \"cci\": \"CCI-001813\"\r\n    tag \"nist\": [\"CM-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/conf -follow -maxdepth 0 -type d \\\\( \\\\! -perm 750 \\\\) -ls\r\n    If no folders are displayed, this is not a finding.\r\n    If results indicate the $CATALINA_HOME/conf folder permissions are not set to 750, this is a finding.\"\r\n    tag \"fix\": \"Run the following commands on the Tomcat server:\r\n    sudo find  $CATALINA_HOME/conf -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/conf\"\r\n    \r\n    tomcat_conf_dir = file(\"$CATALINA_HOME/conf\")\r\n    desribe tomcat_conf_dir do \r\n        its('mode') { should cmp '750' }\r\n    end\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001230.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001230.rb:1 ",
                      "run_time":0.007161622,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"undefined method `desribe' for #<Inspec::Rule:0x0000000004b1ff18>\nDid you mean?  describe",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001240",
                "title":"Files in the $CATALINA_HOME/conf/ folder must have their permissions set to 640.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned \n    by root with group Tomcat. While root has read/write privileges, group only has read permissions, and world has \n    no permissions. The exceptions are the logs, temp, and work directories that are owned by the Tomcat user rather \n    than root. This means that even if an attacker compromises the Tomcat process, they cannot change the Tomcat \n    configuration, deploy new web applications, or modify existing web applications. The Tomcat process runs with a\n    umask of 007 to maintain these permissions.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned \n    by root with group Tomcat. While root has read/write privileges, group only has read permissions, and world has \n    no permissions. The exceptions are the logs, temp, and work directories that are owned by the Tomcat user rather \n    than root. This means that even if an attacker compromises the Tomcat process, they cannot change the Tomcat \n    configuration, deploy new web applications, or modify existing web applications. The Tomcat process runs with a\n    umask of 007 to maintain these permissions."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000380-AS-000088",
                   "gid":"TCAT-AS-001240",
                   "rid":"TCAT-AS-001240_rule",
                   "stig_id":"TCAT-AS-001240",
                   "cci":"CCI-001813",
                   "nist":[
                      "CM-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/conf/* -follow -maxdepth 0 -type f \\( \\! -perm 640 \\) -ls\n    If no files are displayed, this is not a finding.\n    If results indicate any of the file permissions contained in the $CATALINA_HOME/conf folder are not set to 640, this is a finding.",
                   "fix":"Run the following commands on the Tomcat server:\n    sudo find  $CATALINA_HOME/conf/* -follow -maxdepth 0 -type f -print0 | sudo xargs chmod 640 $CATALINA_HOME/conf/*"
                },
                "code":"control \"TCAT-AS-001240\" do\r\n    title \"Files in the $CATALINA_HOME/conf/ folder must have their permissions set to 640.\"\r\n    desc  \"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned \r\n    by root with group Tomcat. While root has read/write privileges, group only has read permissions, and world has \r\n    no permissions. The exceptions are the logs, temp, and work directories that are owned by the Tomcat user rather \r\n    than root. This means that even if an attacker compromises the Tomcat process, they cannot change the Tomcat \r\n    configuration, deploy new web applications, or modify existing web applications. The Tomcat process runs with a\r\n    umask of 007 to maintain these permissions.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000380-AS-000088\"\r\n    tag \"gid\": \"TCAT-AS-001240\"\r\n    tag \"rid\": \"TCAT-AS-001240_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001240\"\r\n    tag \"cci\": \"CCI-001813\"\r\n    tag \"nist\": [\"CM-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/conf/* -follow -maxdepth 0 -type f \\\\( \\\\! -perm 640 \\\\) -ls\r\n    If no files are displayed, this is not a finding.\r\n    If results indicate any of the file permissions contained in the $CATALINA_HOME/conf folder are not set to 640, this is a finding.\"\r\n    tag \"fix\": \"Run the following commands on the Tomcat server:\r\n    sudo find  $CATALINA_HOME/conf/* -follow -maxdepth 0 -type f -print0 | sudo xargs chmod 640 $CATALINA_HOME/conf/*\"\r\n\r\n    tomcat_conf_dir = \"$CATALINA_HOME/conf\"\r\n    tomcat_conf_files = command(\"ls #{tomcat_conf_dir}\").stdout.split(\"\\n\")\r\n    tomcat_conf_files.each do |conf_file| \r\n        describe file(\"#{tomcat_conf_dir}/#{conf_file}\") do \r\n            its(\"mode\") { should cmp \"640\" }\r\n        end\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001240.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"File $CATALINA_HOME/conf/Catalina mode is expected to cmp == \"640\"",
                      "run_time":0.256855556,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"File $CATALINA_HOME/conf/catalina.policy mode is expected to cmp == \"640\"",
                      "run_time":0.262218833,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"File $CATALINA_HOME/conf/catalina.properties mode is expected to cmp == \"640\"",
                      "run_time":0.269160046,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"File $CATALINA_HOME/conf/context.xml mode is expected to cmp == \"640\"",
                      "run_time":0.263486163,
                      "start_time":"2020-06-17T00:47:12+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"File $CATALINA_HOME/conf/jaspic-providers.xml mode is expected to cmp == \"640\"",
                      "run_time":0.262214917,
                      "start_time":"2020-06-17T00:47:13+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"File $CATALINA_HOME/conf/jaspic-providers.xsd mode is expected to cmp == \"640\"",
                      "run_time":0.26524106,
                      "start_time":"2020-06-17T00:47:13+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"File $CATALINA_HOME/conf/logging.properties mode is expected to cmp == \"640\"",
                      "run_time":0.265607808,
                      "start_time":"2020-06-17T00:47:13+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"File $CATALINA_HOME/conf/server.xml mode is expected to cmp == \"640\"",
                      "run_time":0.001041087,
                      "start_time":"2020-06-17T00:47:13+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"File $CATALINA_HOME/conf/test-tomcat.service mode is expected to cmp == \"640\"",
                      "run_time":0.262155067,
                      "start_time":"2020-06-17T00:47:13+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"File $CATALINA_HOME/conf/tomcat-users.xml mode is expected to cmp == \"640\"",
                      "run_time":0.268639206,
                      "start_time":"2020-06-17T00:47:14+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"File $CATALINA_HOME/conf/tomcat-users.xsd mode is expected to cmp == \"640\"",
                      "run_time":0.262058221,
                      "start_time":"2020-06-17T00:47:14+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   },
                   {
                      "status":"failed",
                      "code_desc":"File $CATALINA_HOME/conf/web.xml mode is expected to cmp == \"640\"",
                      "run_time":0.000218778,
                      "start_time":"2020-06-17T00:47:14+00:00",
                      "message":"\nexpected: 640\n     got: \n\n(compared using `cmp` matcher)\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-001250",
                "title":"$CATALINA_HOME/logs/ folder must be owned by tomcat user, group tomcat.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root with \n    group Tomcat. While root has read/write privileges, group only has read permissions, and world has no permissions. The exceptions \n    are the logs, temp, and work directories that are owned by the Tomcat user rather than root. This means that even if an attacker \n    compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, or modify existing web \n    applications. The Tomcat process runs with a umask of 007 to maintain these permissions.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root with \n    group Tomcat. While root has read/write privileges, group only has read permissions, and world has no permissions. The exceptions \n    are the logs, temp, and work directories that are owned by the Tomcat user rather than root. This means that even if an attacker \n    compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, or modify existing web \n    applications. The Tomcat process runs with a umask of 007 to maintain these permissions."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000380-AS-000088",
                   "gid":"TCAT-AS-001250",
                   "rid":"TCAT-AS-001250_rule",
                   "stig_id":"TCAT-AS-001250",
                   "cci":"CCI-001813",
                   "nist":[
                      "CM-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/logs -follow -maxdepth 0 \\(  ! -user tomcat -o ! -group tomcat \\) -ls\n    If no folders are displayed, this is not a finding.\n    If results indicate the $CATALINA_HOME/logs folder ownership and group membership is not set to tomcat:tomcat, this is a finding.",
                   "fix":"Run the following commands on the Tomcat server:\n    sudo find $CATALINA_HOME/logs -maxdepth 0 \\( ! -user tomcat \\) | sudo xargs chown tomcat\n    sudo find $CATALINA_HOME/logs -maxdepth 0 \\( ! -group tomcat \\) | sudo xargs chgrp tomcat"
                },
                "code":"control \"TCAT-AS-001250\" do\r\n    title \"$CATALINA_HOME/logs/ folder must be owned by tomcat user, group tomcat.\"\r\n    desc  \"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root with \r\n    group Tomcat. While root has read/write privileges, group only has read permissions, and world has no permissions. The exceptions \r\n    are the logs, temp, and work directories that are owned by the Tomcat user rather than root. This means that even if an attacker \r\n    compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, or modify existing web \r\n    applications. The Tomcat process runs with a umask of 007 to maintain these permissions.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000380-AS-000088\"\r\n    tag \"gid\": \"TCAT-AS-001250\"\r\n    tag \"rid\": \"TCAT-AS-001250_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001250\"\r\n    tag \"cci\": \"CCI-001813\"\r\n    tag \"nist\": [\"CM-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/logs -follow -maxdepth 0 \\\\(  ! -user tomcat -o ! -group tomcat \\\\) -ls\r\n    If no folders are displayed, this is not a finding.\r\n    If results indicate the $CATALINA_HOME/logs folder ownership and group membership is not set to tomcat:tomcat, this is a finding.\"\r\n    tag \"fix\": \"Run the following commands on the Tomcat server:\r\n    sudo find $CATALINA_HOME/logs -maxdepth 0 \\\\( ! -user tomcat \\\\) | sudo xargs chown tomcat\r\n    sudo find $CATALINA_HOME/logs -maxdepth 0 \\\\( ! -group tomcat \\\\) | sudo xargs chgrp tomcat\"\r\n\r\n    tomcat_log_dir = file(\"$CATALINA_HOME/logs\")\r\n    desribe tomcat_log_dir do \r\n        its('owner') { should cmp 'tomcat' }\r\n        its('group') { should cmp 'tomcat' }\r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001250.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001250.rb:1 ",
                      "run_time":0.012762834,
                      "start_time":"2020-06-17T00:47:14+00:00",
                      "message":"undefined method `desribe' for #<Inspec::Rule:0x0000000004718de8>\nDid you mean?  describe",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001260",
                "title":"$CATALINA_HOME/temp/ folder must be owned by tomcat user, group tomcat.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root \n    with group Tomcat. While root has read/write privileges, group only has read permissions, and world has no permissions. \n    The exceptions are the logs, temp, and work directories that are owned by the Tomcat user rather than root. This means that \n    even if an attacker compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, \n    or modify existing web applications. The Tomcat process runs with a umask of 007 to maintain these permissions.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root \n    with group Tomcat. While root has read/write privileges, group only has read permissions, and world has no permissions. \n    The exceptions are the logs, temp, and work directories that are owned by the Tomcat user rather than root. This means that \n    even if an attacker compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, \n    or modify existing web applications. The Tomcat process runs with a umask of 007 to maintain these permissions."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000380-AS-000088",
                   "gid":"TCAT-AS-001260",
                   "rid":"TCAT-AS-001260_rule",
                   "stig_id":"TCAT-AS-001260",
                   "cci":"CCI-001813",
                   "nist":[
                      "CM-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/temp -follow -maxdepth 0 \\(  ! -user tomcat -o ! -group tomcat \\) -ls\n    If no folders are displayed, this is not a finding.\n    If results indicate the $CATALINA_HOME/temp folder ownership and group membership is not set to tomcat:tomcat, this is a finding.",
                   "fix":"Run the following commands on the Tomcat server:\n    sudo find $CATALINA_HOME/temp -maxdepth 0 \\( ! -user tomcat \\) | sudo xargs chown tomcat\n    sudo find $CATALINA_HOME/temp -maxdepth 0 \\( ! -group tomcat \\) | sudo xargs chgrp tomcat"
                },
                "code":"control \"TCAT-AS-001260\" do\r\n    title \"$CATALINA_HOME/temp/ folder must be owned by tomcat user, group tomcat.\"\r\n    desc  \"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root \r\n    with group Tomcat. While root has read/write privileges, group only has read permissions, and world has no permissions. \r\n    The exceptions are the logs, temp, and work directories that are owned by the Tomcat user rather than root. This means that \r\n    even if an attacker compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, \r\n    or modify existing web applications. The Tomcat process runs with a umask of 007 to maintain these permissions.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000380-AS-000088\"\r\n    tag \"gid\": \"TCAT-AS-001260\"\r\n    tag \"rid\": \"TCAT-AS-001260_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001260\"\r\n    tag \"cci\": \"CCI-001813\"\r\n    tag \"nist\": [\"CM-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/temp -follow -maxdepth 0 \\\\(  ! -user tomcat -o ! -group tomcat \\\\) -ls\r\n    If no folders are displayed, this is not a finding.\r\n    If results indicate the $CATALINA_HOME/temp folder ownership and group membership is not set to tomcat:tomcat, this is a finding.\"\r\n    tag \"fix\": \"Run the following commands on the Tomcat server:\r\n    sudo find $CATALINA_HOME/temp -maxdepth 0 \\\\( ! -user tomcat \\\\) | sudo xargs chown tomcat\r\n    sudo find $CATALINA_HOME/temp -maxdepth 0 \\\\( ! -group tomcat \\\\) | sudo xargs chgrp tomcat\"\r\n    \r\n    tomcat_temp_dir = file(\"$CATALINA_HOME/temp\")\r\n    desribe tomcat_temp_dir do \r\n        its('owner') { should cmp 'tomcat' }\r\n        its('group') { should cmp 'tomcat' }\r\n    end \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001260.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001260.rb:1 ",
                      "run_time":0.004677806,
                      "start_time":"2020-06-17T00:47:14+00:00",
                      "message":"undefined method `desribe' for #<Inspec::Rule:0x0000000004742b48>\nDid you mean?  describe",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001270",
                "title":"$CATALINA_HOME/temp folder permissions must be set to 750.",
                "desc":"Tomcat's file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root \n    with the group Tomcat. While root has read/write privileges, tomcat group only has read and world has no permissions. \n    The exceptions are the logs, temp and work directory that are owned by the Tomcat user rather than root. This means that even \n    if an attacker compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, \n    or modify existing web applications. The Tomcat process runs with a umask of 007 to maintain these permissions.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat's file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root \n    with the group Tomcat. While root has read/write privileges, tomcat group only has read and world has no permissions. \n    The exceptions are the logs, temp and work directory that are owned by the Tomcat user rather than root. This means that even \n    if an attacker compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, \n    or modify existing web applications. The Tomcat process runs with a umask of 007 to maintain these permissions."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000380-AS-000088",
                   "gid":"TCAT-AS-001270",
                   "rid":"TCAT-AS-001270_rule",
                   "stig_id":"TCAT-AS-001270",
                   "cci":"CCI-001813",
                   "nist":[
                      "CM-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/temp -follow -maxdepth 0 -type d \\( \\! -perm 750 \\) -ls\n    If no folders are displayed, this is not a finding.\n    If results indicate the $CATALINA_HOME/temp folder permissions are not set to 750, this is a finding.",
                   "fix":"Run the following commands on the Tomcat server:\n    sudo find  $CATALINA_HOME/temp -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/temp"
                },
                "code":"control \"TCAT-AS-001270\" do\r\n    title \"$CATALINA_HOME/temp folder permissions must be set to 750.\"\r\n    desc  \"Tomcat's file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root \r\n    with the group Tomcat. While root has read/write privileges, tomcat group only has read and world has no permissions. \r\n    The exceptions are the logs, temp and work directory that are owned by the Tomcat user rather than root. This means that even \r\n    if an attacker compromises the Tomcat process, they cannot change the Tomcat configuration, deploy new web applications, \r\n    or modify existing web applications. The Tomcat process runs with a umask of 007 to maintain these permissions.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000380-AS-000088\"\r\n    tag \"gid\": \"TCAT-AS-001270\"\r\n    tag \"rid\": \"TCAT-AS-001270_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001270\"\r\n    tag \"cci\": \"CCI-001813\"\r\n    tag \"nist\": [\"CM-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/temp -follow -maxdepth 0 -type d \\\\( \\\\! -perm 750 \\\\) -ls\r\n    If no folders are displayed, this is not a finding.\r\n    If results indicate the $CATALINA_HOME/temp folder permissions are not set to 750, this is a finding.\"\r\n    tag \"fix\": \"Run the following commands on the Tomcat server:\r\n    sudo find  $CATALINA_HOME/temp -follow -maxdepth 0 -type d -print0 | sudo xargs chmod 750 $CATALINA_HOME/temp\"\r\n    \r\n    tomcat_temp_dir = file(\"$CATALINA_HOME/temp\")\r\n    describe tomcat_temp_dir do \r\n        its(\"mode\") { should cmp \"750\" }\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001270.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"File $CATALINA_HOME/temp mode is expected to cmp == \"750\"",
                      "run_time":0.276344203,
                      "start_time":"2020-06-17T00:47:14+00:00",
                      "message":"\nexpected: 750\n     got: \n\n(compared using `cmp` matcher)\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-001280",
                "title":"$CATALINA_HOME/work/ folder must be owned by tomcat user, group tomcat.",
                "desc":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root with group Tomcat. \n    While root has read/write privileges, group only has read permissions, and world has no permissions. The exceptions are the logs, temp, \n    and work directories that are owned by the Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, \n    they cannot change the Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat process runs with a \n    umask of 007 to maintain these permissions.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root with group Tomcat. \n    While root has read/write privileges, group only has read permissions, and world has no permissions. The exceptions are the logs, temp, \n    and work directories that are owned by the Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, \n    they cannot change the Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat process runs with a \n    umask of 007 to maintain these permissions."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000380-AS-000088",
                   "gid":"TCAT-AS-001280",
                   "rid":"TCAT-AS-001280_rule",
                   "stig_id":"TCAT-AS-001280",
                   "cci":"CCI-001813",
                   "nist":[
                      "CM-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Access the Tomcat server from the command line and execute the following OS command:\n    sudo find $CATALINA_HOME/work -follow -maxdepth 0 \\(  ! -user tomcat -o ! -group tomcat \\) -ls\n    If no folders are displayed, this is not a finding.\n    If results indicate the $CATALINA_HOME/work folder ownership and group membership is not set to tomcat:tomcat, this is a finding.",
                   "fix":"Run the following commands on the Tomcat server:\n    sudo find $CATALINA_HOME/work -maxdepth 0 \\( ! -user tomcat \\) | sudo xargs chown tomcat\n    sudo find $CATALINA_HOME/work -maxdepth 0 \\( ! -group tomcat \\) | sudo xargs chgrp tomcat"
                },
                "code":"control \"TCAT-AS-001280\" do\r\n    title \"$CATALINA_HOME/work/ folder must be owned by tomcat user, group tomcat.\"\r\n    desc  \"Tomcat file permissions must be restricted. The standard configuration is to have all Tomcat files owned by root with group Tomcat. \r\n    While root has read/write privileges, group only has read permissions, and world has no permissions. The exceptions are the logs, temp, \r\n    and work directories that are owned by the Tomcat user rather than root. This means that even if an attacker compromises the Tomcat process, \r\n    they cannot change the Tomcat configuration, deploy new web applications, or modify existing web applications. The Tomcat process runs with a \r\n    umask of 007 to maintain these permissions.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000380-AS-000088\"\r\n    tag \"gid\": \"TCAT-AS-001280\"\r\n    tag \"rid\": \"TCAT-AS-001280_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001280\"\r\n    tag \"cci\": \"CCI-001813\"\r\n    tag \"nist\": [\"CM-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Access the Tomcat server from the command line and execute the following OS command:\r\n    sudo find $CATALINA_HOME/work -follow -maxdepth 0 \\\\(  ! -user tomcat -o ! -group tomcat \\\\) -ls\r\n    If no folders are displayed, this is not a finding.\r\n    If results indicate the $CATALINA_HOME/work folder ownership and group membership is not set to tomcat:tomcat, this is a finding.\"\r\n    tag \"fix\": \"Run the following commands on the Tomcat server:\r\n    sudo find $CATALINA_HOME/work -maxdepth 0 \\\\( ! -user tomcat \\\\) | sudo xargs chown tomcat\r\n    sudo find $CATALINA_HOME/work -maxdepth 0 \\\\( ! -group tomcat \\\\) | sudo xargs chgrp tomcat\"\r\n    \r\n    tomcat_work_dir = file(\"$CATALINA_HOME/work\")\r\n    desribe tomcat_work_dir do \r\n        its('owner') { should cmp 'tomcat' }\r\n        its('group') { should cmp 'tomcat' }\r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001280.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001280.rb:1 ",
                      "run_time":0.014394266,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `desribe' for #<Inspec::Rule:0x0000000004fe3770>\nDid you mean?  describe",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001290",
                "title":"AccessLogValve must be configured for Catalina engine.",
                "desc":"The <Engine> container represents the entire request processing machinery associated with a particular Catalina Service. \n    It receives and processes all requests from one or more Connectors, and returns the completed response to the Connector for \n    transmission back to the client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element \n    MUST be nested inside a Service element, following all of the corresponding Connector elements associated with the Service.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The <Engine> container represents the entire request processing machinery associated with a particular Catalina Service. \n    It receives and processes all requests from one or more Connectors, and returns the completed response to the Connector for \n    transmission back to the client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element \n    MUST be nested inside a Service element, following all of the corresponding Connector elements associated with the Service."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000381-AS-000089",
                   "gid":"TCAT-AS-001290",
                   "rid":"TCAT-AS-001290_rule",
                   "stig_id":"TCAT-AS-001290",
                   "cci":"CCI-001814",
                   "nist":[
                      "CM-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\n    Review the <Engine> element. Ensure one AccessLog <Valve> element is nested within the Engine element. \n    If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> element is not defined, this is a finding.\n    EXAMPLE:\n    <Engine name=\"Standalone\" ...>\n      ...\n      <Valve className=\"org.apache.catalina.valves.AccessLogValve\"\n            prefix=\"catalina_access_log\" suffix=\".txt\"\n            pattern=\"common\"/>\n      ...\n    </Engine>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME\u000fnf erver.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001290\" do\r\n    title \"AccessLogValve must be configured for Catalina engine.\"\r\n    desc  \"The <Engine> container represents the entire request processing machinery associated with a particular Catalina Service. \r\n    It receives and processes all requests from one or more Connectors, and returns the completed response to the Connector for \r\n    transmission back to the client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element \r\n    MUST be nested inside a Service element, following all of the corresponding Connector elements associated with the Service.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000381-AS-000089\"\r\n    tag \"gid\": \"TCAT-AS-001290\"\r\n    tag \"rid\": \"TCAT-AS-001290_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001290\"\r\n    tag \"cci\": \"CCI-001814\"\r\n    tag \"nist\": [\"CM-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\\\conf\\\\server.xml file.\r\n    Review the <Engine> element. Ensure one AccessLog <Valve> element is nested within the Engine element. \r\n    If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> element is not defined, this is a finding.\r\n    EXAMPLE:\r\n    <Engine name=\\\"Standalone\\\" ...>\r\n      ...\r\n      <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\"\r\n            prefix=\\\"catalina_access_log\\\" suffix=\\\".txt\\\"\r\n            pattern=\\\"common\\\"/>\r\n      ...\r\n    </Engine>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    valves = tomcat_server_file[\"//Valve/@className\"]\r\n    describe valves do \r\n      it { should include \"org.apache.catalina.valves.AccessLogValve\" }\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001290.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001290.rb:1 ",
                      "run_time":0.002863621,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001300",
                "title":"Idle timeout for management application must be set to 10 minutes.",
                "desc":"Tomcat can set idle session timeouts on a per-application basis. The management application is provided with \n    the Tomcat installation and is used to manage the applications that are installed on the Tomcat Server. Setting the \n    idle timeout for the management application will kill the admin user's session after 10 minutes of inactivity. \n    This will limit the opportunity for unauthorized persons to hijack the admin session. This setting will also affect \n    the default timeout behavior of all hosted web applications. To adjust the individual hosted application settings \n    that are not related to management of the system, modify the individual application web.xml file if application \n    timeout requirements differ from the STIG.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat can set idle session timeouts on a per-application basis. The management application is provided with \n    the Tomcat installation and is used to manage the applications that are installed on the Tomcat Server. Setting the \n    idle timeout for the management application will kill the admin user's session after 10 minutes of inactivity. \n    This will limit the opportunity for unauthorized persons to hijack the admin session. This setting will also affect \n    the default timeout behavior of all hosted web applications. To adjust the individual hosted application settings \n    that are not related to management of the system, modify the individual application web.xml file if application \n    timeout requirements differ from the STIG."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000389-AS-000253",
                   "gid":"TCAT-AS-001300",
                   "rid":"TCAT-AS-001300_rule",
                   "stig_id":"TCAT-AS-001300",
                   "cci":"CCI-002038",
                   "nist":[
                      "IA-11",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"If manager and host-manager applications have been deleted from the system, this is not a finding. \n    From the Tomcat server as a privileged user, run the following commands:\n    sudo grep -i session-timeout $CATALINA_HOME/webapps/manager/META-INF/web.xml \n    sudo grep -i session-timeout \n    $CATALINA_HOME/conf/web.xml\n    If the session-timeout setting is not configured to be 10 minutes in at least one of these files, this is a finding.",
                   "fix":"If the manager and host-manager applications have been deleted from the system, this is not a finding. \n    From the Tomcat server as a privileged user:\n    To affect session timeout for all applications including the management application, edit the $CATALINA_HOME/conf/web.xml file.\n    To affect session timeout for the management application only, edit the $CATALINA_HOME/webapps/manager/META-INF/web.xml file. \n    Locate the session-timeout setting located within the session-config element.\n    Modify the session-timeout setting to be 10 minutes.\n    Save the file.\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001300\" do\r\n    title \"Idle timeout for management application must be set to 10 minutes.\"\r\n    desc  \"Tomcat can set idle session timeouts on a per-application basis. The management application is provided with \r\n    the Tomcat installation and is used to manage the applications that are installed on the Tomcat Server. Setting the \r\n    idle timeout for the management application will kill the admin user's session after 10 minutes of inactivity. \r\n    This will limit the opportunity for unauthorized persons to hijack the admin session. This setting will also affect \r\n    the default timeout behavior of all hosted web applications. To adjust the individual hosted application settings \r\n    that are not related to management of the system, modify the individual application web.xml file if application \r\n    timeout requirements differ from the STIG.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000389-AS-000253\"\r\n    tag \"gid\": \"TCAT-AS-001300\"\r\n    tag \"rid\": \"TCAT-AS-001300_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001300\"\r\n    tag \"cci\": \"CCI-002038\"\r\n    tag \"nist\": [\"IA-11\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"If manager and host-manager applications have been deleted from the system, this is not a finding. \r\n    From the Tomcat server as a privileged user, run the following commands:\r\n    sudo grep -i session-timeout $CATALINA_HOME/webapps/manager/META-INF/web.xml \r\n    sudo grep -i session-timeout \r\n    $CATALINA_HOME/conf/web.xml\r\n    If the session-timeout setting is not configured to be 10 minutes in at least one of these files, this is a finding.\"\r\n    tag \"fix\": \"If the manager and host-manager applications have been deleted from the system, this is not a finding. \r\n    From the Tomcat server as a privileged user:\r\n    To affect session timeout for all applications including the management application, edit the $CATALINA_HOME/conf/web.xml file.\r\n    To affect session timeout for the management application only, edit the $CATALINA_HOME/webapps/manager/META-INF/web.xml file. \r\n    Locate the session-timeout setting located within the session-config element.\r\n    Modify the session-timeout setting to be 10 minutes.\r\n    Save the file.\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_web_files = [\"$CATALINA_HOME/conf/web.xml\", \"$CATALINA_HOME/webapps/manager/META-INF/web.xml\"]\r\n    tomcat_web_files.each do |web_file|\r\n        if file(web_file).exist?\r\n            describe xml(web_file)[\"//session-timeout\"] do \r\n                it { should cmp \"10\" }\r\n            end\r\n        end\r\n    end\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001300.rb"
                },
                "waiver_data":{
 
                },
                "results":[
 
                ]
             },
             {
                "id":"TCAT-AS-001320",
                "title":"Multi factor certificate-based tokens (CAC) must be used when accessing the management interface.",
                "desc":"Password authentication does not provide sufficient security control when accessing a management \n    interface. DoD has specified that the CAC will be used when authenticating and passwords will only be used \n    when CAC authentication is not a plausible solution. Tomcat provides the ability to do certificate based \n    authentication and client authentication, therefore the Tomcat server must be configured to use CAC.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Password authentication does not provide sufficient security control when accessing a management \n    interface. DoD has specified that the CAC will be used when authenticating and passwords will only be used \n    when CAC authentication is not a plausible solution. Tomcat provides the ability to do certificate based \n    authentication and client authentication, therefore the Tomcat server must be configured to use CAC."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000391-AS-000239",
                   "gid":"TCAT-AS-001320",
                   "rid":"TCAT-AS-001320_rule",
                   "stig_id":"TCAT-AS-001320",
                   "cci":"CCI-001953",
                   "nist":[
                      "IA-2",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"If the manager application has been deleted from the Tomcat server, this is not a finding. From the Tomcat server \n    as a privileged user, issue the following command:\n    sudo grep -i auth-method $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\n    If the <Auth-Method> for the web manager application is not set to CLIENT-CERT, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/webapps/manager/WEB-INF/web.xml file and modify \n    the auth-method for the manager application security constraint.\n    sudo nano $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\n    Locate <auth-method> contained within the <login-config> section, modify <auth-method> to specify CLIENT-CERT. \n    EXAMPLE:\n    <auth-method>CLIENT-CERT</auth-method>\n    In addition, the connector used for accessing the manager application must be configured to require client authentication by setting \n    clientAuth=\"true\" and the manager application roles must be configured in the LDAP server.\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat"
                },
                "code":"control \"TCAT-AS-001320\" do\r\n    title \"Multi factor certificate-based tokens (CAC) must be used when accessing the management interface.\"\r\n    desc  \"Password authentication does not provide sufficient security control when accessing a management \r\n    interface. DoD has specified that the CAC will be used when authenticating and passwords will only be used \r\n    when CAC authentication is not a plausible solution. Tomcat provides the ability to do certificate based \r\n    authentication and client authentication, therefore the Tomcat server must be configured to use CAC.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000391-AS-000239\"\r\n    tag \"gid\": \"TCAT-AS-001320\"\r\n    tag \"rid\": \"TCAT-AS-001320_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001320\"\r\n    tag \"cci\": \"CCI-001953\"\r\n    tag \"nist\": [\"IA-2\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"If the manager application has been deleted from the Tomcat server, this is not a finding. From the Tomcat server \r\n    as a privileged user, issue the following command:\r\n    sudo grep -i auth-method $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\r\n    If the <Auth-Method> for the web manager application is not set to CLIENT-CERT, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/webapps/manager/WEB-INF/web.xml file and modify \r\n    the auth-method for the manager application security constraint.\r\n    sudo nano $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\r\n    Locate <auth-method> contained within the <login-config> section, modify <auth-method> to specify CLIENT-CERT. \r\n    EXAMPLE:\r\n    <auth-method>CLIENT-CERT</auth-method>\r\n    In addition, the connector used for accessing the manager application must be configured to require client authentication by setting \r\n    clientAuth=\\\"true\\\" and the manager application roles must be configured in the LDAP server.\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\"\r\n    \r\n    tomcat_manager_web_file = \"$CATALINA_HOME/webapps/manager/WEB-INF/web.xml\"\r\n    \r\n    only_if('Manager application is not installed. Skipping this check.') do \r\n        file(tomcat_manager_web_file).exist?\r\n    end\r\n\r\n    describe xml(tomcat_manager_web_file)[\"//auth-method\"] do\r\n        it { should cmp \"CLIENT-CERT\" } \r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001320.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"No-op",
                      "run_time":6.71e-06,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "resource":"No-op",
                      "skip_message":"Skipped control due to only_if condition: Manager application is not installed. Skipping this check."
                   }
                ]
             },
             {
                "id":"TCAT-AS-001330",
                "title":"Multi factor certificate-based tokens (CAC) must be used when accessing the management interface.",
                "desc":"Password authentication does not provide sufficient security control when accessing a management interface. \n    DoD has specified that the CAC will be used when authenticating and passwords will only be used when CAC authentication \n    is not a plausible solution. Tomcat provides the ability to do certificate-based authentication and client authentication, \n    therefore the Tomcat server must be configured to use CAC.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Password authentication does not provide sufficient security control when accessing a management interface. \n    DoD has specified that the CAC will be used when authenticating and passwords will only be used when CAC authentication \n    is not a plausible solution. Tomcat provides the ability to do certificate-based authentication and client authentication, \n    therefore the Tomcat server must be configured to use CAC."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000392-AS-000240",
                   "gid":"TCAT-AS-001330",
                   "rid":"TCAT-AS-001330_rule",
                   "stig_id":"TCAT-AS-001330",
                   "cci":"CCI-001954",
                   "nist":[
                      "IA-2",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"If the manager application has been deleted from the Tomcat server, this is not a finding. \n    From the Tomcat server as a privileged user, issue the following command:\n    sudo grep -i auth-method $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\n    If the <Auth-Method> for the web manager application is not set to CLIENT-CERT, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/webapps/manager/WEB-INF/web.xml file and modify \n    the auth-method for the manager application security constraint.\n    sudo nano $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\n    Locate <auth-method> contained within the <login-config> section, modify <auth-method> to specify CLIENT-CERT.\n    EXAMPLE:\n    <auth-method>CLIENT-CERT</auth-method>\n    In addition, the connector used for accessing the manager application must be configured to require client authentication \n    by setting clientAuth=\"true\" and the manager application roles must be configured in the LDAP server.\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat"
                },
                "code":"control \"TCAT-AS-001330\" do\r\n    title \"Multi factor certificate-based tokens (CAC) must be used when accessing the management interface.\"\r\n    desc  \"Password authentication does not provide sufficient security control when accessing a management interface. \r\n    DoD has specified that the CAC will be used when authenticating and passwords will only be used when CAC authentication \r\n    is not a plausible solution. Tomcat provides the ability to do certificate-based authentication and client authentication, \r\n    therefore the Tomcat server must be configured to use CAC.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000392-AS-000240\"\r\n    tag \"gid\": \"TCAT-AS-001330\"\r\n    tag \"rid\": \"TCAT-AS-001330_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001330\"\r\n    tag \"cci\": \"CCI-001954\"\r\n    tag \"nist\": [\"IA-2\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"If the manager application has been deleted from the Tomcat server, this is not a finding. \r\n    From the Tomcat server as a privileged user, issue the following command:\r\n    sudo grep -i auth-method $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\r\n    If the <Auth-Method> for the web manager application is not set to CLIENT-CERT, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/webapps/manager/WEB-INF/web.xml file and modify \r\n    the auth-method for the manager application security constraint.\r\n    sudo nano $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\r\n    Locate <auth-method> contained within the <login-config> section, modify <auth-method> to specify CLIENT-CERT.\r\n    EXAMPLE:\r\n    <auth-method>CLIENT-CERT</auth-method>\r\n    In addition, the connector used for accessing the manager application must be configured to require client authentication \r\n    by setting clientAuth=\\\"true\\\" and the manager application roles must be configured in the LDAP server.\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\"\r\n\r\n    tomcat_manager_web_file = \"$CATALINA_HOME/webapps/manager/WEB-INF/web.xml\"\r\n    \r\n    only_if('Manager application is not installed. Skipping this check.') do \r\n        file(tomcat_manager_web_file).exist?\r\n    end\r\n\r\n    describe xml(tomcat_manager_web_file)[\"//auth-method\"] do\r\n        it { should cmp \"CLIENT-CERT\" } \r\n    end \r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001330.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"No-op",
                      "run_time":4.564e-06,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "resource":"No-op",
                      "skip_message":"Skipped control due to only_if condition: Manager application is not installed. Skipping this check."
                   }
                ]
             },
             {
                "id":"TCAT-AS-001380",
                "title":"Multifactor certificate-based tokens (CAC) must be used when accessing the management interface.",
                "desc":"Password authentication does not provide sufficient security control when accessing a management interface. \n    DoD has specified that the CAC will be used when authenticating and passwords will only be used when CAC authentication \n    is not a plausible solution. Tomcat provides the ability to do certificate-based authentication and client authentication, \n    therefore the Tomcat server must be configured to use CAC.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Password authentication does not provide sufficient security control when accessing a management interface. \n    DoD has specified that the CAC will be used when authenticating and passwords will only be used when CAC authentication \n    is not a plausible solution. Tomcat provides the ability to do certificate-based authentication and client authentication, \n    therefore the Tomcat server must be configured to use CAC."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000402-AS-000247",
                   "gid":"TCAT-AS-001380",
                   "rid":"TCAT-AS-001380_rule",
                   "stig_id":"TCAT-AS-001380",
                   "cci":"CCI-002009",
                   "nist":[
                      "IA-8",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"If the manager application has been deleted from the Tomcat server, this is not a finding. \n    From the Tomcat server as a privileged user, issue the following command:\n    sudo grep -i auth-method $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\n    If the <Auth-Method> for the web manager application is not set to CLIENT-CERT, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/webapps/manager/WEB-INF/web.xml \n    file and modify the auth-method for the manager application security constraint.\n    sudo nano $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\n    Locate <auth-method> contained within the <login-config> section, modify <auth-method> to specify CLIENT-CERT.  \n    EXAMPLE:\n    <auth-method>CLIENT-CERT</auth-method>\n    In addition, the connector used for accessing the manager application must be configured to require client authentication by \n    setting clientAuth=\"true\" and the manager application roles must be configured in the LDAP server.\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat"
                },
                "code":"control \"TCAT-AS-001380\" do\r\n    title \"Multifactor certificate-based tokens (CAC) must be used when accessing the management interface.\"\r\n    desc  \"Password authentication does not provide sufficient security control when accessing a management interface. \r\n    DoD has specified that the CAC will be used when authenticating and passwords will only be used when CAC authentication \r\n    is not a plausible solution. Tomcat provides the ability to do certificate-based authentication and client authentication, \r\n    therefore the Tomcat server must be configured to use CAC.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000402-AS-000247\"\r\n    tag \"gid\": \"TCAT-AS-001380\"\r\n    tag \"rid\": \"TCAT-AS-001380_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001380\"\r\n    tag \"cci\": \"CCI-002009\"\r\n    tag \"nist\": [\"IA-8\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"If the manager application has been deleted from the Tomcat server, this is not a finding. \r\n    From the Tomcat server as a privileged user, issue the following command:\r\n    sudo grep -i auth-method $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\r\n    If the <Auth-Method> for the web manager application is not set to CLIENT-CERT, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/webapps/manager/WEB-INF/web.xml \r\n    file and modify the auth-method for the manager application security constraint.\r\n    sudo nano $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\r\n    Locate <auth-method> contained within the <login-config> section, modify <auth-method> to specify CLIENT-CERT.  \r\n    EXAMPLE:\r\n    <auth-method>CLIENT-CERT</auth-method>\r\n    In addition, the connector used for accessing the manager application must be configured to require client authentication by \r\n    setting clientAuth=\\\"true\\\" and the manager application roles must be configured in the LDAP server.\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\"\r\n        \r\n    tomcat_manager_web_file = \"$CATALINA_HOME/webapps/manager/WEB-INF/web.xml\"\r\n \r\n    only_if('Manager application is not installed. Skipping this check.') do \r\n        file(tomcat_manager_web_file).exist?\r\n    end\r\n\r\n    describe xml(tomcat_manager_web_file)[\"//auth-method\"] do\r\n        it { should cmp \"CLIENT-CERT\" } \r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001380.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"No-op",
                      "run_time":4.619e-06,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "resource":"No-op",
                      "skip_message":"Skipped control due to only_if condition: Manager application is not installed. Skipping this check."
                   }
                ]
             },
             {
                "id":"TCAT-AS-001390",
                "title":"Multifactor certificate-based tokens (CAC) must be used when accessing the management interface.",
                "desc":"Password authentication does not provide sufficient security control when accessing a management interface. \n    DoD has specified that the CAC will be used when authenticating and passwords will only be used when CAC authentication \n    is not a plausible solution. Tomcat provides the ability to do certificate-based authentication and client authentication, \n    therefore the Tomcat server must be configured to use CAC.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Password authentication does not provide sufficient security control when accessing a management interface. \n    DoD has specified that the CAC will be used when authenticating and passwords will only be used when CAC authentication \n    is not a plausible solution. Tomcat provides the ability to do certificate-based authentication and client authentication, \n    therefore the Tomcat server must be configured to use CAC."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000403-AS-000248",
                   "gid":"TCAT-AS-001390",
                   "rid":"TCAT-AS-001390_rule",
                   "stig_id":"TCAT-AS-001390",
                   "cci":"CCI-002010",
                   "nist":[
                      "IA-8",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"If the manager application has been deleted from the Tomcat server, this is not a finding. \n    From the Tomcat server as a privileged user, issue the following command:\n    sudo grep -i auth-method $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\n    If the <Auth-Method> for the web manager application is not set to CLIENT-CERT, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/webapps/manager/WEB-INF/web.xml file and modify \n    the auth-method for the manager application security constraint.\n    sudo nano $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\n    Locate <auth-method> contained within the <login-config> section, modify <auth-method> to specify CLIENT-CERT.\n    EXAMPLE:\n    <auth-method>CLIENT-CERT</auth-method>\n    In addition, the connector used for accessing the manager application must be configured to require client authentication \n    by setting clientAuth=\"true\" and the manager application roles must be configured in the LDAP server.\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat"
                },
                "code":"control \"TCAT-AS-001390\" do\r\n    title \"Multifactor certificate-based tokens (CAC) must be used when accessing the management interface.\"\r\n    desc  \"Password authentication does not provide sufficient security control when accessing a management interface. \r\n    DoD has specified that the CAC will be used when authenticating and passwords will only be used when CAC authentication \r\n    is not a plausible solution. Tomcat provides the ability to do certificate-based authentication and client authentication, \r\n    therefore the Tomcat server must be configured to use CAC.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000403-AS-000248\"\r\n    tag \"gid\": \"TCAT-AS-001390\"\r\n    tag \"rid\": \"TCAT-AS-001390_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001390\"\r\n    tag \"cci\": \"CCI-002010\"\r\n    tag \"nist\": [\"IA-8\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"If the manager application has been deleted from the Tomcat server, this is not a finding. \r\n    From the Tomcat server as a privileged user, issue the following command:\r\n    sudo grep -i auth-method $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\r\n    If the <Auth-Method> for the web manager application is not set to CLIENT-CERT, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, edit the $CATALINA_HOME/webapps/manager/WEB-INF/web.xml file and modify \r\n    the auth-method for the manager application security constraint.\r\n    sudo nano $CATALINA_HOME/webapps/manager/WEB-INF/web.xml\r\n    Locate <auth-method> contained within the <login-config> section, modify <auth-method> to specify CLIENT-CERT.\r\n    EXAMPLE:\r\n    <auth-method>CLIENT-CERT</auth-method>\r\n    In addition, the connector used for accessing the manager application must be configured to require client authentication \r\n    by setting clientAuth=\\\"true\\\" and the manager application roles must be configured in the LDAP server.\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\"\r\n\r\n    tomcat_manager_web_file = \"$CATALINA_HOME/webapps/manager/WEB-INF/web.xml\"\r\n \r\n    only_if('Manager application is not installed. Skipping this check.') do \r\n        file(tomcat_manager_web_file).exist?\r\n    end\r\n\r\n    describe xml(tomcat_manager_web_file)[\"//auth-method\"] do\r\n        it { should cmp \"CLIENT-CERT\" } \r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001390.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"No-op",
                      "run_time":4.125e-06,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "resource":"No-op",
                      "skip_message":"Skipped control due to only_if condition: Manager application is not installed. Skipping this check."
                   }
                ]
             },
             {
                "id":"TCAT-AS-001430",
                "title":"Certificates in the trust store must be issued/signed by an approved CA.",
                "desc":"Use of self-signed certificates creates a lack of integrity and invalidates the certificate based \n    authentication trust model. Certificates used by production systems must be issued/signed by a trusted Root CA and cannot \n    be self-signed. For systems that communicate with industry partners, the DoD ECA program supports the issuance of DoD-approved \n    certificates to industry partners. For information on the DoD ECA program, refer to the DoD PKI office. Links to their site are \n    available on https://public.cyber.mil.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Use of self-signed certificates creates a lack of integrity and invalidates the certificate based \n    authentication trust model. Certificates used by production systems must be issued/signed by a trusted Root CA and cannot \n    be self-signed. For systems that communicate with industry partners, the DoD ECA program supports the issuance of DoD-approved \n    certificates to industry partners. For information on the DoD ECA program, refer to the DoD PKI office. Links to their site are \n    available on https://public.cyber.mil."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000427-AS-000264",
                   "gid":"TCAT-AS-001430",
                   "rid":"TCAT-AS-001430_rule",
                   "stig_id":"TCAT-AS-001430",
                   "cci":"CCI-002470",
                   "nist":[
                      "SC-23",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"For the systemd Ubuntu OS, check the tomcat.service file to read the content of the JAVA_OPTS environment variable setting.\n    sudo cat /etc/systemd/system/tomcat.service |grep -i truststore\n    EXAMPLE output:\n    set JAVA_OPTS=\"-Djavax.net.ssl.trustStore=/path/to/truststore\" \"-Djavax.net.ssl.trustStorePassword=************\"\n    If the variable is not set, use the default location command below. If the variable is set, use the alternate location \n    command below and include the path and truststore file. \n    -Default location:\n    keytool -list -cacerts -v | grep -i issuer\n    -Alternate location:\n    keytool -list -keystore <location of trust store file> -v |grep -i issuer\n    If there are no CA certificates issued by a Certificate Authority (CA) that is part of the DoD PKI/PKE, this is a finding.",
                   "fix":"Obtain and install the DoD PKI CA certificate bundles by accessing the DoD PKI office web site at https://cyber.mil/pki-pke.\n    Download the certificate bundles and then use certificate management utilities such as \n    keytool or openssl to import the DoD CA certificates into the trust store."
                },
                "code":"control \"TCAT-AS-001430\" do\r\n    title \"Certificates in the trust store must be issued/signed by an approved CA.\"\r\n    desc  \"Use of self-signed certificates creates a lack of integrity and invalidates the certificate based \r\n    authentication trust model. Certificates used by production systems must be issued/signed by a trusted Root CA and cannot \r\n    be self-signed. For systems that communicate with industry partners, the DoD ECA program supports the issuance of DoD-approved \r\n    certificates to industry partners. For information on the DoD ECA program, refer to the DoD PKI office. Links to their site are \r\n    available on https://public.cyber.mil.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000427-AS-000264\"\r\n    tag \"gid\": \"TCAT-AS-001430\"\r\n    tag \"rid\": \"TCAT-AS-001430_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001430\"\r\n    tag \"cci\": \"CCI-002470\"\r\n    tag \"nist\": [\"SC-23\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"For the systemd Ubuntu OS, check the tomcat.service file to read the content of the JAVA_OPTS environment variable setting.\r\n    sudo cat /etc/systemd/system/tomcat.service |grep -i truststore\r\n    EXAMPLE output:\r\n    set JAVA_OPTS=\\\"-Djavax.net.ssl.trustStore=/path/to/truststore\\\" \\\"-Djavax.net.ssl.trustStorePassword=************\\\"\r\n    If the variable is not set, use the default location command below. If the variable is set, use the alternate location \r\n    command below and include the path and truststore file. \r\n    -Default location:\r\n    keytool -list -cacerts -v | grep -i issuer\r\n    -Alternate location:\r\n    keytool -list -keystore <location of trust store file> -v |grep -i issuer\r\n    If there are no CA certificates issued by a Certificate Authority (CA) that is part of the DoD PKI/PKE, this is a finding.\"\r\n    tag \"fix\": \"Obtain and install the DoD PKI CA certificate bundles by accessing the DoD PKI office web site at https://cyber.mil/pki-pke.\r\n    Download the certificate bundles and then use certificate management utilities such as \r\n    keytool or openssl to import the DoD CA certificates into the trust store.\"\r\n    \r\n\r\n    describe \"This is a manual check\" do \r\n        skip \"Check the trustStore variable is set in the tomcat.service file. If it is not set run the \r\n        command: \\\"keytool -list -cacerts -v | grep -i issuer\\\" to set the Default Location. If the default is already set then run the \r\n        command: \\\"keytool -list -keystore <location of trust store file> -v |grep -i issuer\\\" to set the alternate location\"\r\n    end\r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001430.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":4.482e-06,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "resource":"",
                      "skip_message":"Check the trustStore variable is set in the tomcat.service file. If it is not set run the \n        command: \"keytool -list -cacerts -v | grep -i issuer\" to set the Default Location. If the default is already set then run the \n        command: \"keytool -list -keystore <location of trust store file> -v |grep -i issuer\" to set the alternate location"
                   }
                ]
             },
             {
                "id":"TCAT-AS-001440",
                "title":"Secured connectors must use FIPS 140-2-validated cipher algorithms.",
                "desc":"If approved cryptographic algorithms are not used, encryption strength cannot be assured.\n    When configuring a connector for secured communications, the user must also select an approved encryption cipher.\n    Examples include but are not limited to:\n    Symmetric Key\n    AES, Triple-DES, Escrowed Encryption Standard\n    Asymmetric Key\n    DSA, RSA, ECDSA\n    Hash Standards\n    *SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256\n    *SHA1 may be used for legacy applications only.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"If approved cryptographic algorithms are not used, encryption strength cannot be assured.\n    When configuring a connector for secured communications, the user must also select an approved encryption cipher.\n    Examples include but are not limited to:\n    Symmetric Key\n    AES, Triple-DES, Escrowed Encryption Standard\n    Asymmetric Key\n    DSA, RSA, ECDSA\n    Hash Standards\n    *SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256\n    *SHA1 may be used for legacy applications only."
                   }
                ],
                "impact":0.7,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000428-AS-000265",
                   "gid":"TCAT-AS-001440",
                   "rid":"TCAT-AS-001440_rule",
                   "stig_id":"TCAT-AS-001440",
                   "cci":"CCI-002475",
                   "nist":[
                      "SC-28",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo grep -i fipsmode $CATALINA_HOME/conf/server.xml. \n    If there are no results displayed or if FIPSMode is not set to FIPSMode=\"on\", this is a finding.",
                   "fix":"From the Tomcat server as a privileged user:\n    sudo nano $CATALINA_HOME/conf/server.xml. \n    In the <Listener/> element, locate the AprLifecycleListener, either add or modify the FIPSMode setting and set it to FIPSMode=\"on\"\n    EXAMPLE: \n    <Listener\n        className=\"org.apache.catalina.core.AprLifecycleListener\"\n        SSLEngine=\"on\"\n        FIPSMode=\"on\"\n    />\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001440\" do\r\n    title \"Secured connectors must use FIPS 140-2-validated cipher algorithms.\"\r\n    desc  \"If approved cryptographic algorithms are not used, encryption strength cannot be assured.\r\n    When configuring a connector for secured communications, the user must also select an approved encryption cipher.\r\n    Examples include but are not limited to:\r\n    Symmetric Key\r\n    AES, Triple-DES, Escrowed Encryption Standard\r\n    Asymmetric Key\r\n    DSA, RSA, ECDSA\r\n    Hash Standards\r\n    *SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256\r\n    *SHA1 may be used for legacy applications only.\"\r\n    impact 0.7\r\n    tag \"gtitle\": \"SRG-APP-000428-AS-000265\"\r\n    tag \"gid\": \"TCAT-AS-001440\"\r\n    tag \"rid\": \"TCAT-AS-001440_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001440\"\r\n    tag \"cci\": \"CCI-002475\"\r\n    tag \"nist\": [\"SC-28\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo grep -i fipsmode $CATALINA_HOME/conf/server.xml. \r\n    If there are no results displayed or if FIPSMode is not set to FIPSMode=\\\"on\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user:\r\n    sudo nano $CATALINA_HOME/conf/server.xml. \r\n    In the <Listener/> element, locate the AprLifecycleListener, either add or modify the FIPSMode setting and set it to FIPSMode=\\\"on\\\"\r\n    EXAMPLE: \r\n    <Listener\r\n        className=\\\"org.apache.catalina.core.AprLifecycleListener\\\"\r\n        SSLEngine=\\\"on\\\"\r\n        FIPSMode=\\\"on\\\"\r\n    />\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    listeners = tomcat_server_file[\"//Listener/@className\"]\r\n    \r\n    listeners.each do |listener|\r\n        if listener == \"org.apache.catalina.core.AprLifecycleListener\"\r\n            describe tomcat_server_file['//Listener/@FIPSMode'][0] do \r\n                it { should cmp \"on\" }\r\n            end \r\n        end \r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001440.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001440.rb:1 ",
                      "run_time":0.00334949,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001450",
                "title":"Secured connectors must use FIPS 140-2-validated cipher algorithms.",
                "desc":"If approved cryptographic algorithms are not used, encryption strength cannot be assured.\n    When configuring a connector for secured communications, also select an approved encryption cipher.\n    Examples include but are not limited to:\n    Symmetric Key\n    AES, Triple-DES, Escrowed Encryption Standard\n    Asymmetric Key\n    DSA, RSA, ECDSA\n    Hash Standards\n    *SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256\n    *SHA1 may be used for legacy applications only.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"If approved cryptographic algorithms are not used, encryption strength cannot be assured.\n    When configuring a connector for secured communications, also select an approved encryption cipher.\n    Examples include but are not limited to:\n    Symmetric Key\n    AES, Triple-DES, Escrowed Encryption Standard\n    Asymmetric Key\n    DSA, RSA, ECDSA\n    Hash Standards\n    *SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256\n    *SHA1 may be used for legacy applications only."
                   }
                ],
                "impact":0.7,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000429-AS-000157",
                   "gid":"TCAT-AS-001450",
                   "rid":"TCAT-AS-001450_rule",
                   "stig_id":"TCAT-AS-001450",
                   "cci":"CCI-002476",
                   "nist":[
                      "SC-28",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo grep -i fipsmode $CATALINA_HOME/conf/server.xml. \n    If there are no results displayed or if FIPSMode is not set to FIPSMode=\"on\", this is a finding.",
                   "fix":"From the Tomcat server as a privileged user:\n    sudo nano $CATALINA_HOME/conf/server.xml. \n    In the <Listener/> element, locate the AprLifecycleListener, either add or modify the FIPSMode setting and set it to FIPSMode=\"on\".\n    EXAMPLE: \n    <Listener\n        className=\"org.apache.catalina.core.AprLifecycleListener\"\n        SSLEngine=\"on\"\n        FIPSMode=\"on\"\n    />\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001450\" do\r\n    title \"Secured connectors must use FIPS 140-2-validated cipher algorithms.\"\r\n    desc  \"If approved cryptographic algorithms are not used, encryption strength cannot be assured.\r\n    When configuring a connector for secured communications, also select an approved encryption cipher.\r\n    Examples include but are not limited to:\r\n    Symmetric Key\r\n    AES, Triple-DES, Escrowed Encryption Standard\r\n    Asymmetric Key\r\n    DSA, RSA, ECDSA\r\n    Hash Standards\r\n    *SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256\r\n    *SHA1 may be used for legacy applications only.\"\r\n    impact 0.7\r\n    tag \"gtitle\": \"SRG-APP-000429-AS-000157\"\r\n    tag \"gid\": \"TCAT-AS-001450\"\r\n    tag \"rid\": \"TCAT-AS-001450_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001450\"\r\n    tag \"cci\": \"CCI-002476\"\r\n    tag \"nist\": [\"SC-28\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo grep -i fipsmode $CATALINA_HOME/conf/server.xml. \r\n    If there are no results displayed or if FIPSMode is not set to FIPSMode=\\\"on\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user:\r\n    sudo nano $CATALINA_HOME/conf/server.xml. \r\n    In the <Listener/> element, locate the AprLifecycleListener, either add or modify the FIPSMode setting and set it to FIPSMode=\\\"on\\\".\r\n    EXAMPLE: \r\n    <Listener\r\n        className=\\\"org.apache.catalina.core.AprLifecycleListener\\\"\r\n        SSLEngine=\\\"on\\\"\r\n        FIPSMode=\\\"on\\\"\r\n    />\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    listeners = tomcat_server_file[\"//Listener/@className\"]\r\n    \r\n    listeners.each do |listener|\r\n        if listener == \"org.apache.catalina.core.AprLifecycleListener\"\r\n            describe tomcat_server_file['//Listener/@FIPSMode'][0] do \r\n                it { should cmp \"on\" }\r\n            end \r\n        end \r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001450.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001450.rb:1 ",
                      "run_time":0.003402768,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001460",
                "title":"The application server, when categorized as a high availability system within RMF, \n    must be in a high-availability (HA) cluster.",
                "desc":"A MAC I system is a system that handles data vital to the organization's operational \n    readiness or effectiveness of deployed or contingency forces. A MAC I system must maintain \n    the highest level of integrity and availability. By HA clustering the application server, \n    the hosted application and data are given a platform that is load-balanced and provided high-availability.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"A MAC I system is a system that handles data vital to the organization's operational \n    readiness or effectiveness of deployed or contingency forces. A MAC I system must maintain \n    the highest level of integrity and availability. By HA clustering the application server, \n    the hosted application and data are given a platform that is load-balanced and provided high-availability."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000435-AS-000069",
                   "gid":"TCAT-AS-001460",
                   "rid":"TCAT-AS-001460_rule",
                   "stig_id":"TCAT-AS-001460",
                   "cci":"CCI-002385",
                   "nist":[
                      "SC-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"This requirement only applies to a system that is categorized as high within the Risk Management Framework (RMF).\n    Review the System Security Plan (SSP) or other system documentation that specifies the operational uptime requirements and RMF \n    system categorization. If the system is categorized as high, from the Tomcat server as a privileged user, run the following command:\n    sudo grep -i -A10 -B2 \"Cluster\" $CATALINA_HOME/conf/server.xml\n    If the <Cluster/> element is commented out, or no results returned, then the system is not clustered and this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, modify the $CATALINA_HOME/conf/server.xml file.\n    Uncomment the \"<Cluster/>\" object and configure the system into a cluster as per the Tomcat clustering documentation provided at the Tomcat web site.\n    https://tomcat.apache.org/tomcat-9.0-doc/config/cluster.html"
                },
                "code":"control \"TCAT-AS-001460\" do\r\n    title \"The application server, when categorized as a high availability system within RMF, \r\n    must be in a high-availability (HA) cluster.\"\r\n    desc  \"A MAC I system is a system that handles data vital to the organization's operational \r\n    readiness or effectiveness of deployed or contingency forces. A MAC I system must maintain \r\n    the highest level of integrity and availability. By HA clustering the application server, \r\n    the hosted application and data are given a platform that is load-balanced and provided high-availability.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000435-AS-000069\"\r\n    tag \"gid\": \"TCAT-AS-001460\"\r\n    tag \"rid\": \"TCAT-AS-001460_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001460\"\r\n    tag \"cci\": \"CCI-002385\"\r\n    tag \"nist\": [\"SC-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"This requirement only applies to a system that is categorized as high within the Risk Management Framework (RMF).\r\n    Review the System Security Plan (SSP) or other system documentation that specifies the operational uptime requirements and RMF \r\n    system categorization. If the system is categorized as high, from the Tomcat server as a privileged user, run the following command:\r\n    sudo grep -i -A10 -B2 \\\"Cluster\\\" $CATALINA_HOME/conf/server.xml\r\n    If the <Cluster/> element is commented out, or no results returned, then the system is not clustered and this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, modify the $CATALINA_HOME/conf/server.xml file.\r\n    Uncomment the \\\"<Cluster/>\\\" object and configure the system into a cluster as per the Tomcat clustering documentation provided at the Tomcat web site.\r\n    https://tomcat.apache.org/tomcat-9.0-doc/config/cluster.html\"\r\n\r\n    describe \"This is a manual check\" do \r\n        skip \"Review the SSP or other system documentation that specifies the operational uptime requirements and \r\n        RMF system categorization. If the system is categorized as high, check the tomcat server.xml file to verify if clustering is enabled.\r\n        If not enabled then this is a finding.\"\r\n    end\r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001460.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":5.294e-06,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "resource":"",
                      "skip_message":"Review the SSP or other system documentation that specifies the operational uptime requirements and \n        RMF system categorization. If the system is categorized as high, check the tomcat server.xml file to verify if clustering is enabled.\n        If not enabled then this is a finding."
                   }
                ]
             },
             {
                "id":"TCAT-AS-001470",
                "title":"Tomcat server must be patched for security vulnerabilities.",
                "desc":"Tomcat is constantly being updated to address newly discovered vulnerabilities some of which include Denial-of-Service attacks. \n    To address this risk, the Tomcat admin must ensure the system remains up to date on patches.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat is constantly being updated to address newly discovered vulnerabilities some of which include Denial-of-Service attacks. \n    To address this risk, the Tomcat admin must ensure the system remains up to date on patches."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000435-AS-000163",
                   "gid":"TCAT-AS-001470",
                   "rid":"TCAT-AS-001470_rule",
                   "stig_id":"TCAT-AS-001470",
                   "cci":"CCI-002385",
                   "nist":[
                      "SC-5",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Refer to https://tomcat.apache.org/security-9.html and identify the latest secure version of Tomcat with no known vulnerabilities.\n    As a privileged user from the Tomcat server, run the following command:\n    sudo $CATALINA_HOME/bin/version.sh |grep -i server\n    Compare the version running on the system to the latest secure version of Tomcat.\n    If the latest secure version of Tomcat is not installed, this is a finding.",
                   "fix":"Follow operational procedures for upgrading Tomcat. Download latest version of Tomcat and install in a test environment. \n    Test applications that are running in production and follow all operations best practices when upgrading the production Tomcat application servers.\n    Update the Tomcat production instance accordingly and ensure corrected builds are installed once tested and verified."
                },
                "code":"control \"TCAT-AS-001470\" do\r\n    title \"Tomcat server must be patched for security vulnerabilities.\"\r\n    desc  \"Tomcat is constantly being updated to address newly discovered vulnerabilities some of which include Denial-of-Service attacks. \r\n    To address this risk, the Tomcat admin must ensure the system remains up to date on patches.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000435-AS-000163\"\r\n    tag \"gid\": \"TCAT-AS-001470\"\r\n    tag \"rid\": \"TCAT-AS-001470_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001470\"\r\n    tag \"cci\": \"CCI-002385\"\r\n    tag \"nist\": [\"SC-5\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Refer to https://tomcat.apache.org/security-9.html and identify the latest secure version of Tomcat with no known vulnerabilities.\r\n    As a privileged user from the Tomcat server, run the following command:\r\n    sudo $CATALINA_HOME/bin/version.sh |grep -i server\r\n    Compare the version running on the system to the latest secure version of Tomcat.\r\n    If the latest secure version of Tomcat is not installed, this is a finding.\"\r\n    tag \"fix\": \"Follow operational procedures for upgrading Tomcat. Download latest version of Tomcat and install in a test environment. \r\n    Test applications that are running in production and follow all operations best practices when upgrading the production Tomcat application servers.\r\n    Update the Tomcat production instance accordingly and ensure corrected builds are installed once tested and verified.\"\r\n    \r\n    describe \"This is a manual check\" do \r\n        skip \"Compare the output version of $CATALINA_HOME/bin/version.sh on the system with the latest secure version of Tomcat.\r\n        If the latest available secure version of Tomcat is not installed. This is a finding.\"\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001470.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":8.323e-06,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "resource":"",
                      "skip_message":"Compare the output version of $CATALINA_HOME/bin/version.sh on the system with the latest secure version of Tomcat.\n        If the latest available secure version of Tomcat is not installed. This is a finding."
                   }
                ]
             },
             {
                "id":"TCAT-AS-001480",
                "title":"TLS 1.2 must be used on secured connectors.",
                "desc":"Using older versions of TLS introduces security vulnerabilities that exist in the older versions of the protocol. \n    Tomcat by default will use all available versions of the SSL/TLS protocols unless the version is explicitly defined in the \n    SSL configuration attribute for the associated connector. This introduces the opportunity for the client to negotiate the \n    use of an older protocol version and increases the risk of compromise of the Tomcat server. All connectors must use TLS 1.2.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Using older versions of TLS introduces security vulnerabilities that exist in the older versions of the protocol. \n    Tomcat by default will use all available versions of the SSL/TLS protocols unless the version is explicitly defined in the \n    SSL configuration attribute for the associated connector. This introduces the opportunity for the client to negotiate the \n    use of an older protocol version and increases the risk of compromise of the Tomcat server. All connectors must use TLS 1.2."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000439-AS-000155",
                   "gid":"TCAT-AS-001480",
                   "rid":"TCAT-AS-001480_rule",
                   "stig_id":"TCAT-AS-001480",
                   "cci":"CCI-002418",
                   "nist":[
                      "SC-8",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo cat $CATALINA_HOME/conf/server.xml.  \n    Examine each <Connector> </Connector> statement.\n    For every HTTP protocol connector:\n    Verify the SSLEnabledProtocols=\"TLSv1.2\" flag is set on each connector.\n    If the SSLEnabledProtocols setting is not set to TLSv1.2 or greater, this is a finding.",
                   "fix":"As a privileged user on the Tomcat server, edit the $CATALINA_HOME/conf/server.xml and modify the <Connector> �</Connector> element.\n    Add the \"SSLEnabledProtocols=\" flag to the connector or modify the existing flag.\n    Set SSLEnabledProtocols=\"TLS1.2\". Save the server.xml file and restart Tomcat:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001480\" do\r\n    title \"TLS 1.2 must be used on secured connectors.\"\r\n    desc  \"Using older versions of TLS introduces security vulnerabilities that exist in the older versions of the protocol. \r\n    Tomcat by default will use all available versions of the SSL/TLS protocols unless the version is explicitly defined in the \r\n    SSL configuration attribute for the associated connector. This introduces the opportunity for the client to negotiate the \r\n    use of an older protocol version and increases the risk of compromise of the Tomcat server. All connectors must use TLS 1.2.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000439-AS-000155\"\r\n    tag \"gid\": \"TCAT-AS-001480\"\r\n    tag \"rid\": \"TCAT-AS-001480_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001480\"\r\n    tag \"cci\": \"CCI-002418\"\r\n    tag \"nist\": [\"SC-8\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo cat $CATALINA_HOME/conf/server.xml.  \r\n    Examine each <Connector> </Connector> statement.\r\n    For every HTTP protocol connector:\r\n    Verify the SSLEnabledProtocols=\\\"TLSv1.2\\\" flag is set on each connector.\r\n    If the SSLEnabledProtocols setting is not set to TLSv1.2 or greater, this is a finding.\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server, edit the $CATALINA_HOME/conf/server.xml and modify the <Connector> �</Connector> element.\r\n    Add the \\\"SSLEnabledProtocols=\\\" flag to the connector or modify the existing flag.\r\n    Set SSLEnabledProtocols=\\\"TLS1.2\\\". Save the server.xml file and restart Tomcat:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    connectors_count = tomcat_server_file[\"//Connector\"].count \r\n    ssl_enabled_protocols = tomcat_server_file[\"//Connector/@SSLEnabledProtocols\"]\r\n\r\n    describe connectors_count do \r\n        puts \"Each connector should have SSLEnabledProtocols attribute\"\r\n        it { should eq ssl_enabled_protocols.count }\r\n    end\r\n\r\n    ssl_enabled_protocols.each do |item|\r\n        describe item do \r\n            it { should cmp \"TLSv1.2\" }\r\n        end\r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001480.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001480.rb:1 ",
                      "run_time":0.002548467,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001490",
                "title":"Secured connectors must use FIPS 140-2-validated cipher algorithms.",
                "desc":"If approved cryptographic algorithms are not used, encryption strength cannot be assured.\n    When configuring a connector for secured communications, also select an approved encryption cipher.\n    Examples include but are not limited to:\n    Symmetric Key\n    AES, Triple-DES, Escrowed Encryption Standard\n    Asymmetric Key\n    DSA, RSA, ECDSA\n    Hash Standards\n    *SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256\n    *SHA1 may be used for legacy applications only.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"If approved cryptographic algorithms are not used, encryption strength cannot be assured.\n    When configuring a connector for secured communications, also select an approved encryption cipher.\n    Examples include but are not limited to:\n    Symmetric Key\n    AES, Triple-DES, Escrowed Encryption Standard\n    Asymmetric Key\n    DSA, RSA, ECDSA\n    Hash Standards\n    *SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256\n    *SHA1 may be used for legacy applications only."
                   }
                ],
                "impact":0.7,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000439-AS-000274",
                   "gid":"TCAT-AS-001490",
                   "rid":"TCAT-AS-001490_rule",
                   "stig_id":"TCAT-AS-001490",
                   "cci":"CCI-002418",
                   "nist":[
                      "SC-8",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo grep -i fipsmode $CATALINA_HOME/conf/server.xml.  \n    If there are no results displayed or if FIPSMode is not set to FIPSMode=\"on\", this is a finding.",
                   "fix":"From the Tomcat server as a privileged user:\n    sudo nano $CATALINA_HOME/conf/server.xml.  \n    In the <Listener/> element, locate the AprLifecycleListener, either add or modify the FIPSMode setting and set it to FIPSMode=\"on\".\n    EXAMPLE: \n    <Listener\n        className=\"org.apache.catalina.core.AprLifecycleListener\"\n        SSLEngine=\"on\"\n        FIPSMode=\"on\"\n    />\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001490\" do\r\n    title \"Secured connectors must use FIPS 140-2-validated cipher algorithms.\"\r\n    desc  \"If approved cryptographic algorithms are not used, encryption strength cannot be assured.\r\n    When configuring a connector for secured communications, also select an approved encryption cipher.\r\n    Examples include but are not limited to:\r\n    Symmetric Key\r\n    AES, Triple-DES, Escrowed Encryption Standard\r\n    Asymmetric Key\r\n    DSA, RSA, ECDSA\r\n    Hash Standards\r\n    *SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256\r\n    *SHA1 may be used for legacy applications only.\"\r\n    impact 0.7\r\n    tag \"gtitle\": \"SRG-APP-000439-AS-000274\"\r\n    tag \"gid\": \"TCAT-AS-001490\"\r\n    tag \"rid\": \"TCAT-AS-001490_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001490\"\r\n    tag \"cci\": \"CCI-002418\"\r\n    tag \"nist\": [\"SC-8\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo grep -i fipsmode $CATALINA_HOME/conf/server.xml.  \r\n    If there are no results displayed or if FIPSMode is not set to FIPSMode=\\\"on\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user:\r\n    sudo nano $CATALINA_HOME/conf/server.xml.  \r\n    In the <Listener/> element, locate the AprLifecycleListener, either add or modify the FIPSMode setting and set it to FIPSMode=\\\"on\\\".\r\n    EXAMPLE: \r\n    <Listener\r\n        className=\\\"org.apache.catalina.core.AprLifecycleListener\\\"\r\n        SSLEngine=\\\"on\\\"\r\n        FIPSMode=\\\"on\\\"\r\n    />\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    listeners = tomcat_server_file[\"//Listener/@className\"]\r\n    \r\n    listeners.each do |listener|\r\n        if listener == \"org.apache.catalina.core.AprLifecycleListener\"\r\n            describe tomcat_server_file['//Listener/@FIPSMode'][0] do \r\n                it { should cmp \"on\" }\r\n            end \r\n        end \r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001490.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001490.rb:1 ",
                      "run_time":0.002600634,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001500",
                "title":"Secured connectors must use FIPS 140-2-validated cipher algorithms.",
                "desc":"If approved cryptographic algorithms are not used, encryption strength cannot be assured.\n    When configuring a connector for secured communications, also select an approved encryption cipher.\n    Examples include but are not limited to:\n    Symmetric Key\n    AES, Triple-DES, Escrowed Encryption Standard\n    Asymmetric Key\n    DSA, RSA, ECDSA\n    Hash Standards\n    *SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256\n    *SHA1 may be used for legacy applications only.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"If approved cryptographic algorithms are not used, encryption strength cannot be assured.\n    When configuring a connector for secured communications, also select an approved encryption cipher.\n    Examples include but are not limited to:\n    Symmetric Key\n    AES, Triple-DES, Escrowed Encryption Standard\n    Asymmetric Key\n    DSA, RSA, ECDSA\n    Hash Standards\n    *SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256\n    *SHA1 may be used for legacy applications only."
                   }
                ],
                "impact":0.7,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000440-AS-000167",
                   "gid":"TCAT-AS-001500",
                   "rid":"TCAT-AS-001500_rule",
                   "stig_id":"TCAT-AS-001500",
                   "cci":"CCI-002421",
                   "nist":[
                      "SC-8",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server console, run the following command:\n    sudo grep -i fipsmode $CATALINA_HOME/conf/server.xml. \n    If there are no results displayed or if FIPSMode is not set to FIPSMode=\"on\", this is a finding.",
                   "fix":"From the Tomcat server as a privileged user:\n    sudo nano $CATALINA_HOME/conf/server.xml.  \n    In the <Listener> element, locate the AprLifecycleListener, either add or modify the FIPSMode setting and set it to FIPSMode=\"on\"\n    EXAMPLE: \n    <Listener\n        className=\"org.apache.catalina.core.AprLifecycleListener\"\n        SSLEngine=\"on\"\n        FIPSMode=\"on\"\n    />\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001500\" do\r\n    title \"Secured connectors must use FIPS 140-2-validated cipher algorithms.\"\r\n    desc  \"If approved cryptographic algorithms are not used, encryption strength cannot be assured.\r\n    When configuring a connector for secured communications, also select an approved encryption cipher.\r\n    Examples include but are not limited to:\r\n    Symmetric Key\r\n    AES, Triple-DES, Escrowed Encryption Standard\r\n    Asymmetric Key\r\n    DSA, RSA, ECDSA\r\n    Hash Standards\r\n    *SHA-1, SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256\r\n    *SHA1 may be used for legacy applications only.\"\r\n    impact 0.7\r\n    tag \"gtitle\": \"SRG-APP-000440-AS-000167\"\r\n    tag \"gid\": \"TCAT-AS-001500\"\r\n    tag \"rid\": \"TCAT-AS-001500_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001500\"\r\n    tag \"cci\": \"CCI-002421\"\r\n    tag \"nist\": [\"SC-8\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server console, run the following command:\r\n    sudo grep -i fipsmode $CATALINA_HOME/conf/server.xml. \r\n    If there are no results displayed or if FIPSMode is not set to FIPSMode=\\\"on\\\", this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user:\r\n    sudo nano $CATALINA_HOME/conf/server.xml.  \r\n    In the <Listener> element, locate the AprLifecycleListener, either add or modify the FIPSMode setting and set it to FIPSMode=\\\"on\\\"\r\n    EXAMPLE: \r\n    <Listener\r\n        className=\\\"org.apache.catalina.core.AprLifecycleListener\\\"\r\n        SSLEngine=\\\"on\\\"\r\n        FIPSMode=\\\"on\\\"\r\n    />\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    listeners = tomcat_server_file[\"//Listener/@className\"]\r\n    \r\n    listeners.each do |listener|\r\n        if listener == \"org.apache.catalina.core.AprLifecycleListener\"\r\n            describe tomcat_server_file['//Listener/@FIPSMode'][0] do \r\n                it { should cmp \"on\" }\r\n            end \r\n        end \r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001500.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001500.rb:1 ",
                      "run_time":0.002486996,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001550",
                "title":"Tomcat server must be patched for security vulnerabilities.",
                "desc":"Tomcat is constantly being updated to address newly discovered security vulnerabilities. \n    If the Tomcat server is not updated to address these risks, the server could be compromised \n    or a new DoS attack could be successful.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat is constantly being updated to address newly discovered security vulnerabilities. \n    If the Tomcat server is not updated to address these risks, the server could be compromised \n    or a new DoS attack could be successful."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000456-AS-000266",
                   "gid":"TCAT-AS-001550",
                   "rid":"TCAT-AS-001550_rule",
                   "stig_id":"TCAT-AS-001550",
                   "cci":"CCI-002605",
                   "nist":[
                      "SI-2",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Refer to https://tomcat.apache.org/security-9.html and identify the latest secure version of Tomcat with no known vulnerabilities.\n    As a privileged user from the Tomcat server, run the following command:\n    sudo $CATALINA_HOME/bin/version.sh |grep -i server\n    Compare the version running on the system to the latest secure version of Tomcat.\n    If the latest secure version of Tomcat is not installed, this is a finding.",
                   "fix":"Follow operational procedures for upgrading Tomcat. Download latest version of Tomcat and install in a test environment. \n    Test applications that are running in production and follow all operations best practices when upgrading the production Tomcat application servers.\n    Update the Tomcat production instance accordingly and ensure corrected builds are installed once tested and verified."
                },
                "code":"control \"TCAT-AS-001550\" do\r\n    title \"Tomcat server must be patched for security vulnerabilities.\"\r\n    desc  \"Tomcat is constantly being updated to address newly discovered security vulnerabilities. \r\n    If the Tomcat server is not updated to address these risks, the server could be compromised \r\n    or a new DoS attack could be successful.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000456-AS-000266\"\r\n    tag \"gid\": \"TCAT-AS-001550\"\r\n    tag \"rid\": \"TCAT-AS-001550_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001550\"\r\n    tag \"cci\": \"CCI-002605\"\r\n    tag \"nist\": [\"SI-2\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Refer to https://tomcat.apache.org/security-9.html and identify the latest secure version of Tomcat with no known vulnerabilities.\r\n    As a privileged user from the Tomcat server, run the following command:\r\n    sudo $CATALINA_HOME/bin/version.sh |grep -i server\r\n    Compare the version running on the system to the latest secure version of Tomcat.\r\n    If the latest secure version of Tomcat is not installed, this is a finding.\"\r\n    tag \"fix\": \"Follow operational procedures for upgrading Tomcat. Download latest version of Tomcat and install in a test environment. \r\n    Test applications that are running in production and follow all operations best practices when upgrading the production Tomcat application servers.\r\n    Update the Tomcat production instance accordingly and ensure corrected builds are installed once tested and verified.\"\r\n    \r\n    describe \"This is a manual check\" do \r\n        skip \"Compare the output version of $CATALINA_HOME/bin/version.sh on the system with the latest secure version of Tomcat.\r\n        If the latest available secure version of Tomcat is not installed. This is a finding.\"\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001550.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":5.135e-06,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "resource":"",
                      "skip_message":"Compare the output version of $CATALINA_HOME/bin/version.sh on the system with the latest secure version of Tomcat.\n        If the latest available secure version of Tomcat is not installed. This is a finding."
                   }
                ]
             },
             {
                "id":"TCAT-AS-001560",
                "title":"AccessLogValve must be configured for Catalina engine.",
                "desc":"The <Engine> container represents the entire request processing machinery associated with a particular Catalina Service. \n    It receives and processes all requests from one or more Connectors, and returns the completed response to the Connector \n    for transmission back to the client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element \n    MUST be nested inside a Service element, following all of the corresponding Connector elements associated with the Service.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The <Engine> container represents the entire request processing machinery associated with a particular Catalina Service. \n    It receives and processes all requests from one or more Connectors, and returns the completed response to the Connector \n    for transmission back to the client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element \n    MUST be nested inside a Service element, following all of the corresponding Connector elements associated with the Service."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000495-AS-000220",
                   "gid":"TCAT-AS-001560",
                   "rid":"TCAT-AS-001560_rule",
                   "stig_id":"TCAT-AS-001560",
                   "cci":"CCI-000172",
                   "nist":[
                      "AU-12",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\n    Review the <Engine> element. Ensure one AccessLog <Valve> element is nested within the Engine element. \n    If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> element is not defined, this is a finding.\n    EXAMPLE:\n    <Engine name=\"Standalone\" ...>\n      ...\n      <Valve className=\"org.apache.catalina.valves.AccessLogValve\"\n            prefix=\"catalina_access_log\" suffix=\".txt\"\n            pattern=\"common\"/>\n      ...\n    </Engine>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME\u000fnf erver.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001560\" do\r\n    title \"AccessLogValve must be configured for Catalina engine.\"\r\n    desc  \"The <Engine> container represents the entire request processing machinery associated with a particular Catalina Service. \r\n    It receives and processes all requests from one or more Connectors, and returns the completed response to the Connector \r\n    for transmission back to the client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element \r\n    MUST be nested inside a Service element, following all of the corresponding Connector elements associated with the Service.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000495-AS-000220\"\r\n    tag \"gid\": \"TCAT-AS-001560\"\r\n    tag \"rid\": \"TCAT-AS-001560_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001560\"\r\n    tag \"cci\": \"CCI-000172\"\r\n    tag \"nist\": [\"AU-12\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\\\conf\\\\server.xml file.\r\n    Review the <Engine> element. Ensure one AccessLog <Valve> element is nested within the Engine element. \r\n    If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> element is not defined, this is a finding.\r\n    EXAMPLE:\r\n    <Engine name=\\\"Standalone\\\" ...>\r\n      ...\r\n      <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\"\r\n            prefix=\\\"catalina_access_log\\\" suffix=\\\".txt\\\"\r\n            pattern=\\\"common\\\"/>\r\n      ...\r\n    </Engine>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    valves = tomcat_server_file[\"//Valve/@className\"]\r\n    describe valves do \r\n      it { should include \"org.apache.catalina.valves.AccessLogValve\" }\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001560.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001560.rb:1 ",
                      "run_time":0.001623317,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001570",
                "title":"AccessLogValve must be configured for Catalina engine.",
                "desc":"The <Engine> container represents the entire request processing machinery associated with a particular Catalina Service. \n    It receives and processes all requests from one or more Connectors, and returns the completed response to the Connector for \n    transmission back to the client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element \n    MUST be nested inside a Service element, following all of the corresponding Connector elements associated with the Service.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The <Engine> container represents the entire request processing machinery associated with a particular Catalina Service. \n    It receives and processes all requests from one or more Connectors, and returns the completed response to the Connector for \n    transmission back to the client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element \n    MUST be nested inside a Service element, following all of the corresponding Connector elements associated with the Service."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000499-AS-000224",
                   "gid":"TCAT-AS-001570",
                   "rid":"TCAT-AS-001570_rule",
                   "stig_id":"TCAT-AS-001570",
                   "cci":"CCI-000172",
                   "nist":[
                      "AU-12",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\n    Review the <Engine> element. Ensure one AccessLog <Valve> element is nested within the Engine element. \n    If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> element is not defined, this is a finding.\n    EXAMPLE:\n    <Engine name=\"Standalone\" ...>\n      ...\n      <Valve className=\"org.apache.catalina.valves.AccessLogValve\"\n            prefix=\"catalina_access_log\" suffix=\".txt\"\n            pattern=\"common\"/>\n      ...\n    </Engine>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>\n\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001570\" do\r\n    title \"AccessLogValve must be configured for Catalina engine.\"\r\n    desc  \"The <Engine> container represents the entire request processing machinery associated with a particular Catalina Service. \r\n    It receives and processes all requests from one or more Connectors, and returns the completed response to the Connector for \r\n    transmission back to the client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element \r\n    MUST be nested inside a Service element, following all of the corresponding Connector elements associated with the Service.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000499-AS-000224\"\r\n    tag \"gid\": \"TCAT-AS-001570\"\r\n    tag \"rid\": \"TCAT-AS-001570_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001570\"\r\n    tag \"cci\": \"CCI-000172\"\r\n    tag \"nist\": [\"AU-12\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\\\conf\\\\server.xml file.\r\n    Review the <Engine> element. Ensure one AccessLog <Valve> element is nested within the Engine element. \r\n    If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> element is not defined, this is a finding.\r\n    EXAMPLE:\r\n    <Engine name=\\\"Standalone\\\" ...>\r\n      ...\r\n      <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\"\r\n            prefix=\\\"catalina_access_log\\\" suffix=\\\".txt\\\"\r\n            pattern=\\\"common\\\"/>\r\n      ...\r\n    </Engine>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\\\conf\\\\server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\r\n\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    valves = tomcat_server_file[\"//Valve/@className\"]\r\n    describe valves do \r\n      it { should include \"org.apache.catalina.valves.AccessLogValve\" }\r\n    end\r\n      \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001570.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001570.rb:1 ",
                      "run_time":0.00159968,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001580",
                "title":"AccessLogValve must be configured per each virtual host.",
                "desc":"Tomcat has the ability to host multiple virtual hosts on one physical server by using the <Host> container attribute. \n    This allows the admin to separate hosted applications according to the domain where the application will be available. \n    Configuring logs on a per-host basis allows for log management that correlates to the virtual host activity.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat has the ability to host multiple virtual hosts on one physical server by using the <Host> container attribute. \n    This allows the admin to separate hosted applications according to the domain where the application will be available. \n    Configuring logs on a per-host basis allows for log management that correlates to the virtual host activity."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000503-AS-000228",
                   "gid":"TCAT-AS-001580",
                   "rid":"TCAT-AS-001580_rule",
                   "stig_id":"TCAT-AS-001580",
                   "cci":"CCI-000172",
                   "nist":[
                      "AU-12",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Review for all <Host> elements. If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> \n    element is not defined for each <Host> element, this is a finding.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001580\" do\r\n    title \"AccessLogValve must be configured per each virtual host.\"\r\n    desc  \"Tomcat has the ability to host multiple virtual hosts on one physical server by using the <Host> container attribute. \r\n    This allows the admin to separate hosted applications according to the domain where the application will be available. \r\n    Configuring logs on a per-host basis allows for log management that correlates to the virtual host activity.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000503-AS-000228\"\r\n    tag \"gid\": \"TCAT-AS-001580\"\r\n    tag \"rid\": \"TCAT-AS-001580_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001580\"\r\n    tag \"cci\": \"CCI-000172\"\r\n    tag \"nist\": [\"AU-12\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Review for all <Host> elements. If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> \r\n    element is not defined for each <Host> element, this is a finding.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    valves = tomcat_server_file[\"//Valve/@className\"]\r\n    describe valves do \r\n      it { should include \"org.apache.catalina.valves.AccessLogValve\" }\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001580.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001580.rb:1 ",
                      "run_time":0.001783403,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001590",
                "title":"Changes to $CATALINA_HOME/bin/ folder must be logged.",
                "desc":"The $CATALINA_HOME/bin folder contains startup and control scripts for the Tomcat Catalina server. \n    To provide forensic evidence in the event of file tampering, changes to content in this folder must be logged. \n    For Linux OS flavors other than Ubuntu, use the relevant OS commands. This can be done on the Ubuntu OS via the auditctl command. \n    Using the -p wa flag set the permissions flag for a file system watch and logs file attribute and content change events into syslog.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The $CATALINA_HOME/bin folder contains startup and control scripts for the Tomcat Catalina server. \n    To provide forensic evidence in the event of file tampering, changes to content in this folder must be logged. \n    For Linux OS flavors other than Ubuntu, use the relevant OS commands. This can be done on the Ubuntu OS via the auditctl command. \n    Using the -p wa flag set the permissions flag for a file system watch and logs file attribute and content change events into syslog."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000504-AS-000229",
                   "gid":"TCAT-AS-001590",
                   "rid":"TCAT-AS-001590_rule",
                   "stig_id":"TCAT-AS-001590",
                   "cci":"CCI-000172",
                   "nist":[
                      "AU-12",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Run the following commands From the Tomcat server as a privileged user:\n    Identify the home folder for the Tomcat server. \n    sudo grep -i -- 'catalina_home\\|catalina_base' /etc/systemd/system/tomcat.service\n    Check the audit rules for the Tomcat folders.\n    sudo auditctl -l $CATALINA_HOME/bin |grep -i bin\n    If the results do not include -w $CATALINA_HOME/bin -p wa -k tomcat, or if there are no results, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, use the auditctl command.\n    sudo auditctl  -w $CATALINA_HOME/bin -p wa -k tomcat\n    Validate the audit watch was created.\n    sudo auditctl -l \n    The user should see: \n    -w $CATALINA_HOME/ -p wa -k tomcat"
                },
                "code":"control \"TCAT-AS-001590\" do\r\n    title \"Changes to $CATALINA_HOME/bin/ folder must be logged.\"\r\n    desc  \"The $CATALINA_HOME/bin folder contains startup and control scripts for the Tomcat Catalina server. \r\n    To provide forensic evidence in the event of file tampering, changes to content in this folder must be logged. \r\n    For Linux OS flavors other than Ubuntu, use the relevant OS commands. This can be done on the Ubuntu OS via the auditctl command. \r\n    Using the -p wa flag set the permissions flag for a file system watch and logs file attribute and content change events into syslog.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000504-AS-000229\"\r\n    tag \"gid\": \"TCAT-AS-001590\"\r\n    tag \"rid\": \"TCAT-AS-001590_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001590\"\r\n    tag \"cci\": \"CCI-000172\"\r\n    tag \"nist\": [\"AU-12\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Run the following commands From the Tomcat server as a privileged user:\r\n    Identify the home folder for the Tomcat server. \r\n    sudo grep -i -- 'catalina_home\\\\|catalina_base' /etc/systemd/system/tomcat.service\r\n    Check the audit rules for the Tomcat folders.\r\n    sudo auditctl -l $CATALINA_HOME/bin |grep -i bin\r\n    If the results do not include -w $CATALINA_HOME/bin -p wa -k tomcat, or if there are no results, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, use the auditctl command.\r\n    sudo auditctl  -w $CATALINA_HOME/bin -p wa -k tomcat\r\n    Validate the audit watch was created.\r\n    sudo auditctl -l \r\n    The user should see: \r\n    -w $CATALINA_HOME/ -p wa -k tomcat\"\r\n\r\n    descibe \"This is a manual check\" do \r\n        skip \"Check the audit rules for the Tomcat folders. If the results do not include \r\n        -w $CATALINA_HOME/bin -p wa -k tomcat, or if there are no results, this is a finding.\"\r\n    end\r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001590.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001590.rb:1 ",
                      "run_time":0.004962519,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `descibe' for #<Inspec::Rule:0x00000000049c8570>\nDid you mean?  describe",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001592",
                "title":"Changes to $CATALINA_HOME/conf/ folder must be logged.",
                "desc":"The $CATALINA_HOME/conf folder contains configuration files for the Tomcat Catalina server. \n    To provide forensic evidence in the event of file tampering, changes to contents in this folder must be logged. \n    For Linux OS flavors other than Ubuntu, use the relevant OS commands. This can be done on the Ubuntu OS via the \n    auditctl command. Using the -p wa flag set the permissions flag for a file system watch and logs file attribute \n    and content change events into syslog.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The $CATALINA_HOME/conf folder contains configuration files for the Tomcat Catalina server. \n    To provide forensic evidence in the event of file tampering, changes to contents in this folder must be logged. \n    For Linux OS flavors other than Ubuntu, use the relevant OS commands. This can be done on the Ubuntu OS via the \n    auditctl command. Using the -p wa flag set the permissions flag for a file system watch and logs file attribute \n    and content change events into syslog."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000504-AS-000229",
                   "gid":"TCAT-AS-001592",
                   "rid":"TCAT-AS-001592_rule",
                   "stig_id":"TCAT-AS-001592",
                   "cci":"CCI-000172",
                   "nist":[
                      "AU-12",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Run the following commands From the Tomcat server as a privileged user:\n    Identify the home folder for the Tomcat server. \n    sudo grep -i -- 'catalina_home\\|catalina_base' /etc/systemd/system/tomcat.service\n    Check the audit rules for the Tomcat folders.\n    sudo auditctl -l $CATALINA_HOME/bin |grep -i conf\n    If the results do not include -w $CATALINA_HOME/conf -p wa -k tomcat, or if there are no results, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, use the auditctl command.\n    sudo auditctl  -w $CATALINA_HOME/conf -p wa -k tomcat\n    Validate the audit watch was created.\n    sudo auditctl -l \n    The user should see: \n    -w $CATALINA_HOME/ -p wa -k tomcat"
                },
                "code":"control \"TCAT-AS-001592\" do\r\n    title \"Changes to $CATALINA_HOME/conf/ folder must be logged.\"\r\n    desc  \"The $CATALINA_HOME/conf folder contains configuration files for the Tomcat Catalina server. \r\n    To provide forensic evidence in the event of file tampering, changes to contents in this folder must be logged. \r\n    For Linux OS flavors other than Ubuntu, use the relevant OS commands. This can be done on the Ubuntu OS via the \r\n    auditctl command. Using the -p wa flag set the permissions flag for a file system watch and logs file attribute \r\n    and content change events into syslog.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000504-AS-000229\"\r\n    tag \"gid\": \"TCAT-AS-001592\"\r\n    tag \"rid\": \"TCAT-AS-001592_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001592\"\r\n    tag \"cci\": \"CCI-000172\"\r\n    tag \"nist\": [\"AU-12\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Run the following commands From the Tomcat server as a privileged user:\r\n    Identify the home folder for the Tomcat server. \r\n    sudo grep -i -- 'catalina_home\\\\|catalina_base' /etc/systemd/system/tomcat.service\r\n    Check the audit rules for the Tomcat folders.\r\n    sudo auditctl -l $CATALINA_HOME/bin |grep -i conf\r\n    If the results do not include -w $CATALINA_HOME/conf -p wa -k tomcat, or if there are no results, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, use the auditctl command.\r\n    sudo auditctl  -w $CATALINA_HOME/conf -p wa -k tomcat\r\n    Validate the audit watch was created.\r\n    sudo auditctl -l \r\n    The user should see: \r\n    -w $CATALINA_HOME/ -p wa -k tomcat\"\r\n\r\n    descibe \"This is a manual check\" do \r\n        skip \"Check the audit rules for the Tomcat folders. If the results do not include \r\n        -w $CATALINA_HOME/bin -p wa -k tomcat, or if there are no results, this is a finding.\"\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001592.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001592.rb:1 ",
                      "run_time":0.003536338,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `descibe' for #<Inspec::Rule:0x0000000007ca13c0>\nDid you mean?  describe",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001594",
                "title":"Changes to $CATALINA_HOME/lib/ folder must be logged.",
                "desc":"The $CATALINA_HOME/lib folder contains library files for the Tomcat Catalina server. \n    These are in the form of java archive (jar) files. To provide forensic evidence in the event of file tampering, \n    changes to contents in this folder must be logged. For Linux OS flavors other than Ubuntu, use the relevant OS commands. \n    This can be done on the Ubuntu OS via the auditctl command. Using the -p wa flag set the permissions flag for a file \n    system watch and logs file attribute and content change events into syslog.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The $CATALINA_HOME/lib folder contains library files for the Tomcat Catalina server. \n    These are in the form of java archive (jar) files. To provide forensic evidence in the event of file tampering, \n    changes to contents in this folder must be logged. For Linux OS flavors other than Ubuntu, use the relevant OS commands. \n    This can be done on the Ubuntu OS via the auditctl command. Using the -p wa flag set the permissions flag for a file \n    system watch and logs file attribute and content change events into syslog."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000504-AS-000229",
                   "gid":"TCAT-AS-001594",
                   "rid":"TCAT-AS-001594_rule",
                   "stig_id":"TCAT-AS-001594",
                   "cci":"CCI-000172",
                   "nist":[
                      "AU-12",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Run the following commands From the Tomcat server as a privileged user:\n    Identify the home folder for the Tomcat server. \n    sudo grep -i -- 'catalina_home\\|catalina_base' /etc/systemd/system/tomcat.service\n    Check the audit rules for the Tomcat folders\n    sudo auditctl -l $CATALINA_HOME/bin |grep -i lib\n    If the results do not include -w $CATALINA_HOME/lib -p wa -k tomcat, or if there are no results, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user, use the auditctl command.\n    sudo auditctl  -w $CATALINA_HOME/lib -p wa -k tomcat\n    Validate the audit watch was created.\n    sudo auditctl -l \n    The user should see: \n    -w $CATALINA_HOME/ -p wa -k tomcat"
                },
                "code":"control \"TCAT-AS-001594\" do\r\n    title \"Changes to $CATALINA_HOME/lib/ folder must be logged.\"\r\n    desc  \"The $CATALINA_HOME/lib folder contains library files for the Tomcat Catalina server. \r\n    These are in the form of java archive (jar) files. To provide forensic evidence in the event of file tampering, \r\n    changes to contents in this folder must be logged. For Linux OS flavors other than Ubuntu, use the relevant OS commands. \r\n    This can be done on the Ubuntu OS via the auditctl command. Using the -p wa flag set the permissions flag for a file \r\n    system watch and logs file attribute and content change events into syslog.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000504-AS-000229\"\r\n    tag \"gid\": \"TCAT-AS-001594\"\r\n    tag \"rid\": \"TCAT-AS-001594_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001594\"\r\n    tag \"cci\": \"CCI-000172\"\r\n    tag \"nist\": [\"AU-12\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Run the following commands From the Tomcat server as a privileged user:\r\n    Identify the home folder for the Tomcat server. \r\n    sudo grep -i -- 'catalina_home\\\\|catalina_base' /etc/systemd/system/tomcat.service\r\n    Check the audit rules for the Tomcat folders\r\n    sudo auditctl -l $CATALINA_HOME/bin |grep -i lib\r\n    If the results do not include -w $CATALINA_HOME/lib -p wa -k tomcat, or if there are no results, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user, use the auditctl command.\r\n    sudo auditctl  -w $CATALINA_HOME/lib -p wa -k tomcat\r\n    Validate the audit watch was created.\r\n    sudo auditctl -l \r\n    The user should see: \r\n    -w $CATALINA_HOME/ -p wa -k tomcat\"\r\n\r\n    descibe \"This is a manual check\" do \r\n        skip \"Check the audit rules for the Tomcat folders. If the results do not include \r\n        -w $CATALINA_HOME/bin -p wa -k tomcat, or if there are no results, this is a finding.\"\r\n    end\r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001594.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001594.rb:1 ",
                      "run_time":0.0035008,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `descibe' for #<Inspec::Rule:0x0000000007cad7b0>\nDid you mean?  describe",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001596",
                "title":"AccessLogValve must be configured for Catalina engine.",
                "desc":"The <Engine> container represents the entire request processing machinery associated with a particular Catalina Service. \n    It receives and processes all requests from one or more Connectors, and returns the completed response to the Connector for \n    transmission back to the client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element MUST \n    be nested inside a Service element, following all of the corresponding Connector elements associated with the Service.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The <Engine> container represents the entire request processing machinery associated with a particular Catalina Service. \n    It receives and processes all requests from one or more Connectors, and returns the completed response to the Connector for \n    transmission back to the client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element MUST \n    be nested inside a Service element, following all of the corresponding Connector elements associated with the Service."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000504-AS-000229",
                   "gid":"TCAT-AS-001596",
                   "rid":"TCAT-AS-001596_rule",
                   "stig_id":"TCAT-AS-001596",
                   "cci":"CCI-000172",
                   "nist":[
                      "AU-12",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\n    Review the <Engine> element. Ensure one AccessLog <Valve> element is nested within the Engine element. \n    If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> element is not defined, this is a finding.\n    EXAMPLE:\n    <Engine name=\"Standalone\" ...>\n      ...\n      <Valve className=\"org.apache.catalina.valves.AccessLogValve\"\n            prefix=\"catalina_access_log\" suffix=\".txt\"\n            pattern=\"common\"/>\n      ...\n    </Engine>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME\\conf\\server.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n    ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001596\" do\r\n    title \"AccessLogValve must be configured for Catalina engine.\"\r\n    desc  \"The <Engine> container represents the entire request processing machinery associated with a particular Catalina Service. \r\n    It receives and processes all requests from one or more Connectors, and returns the completed response to the Connector for \r\n    transmission back to the client. The AccessLogValve will log activity for the Catalina service. Exactly one Engine element MUST \r\n    be nested inside a Service element, following all of the corresponding Connector elements associated with the Service.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000504-AS-000229\"\r\n    tag \"gid\": \"TCAT-AS-001596\"\r\n    tag \"rid\": \"TCAT-AS-001596_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001596\"\r\n    tag \"cci\": \"CCI-000172\"\r\n    tag \"nist\": [\"AU-12\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\\\conf\\\\server.xml file.\r\n    Review the <Engine> element. Ensure one AccessLog <Valve> element is nested within the Engine element. \r\n    If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> element is not defined, this is a finding.\r\n    EXAMPLE:\r\n    <Engine name=\\\"Standalone\\\" ...>\r\n      ...\r\n      <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\"\r\n            prefix=\\\"catalina_access_log\\\" suffix=\\\".txt\\\"\r\n            pattern=\\\"common\\\"/>\r\n      ...\r\n    </Engine>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME\\\\conf\\\\server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n    ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    valves = tomcat_server_file[\"//Valve/@className\"]\r\n    describe valves do \r\n      it { should include \"org.apache.catalina.valves.AccessLogValve\" }\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001596.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001596.rb:1 ",
                      "run_time":0.001616148,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001600",
                "title":"AccessLogValve must be configured per each virtual host.",
                "desc":"Tomcat has the ability to host multiple virtual hosts on one physical server by using the <Host> container attribute. \n    This allows the admin to separate hosted applications according to where the domain the application will be available. \n    Configuring logs on a per-host basis allows for log management that correlates to the virtual host activity.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat has the ability to host multiple virtual hosts on one physical server by using the <Host> container attribute. \n    This allows the admin to separate hosted applications according to where the domain the application will be available. \n    Configuring logs on a per-host basis allows for log management that correlates to the virtual host activity."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000505-AS-000230",
                   "gid":"TCAT-AS-001600",
                   "rid":"TCAT-AS-001600_rule",
                   "stig_id":"TCAT-AS-001600",
                   "cci":"CCI-000172",
                   "nist":[
                      "AU-12",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Review for all <Host> elements. If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> element is not defined for each <Host> element, this is a finding.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001600\" do\r\n    title \"AccessLogValve must be configured per each virtual host.\"\r\n    desc  \"Tomcat has the ability to host multiple virtual hosts on one physical server by using the <Host> container attribute. \r\n    This allows the admin to separate hosted applications according to where the domain the application will be available. \r\n    Configuring logs on a per-host basis allows for log management that correlates to the virtual host activity.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000505-AS-000230\"\r\n    tag \"gid\": \"TCAT-AS-001600\"\r\n    tag \"rid\": \"TCAT-AS-001600_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001600\"\r\n    tag \"cci\": \"CCI-000172\"\r\n    tag \"nist\": [\"AU-12\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Review for all <Host> elements. If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> element is not defined for each <Host> element, this is a finding.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n  \r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    valves = tomcat_server_file[\"//Valve/@className\"]\r\n    describe valves do \r\n      it { should include \"org.apache.catalina.valves.AccessLogValve\" }\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001600.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001600.rb:1 ",
                      "run_time":0.001705849,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001610",
                "title":"AccessLogValve must be configured per each virtual host.",
                "desc":"Tomcat has the ability to host multiple virtual hosts on one physical server by using the <Host> container attribute. \n    This allows the admin to separate hosted applications according to where the domain the application will be available. \n    Configuring logs on a per-host basis allows for log management that correlates to the virtual host activity.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Tomcat has the ability to host multiple virtual hosts on one physical server by using the <Host> container attribute. \n    This allows the admin to separate hosted applications according to where the domain the application will be available. \n    Configuring logs on a per-host basis allows for log management that correlates to the virtual host activity."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000506-AS-000231",
                   "gid":"TCAT-AS-001610",
                   "rid":"TCAT-AS-001610_rule",
                   "stig_id":"TCAT-AS-001610",
                   "cci":"CCI-000172",
                   "nist":[
                      "AU-12",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"As an elevated user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Review for all <Host> elements. If a <Valve className=\"org.apache.catalina.valves.AccessLogValve\" .../> \n    element is not defined for each <Host> element, this is a finding.\n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>",
                   "fix":"As a privileged user on the Tomcat server:\n    Edit the $CATALINA_HOME/conf/server.xml file.\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \n    EXAMPLE:\n    <Host name=\"localhost\"  appBase=\"webapps\"\n                unpackWARs=\"true\" autoDeploy=\"false\">\n    ...\n    <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n                  prefix=\"localhost_access_log\" suffix=\".txt\"\n                  pattern=\"%h %l %t %u %r %s %b\" />\n      ...\n    </Host>\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001610\" do\r\n    title \"AccessLogValve must be configured per each virtual host.\"\r\n    desc  \"Tomcat has the ability to host multiple virtual hosts on one physical server by using the <Host> container attribute. \r\n    This allows the admin to separate hosted applications according to where the domain the application will be available. \r\n    Configuring logs on a per-host basis allows for log management that correlates to the virtual host activity.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000506-AS-000231\"\r\n    tag \"gid\": \"TCAT-AS-001610\"\r\n    tag \"rid\": \"TCAT-AS-001610_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001610\"\r\n    tag \"cci\": \"CCI-000172\"\r\n    tag \"nist\": [\"AU-12\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"As an elevated user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Review for all <Host> elements. If a <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" .../> \r\n    element is not defined for each <Host> element, this is a finding.\r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    Edit the $CATALINA_HOME/conf/server.xml file.\r\n    Create a <Valve> element that is nested beneath the <Host> element containing an AccessLogValve. \r\n    EXAMPLE:\r\n    <Host name=\\\"localhost\\\"  appBase=\\\"webapps\\\"\r\n                unpackWARs=\\\"true\\\" autoDeploy=\\\"false\\\">\r\n    ...\r\n    <Valve className=\\\"org.apache.catalina.valves.AccessLogValve\\\" directory=\\\"logs\\\"\r\n                  prefix=\\\"localhost_access_log\\\" suffix=\\\".txt\\\"\r\n                  pattern=\\\"%h %l %t %u %r %s %b\\\" />\r\n      ...\r\n    </Host>\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_server_file = xml(\"$CATALINA_HOME/conf/server.xml\")\r\n    valves = tomcat_server_file[\"//Valve/@className\"]\r\n    describe valves do \r\n      it { should include \"org.apache.catalina.valves.AccessLogValve\" }\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001610.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"Control Source Code Error Apache_Tomcat_9.0.36/controls/TCAT-AS-001610.rb:1 ",
                      "run_time":0.001771177,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"undefined method `root_node' for {}:Hash",
                      "exception":"RuntimeError",
                      "backtrace":[
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/rule.rb:61:in `block (2 levels) in initialize'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `instance_exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:257:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `block in with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `block in with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:619:in `run_around_example_hooks_for'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/hooks.rb:481:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:460:in `with_around_example_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:503:in `with_around_and_singleton_context_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example.rb:254:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:644:in `block in run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:640:in `run_examples'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:606:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `block in run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/example_group.rb:607:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (3 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `map'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:121:in `block (2 levels) in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/configuration.rb:2058:in `with_suite_hooks'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:116:in `block in run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/reporter.rb:74:in `report'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/rspec-core-3.9.2/lib/rspec/core/runner.rb:115:in `run_specs'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner_rspec.rb:82:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:159:in `run_tests'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/runner.rb:130:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/cli.rb:279:in `exec'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/command.rb:27:in `run'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/invocation.rb:126:in `invoke_command'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor.rb:387:in `dispatch'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/thor-0.20.3/lib/thor/base.rb:466:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-core-4.19.0/lib/inspec/base_cli.rb:35:in `start'",
                         "/opt/inspec/embedded/lib/ruby/gems/2.6.0/gems/inspec-bin-4.19.0/bin/inspec:11:in `<top (required)>'",
                         "/usr/bin/inspec:210:in `load'",
                         "/usr/bin/inspec:210:in `<main>'"
                      ]
                   }
                ]
             },
             {
                "id":"TCAT-AS-001640",
                "title":"Application servers must use NIST-approved or NSA-approved key management technology and processes.",
                "desc":"Class 3 PKI certificates are used for servers and software signing rather than for identifying individuals. \n    Class 4 certificates are used for business-to-business transactions. Utilizing unapproved certificates not issued \n    or approved by DoD or CNS creates an integrity risk. The application server must utilize approved DoD or CNS Class 3 \n    or Class 4 certificates for software signing and business-to-business transactions.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Class 3 PKI certificates are used for servers and software signing rather than for identifying individuals. \n    Class 4 certificates are used for business-to-business transactions. Utilizing unapproved certificates not issued \n    or approved by DoD or CNS creates an integrity risk. The application server must utilize approved DoD or CNS Class 3 \n    or Class 4 certificates for software signing and business-to-business transactions."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000514-AS-000137",
                   "gid":"TCAT-AS-001640",
                   "rid":"TCAT-AS-001640_rule",
                   "stig_id":"TCAT-AS-001640",
                   "cci":"CCI-002450",
                   "nist":[
                      "SC-13",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"For the systemd Ubuntu OS, check the tomcat.service file to read the content of the JAVA_OPTS environment variable setting.\n    sudo cat /etc/systemd/system/tomcat.service |grep -i truststore\n    EXAMPLE output:\n    set JAVA_OPTS=\"-Djavax.net.ssl.trustStore=/path/to/truststore\" \"-Djavax.net.ssl.trustStorePassword=************\"\n    If the variable is not set, use the default location command below. If the variable is set, \n    use the alternate location command below and include the path and truststore file. \n    -Default location:\n    keytool -list -cacerts -v | grep -i issuer\n    -Alternate location:\n    keytool -list -keystore <location of trust store file> -v |grep -i issuer\n    If there are no CA certificates issued by a Certificate Authority (CA) that is part of the DoD PKI/PKE, this is a finding.",
                   "fix":"Obtain and install the DoD PKI CA certificate bundles by accessing the DoD PKI office web site at cyber.mil/pki-pke.\n    Import the DoD CA certificates."
                },
                "code":"control \"TCAT-AS-001640\" do\r\n    title \"Application servers must use NIST-approved or NSA-approved key management technology and processes.\"\r\n    desc  \"Class 3 PKI certificates are used for servers and software signing rather than for identifying individuals. \r\n    Class 4 certificates are used for business-to-business transactions. Utilizing unapproved certificates not issued \r\n    or approved by DoD or CNS creates an integrity risk. The application server must utilize approved DoD or CNS Class 3 \r\n    or Class 4 certificates for software signing and business-to-business transactions.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000514-AS-000137\"\r\n    tag \"gid\": \"TCAT-AS-001640\"\r\n    tag \"rid\": \"TCAT-AS-001640_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001640\"\r\n    tag \"cci\": \"CCI-002450\"\r\n    tag \"nist\": [\"SC-13\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"For the systemd Ubuntu OS, check the tomcat.service file to read the content of the JAVA_OPTS environment variable setting.\r\n    sudo cat /etc/systemd/system/tomcat.service |grep -i truststore\r\n    EXAMPLE output:\r\n    set JAVA_OPTS=\\\"-Djavax.net.ssl.trustStore=/path/to/truststore\\\" \\\"-Djavax.net.ssl.trustStorePassword=************\\\"\r\n    If the variable is not set, use the default location command below. If the variable is set, \r\n    use the alternate location command below and include the path and truststore file. \r\n    -Default location:\r\n    keytool -list -cacerts -v | grep -i issuer\r\n    -Alternate location:\r\n    keytool -list -keystore <location of trust store file> -v |grep -i issuer\r\n    If there are no CA certificates issued by a Certificate Authority (CA) that is part of the DoD PKI/PKE, this is a finding.\"\r\n    tag \"fix\": \"Obtain and install the DoD PKI CA certificate bundles by accessing the DoD PKI office web site at cyber.mil/pki-pke.\r\n    Import the DoD CA certificates.\"\r\n    \r\n    describe \"This is a manual check\" do \r\n        skip \"Check the trustStore variable is set in the tomcat.service file. If it is not set run the \r\n        command: \\\"keytool -list -cacerts -v | grep -i issuer\\\" to set the Default Location. If the default is already set then run the \r\n        command: \\\"keytool -list -keystore <location of trust store file> -v |grep -i issuer\\\" to set the alternate location\"\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001640.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":4.945e-06,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "resource":"",
                      "skip_message":"Check the trustStore variable is set in the tomcat.service file. If it is not set run the \n        command: \"keytool -list -cacerts -v | grep -i issuer\" to set the Default Location. If the default is already set then run the \n        command: \"keytool -list -keystore <location of trust store file> -v |grep -i issuer\" to set the alternate location"
                   }
                ]
             },
             {
                "id":"TCAT-AS-001660",
                "title":"STRICT_SERVLET_COMPLIANCE must be set to true.",
                "desc":"Strict Servlet Compliance forces Tomcat to adhere to standards specifications including but not limited to RFC2109. \n    RFC2109 sets the standard for HTTP session management. This setting affects several settings which primarily pertain to \n    cookie headers, cookie values, and sessions. Cookies will be parsed for strict adherence to specifications.\n    Note that changing a number of these default settings may break some systems, as some browsers are unable to correctly \n    handle the cookie headers that result from a strict adherence to the specifications.\n\n    This one setting changes the default values for the following settings:\n    org.apache.catalina.core.\n    ApplicationContext.GET_RESOURCE_REQUIRE_SLASH\n    org.apache.catalina.core.\n    ApplicationDispatcher.WRAP_SAME_OBJECT\n    org.apache.catalina.core.\n    StandardHostValve.ACCESS_SESSION\n    org.apache.catalina.session.\n    StandardSession.ACTIVITY_CHECK\n    org.apache.catalina.session.\n    StandardSession.LAST_ACCESS_AT_START\n    org.apache.tomcat.util.http.\n    ServerCookie.ALWAYS_ADD_EXPIRES\n    org.apache.tomcat.util.http.\n    ServerCookie.FWD_SLASH_IS_SEPARATOR\n    org.apache.tomcat.util.http.\n    ServerCookie.PRESERVE_COOKIE_HEADER\n    org.apache.tomcat.util.http.\n    ServerCookie.STRICT_NAMING\n    The resourceOnlyServlets attribute of any Context element.\n    The tldValidation attribute of any Context element.\n    The useRelativeRedirects attribute of any Context element.\n    The xmlNamespaceAware attribute of any Context element.\n    The xmlValidation attribute of any Context element.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Strict Servlet Compliance forces Tomcat to adhere to standards specifications including but not limited to RFC2109. \n    RFC2109 sets the standard for HTTP session management. This setting affects several settings which primarily pertain to \n    cookie headers, cookie values, and sessions. Cookies will be parsed for strict adherence to specifications.\n    Note that changing a number of these default settings may break some systems, as some browsers are unable to correctly \n    handle the cookie headers that result from a strict adherence to the specifications.\n\n    This one setting changes the default values for the following settings:\n    org.apache.catalina.core.\n    ApplicationContext.GET_RESOURCE_REQUIRE_SLASH\n    org.apache.catalina.core.\n    ApplicationDispatcher.WRAP_SAME_OBJECT\n    org.apache.catalina.core.\n    StandardHostValve.ACCESS_SESSION\n    org.apache.catalina.session.\n    StandardSession.ACTIVITY_CHECK\n    org.apache.catalina.session.\n    StandardSession.LAST_ACCESS_AT_START\n    org.apache.tomcat.util.http.\n    ServerCookie.ALWAYS_ADD_EXPIRES\n    org.apache.tomcat.util.http.\n    ServerCookie.FWD_SLASH_IS_SEPARATOR\n    org.apache.tomcat.util.http.\n    ServerCookie.PRESERVE_COOKIE_HEADER\n    org.apache.tomcat.util.http.\n    ServerCookie.STRICT_NAMING\n    The resourceOnlyServlets attribute of any Context element.\n    The tldValidation attribute of any Context element.\n    The useRelativeRedirects attribute of any Context element.\n    The xmlNamespaceAware attribute of any Context element.\n    The xmlValidation attribute of any Context element."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000516-AS-000237",
                   "gid":"TCAT-AS-001660",
                   "rid":"TCAT-AS-001660_rule",
                   "stig_id":"TCAT-AS-001660",
                   "cci":"CCI-000366",
                   "nist":[
                      "CM-6",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server as a privileged user, run the following command:\n    sudo grep -i  strict_servlet /etc/systemd/system/tomcat.service \n    If there are no results, or if the \n    -Dorg.apache.catalina.STRICT_SERVLET_COMPLIANCE is not set to true, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user:\n    Edit the /etc/systemd/system/tomcat.service file and either add or edit the org.apache.catalina.STRICT_SERVLET_COMPLIANCE setting.\n    Set the org.apache.catalina.STRICT_SERVLET_COMPLIANCE=true \n    EXAMPLE:\n    CATALINA_OPTS='-Dorg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true'\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001660\" do\r\n    title \"STRICT_SERVLET_COMPLIANCE must be set to true.\"\r\n    desc  \"Strict Servlet Compliance forces Tomcat to adhere to standards specifications including but not limited to RFC2109. \r\n    RFC2109 sets the standard for HTTP session management. This setting affects several settings which primarily pertain to \r\n    cookie headers, cookie values, and sessions. Cookies will be parsed for strict adherence to specifications.\r\n    Note that changing a number of these default settings may break some systems, as some browsers are unable to correctly \r\n    handle the cookie headers that result from a strict adherence to the specifications.\r\n\r\n    This one setting changes the default values for the following settings:\r\n    org.apache.catalina.core.\r\n    ApplicationContext.GET_RESOURCE_REQUIRE_SLASH\r\n    org.apache.catalina.core.\r\n    ApplicationDispatcher.WRAP_SAME_OBJECT\r\n    org.apache.catalina.core.\r\n    StandardHostValve.ACCESS_SESSION\r\n    org.apache.catalina.session.\r\n    StandardSession.ACTIVITY_CHECK\r\n    org.apache.catalina.session.\r\n    StandardSession.LAST_ACCESS_AT_START\r\n    org.apache.tomcat.util.http.\r\n    ServerCookie.ALWAYS_ADD_EXPIRES\r\n    org.apache.tomcat.util.http.\r\n    ServerCookie.FWD_SLASH_IS_SEPARATOR\r\n    org.apache.tomcat.util.http.\r\n    ServerCookie.PRESERVE_COOKIE_HEADER\r\n    org.apache.tomcat.util.http.\r\n    ServerCookie.STRICT_NAMING\r\n    The resourceOnlyServlets attribute of any Context element.\r\n    The tldValidation attribute of any Context element.\r\n    The useRelativeRedirects attribute of any Context element.\r\n    The xmlNamespaceAware attribute of any Context element.\r\n    The xmlValidation attribute of any Context element.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000516-AS-000237\"\r\n    tag \"gid\": \"TCAT-AS-001660\"\r\n    tag \"rid\": \"TCAT-AS-001660_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001660\"\r\n    tag \"cci\": \"CCI-000366\"\r\n    tag \"nist\": [\"CM-6\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server as a privileged user, run the following command:\r\n    sudo grep -i  strict_servlet /etc/systemd/system/tomcat.service \r\n    If there are no results, or if the \r\n    -Dorg.apache.catalina.STRICT_SERVLET_COMPLIANCE is not set to true, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user:\r\n    Edit the /etc/systemd/system/tomcat.service file and either add or edit the org.apache.catalina.STRICT_SERVLET_COMPLIANCE setting.\r\n    Set the org.apache.catalina.STRICT_SERVLET_COMPLIANCE=true \r\n    EXAMPLE:\r\n    CATALINA_OPTS='-Dorg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true'\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_service_file = '/etc/systemd/system/tomcat.service'\r\n    environment = command(\"grep STRICT_SERVLET_COMPLIANCE #{tomcat_service_file}\")\r\n    catalina_options = environment.stdout.split(\" \")\r\n    catalina_options.each do |option|\r\n        if option.include? \"STRICT_SERVLET_COMPLIANCE\"\r\n            describe option.split(\"=\")[1] do \r\n                it { should include \"true\" }\r\n            end\r\n        end\r\n    end\r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001660.rb"
                },
                "waiver_data":{
 
                },
                "results":[
 
                ]
             },
             {
                "id":"TCAT-AS-001670",
                "title":"RECYCLE_FACADES must be set to true.",
                "desc":"If RECYCLE_FACADES is true or if a security manager is in use, a new facade object will be \n    created for each request. This reduces the chances that a bug in an application might expose data \n    from one request to another. This setting is configured using environment variable settings. \n    For Linux OS flavors other than Ubuntu, use the relevant OS commands. For Ubuntu, this setting \n    can be managed in the /etc/systemd/system/tomcat.service file via the CATALINA_OPTS variable. \n    This setting is defined in the file and referenced during Tomcat startup in order to load Tomcat \n    environment variables. Technically, the tomcat.service referenced in the check and fix could be \n    called a different name, for STIG purposes and to provide a standard setting that can be referred \n    to and obviously is used for Tomcat, tomcat.service was chosen.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"If RECYCLE_FACADES is true or if a security manager is in use, a new facade object will be \n    created for each request. This reduces the chances that a bug in an application might expose data \n    from one request to another. This setting is configured using environment variable settings. \n    For Linux OS flavors other than Ubuntu, use the relevant OS commands. For Ubuntu, this setting \n    can be managed in the /etc/systemd/system/tomcat.service file via the CATALINA_OPTS variable. \n    This setting is defined in the file and referenced during Tomcat startup in order to load Tomcat \n    environment variables. Technically, the tomcat.service referenced in the check and fix could be \n    called a different name, for STIG purposes and to provide a standard setting that can be referred \n    to and obviously is used for Tomcat, tomcat.service was chosen."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000516-AS-000237",
                   "gid":"TCAT-AS-001670",
                   "rid":"TCAT-AS-001670_rule",
                   "stig_id":"TCAT-AS-001670",
                   "cci":"CCI-000366",
                   "nist":[
                      "CM-6",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server as a privileged user, run the following command:\n    sudo grep -i  recycle_facades /etc/systemd/system/tomcat.service \n    If there are no results, or if the org.apache.catalina.connector. \n    RECYCLE_FACADES is not configured to load at startup, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user: \n    Edit the /etc/systemd/system/tomcat.service file and either add or edit the org.apache.catalina.connector. \n    RECYCLE_FACADES setting. Set the org.apache.catalina.connector. RECYCLE_FACADES=true \n    EXAMPLE:\n    Environment='CATALINA_OPTS -Dorg.apache.catalina.connector. RECYCLE_FACADES=true'\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001670\" do\r\n    title \"RECYCLE_FACADES must be set to true.\"\r\n    desc  \"If RECYCLE_FACADES is true or if a security manager is in use, a new facade object will be \r\n    created for each request. This reduces the chances that a bug in an application might expose data \r\n    from one request to another. This setting is configured using environment variable settings. \r\n    For Linux OS flavors other than Ubuntu, use the relevant OS commands. For Ubuntu, this setting \r\n    can be managed in the /etc/systemd/system/tomcat.service file via the CATALINA_OPTS variable. \r\n    This setting is defined in the file and referenced during Tomcat startup in order to load Tomcat \r\n    environment variables. Technically, the tomcat.service referenced in the check and fix could be \r\n    called a different name, for STIG purposes and to provide a standard setting that can be referred \r\n    to and obviously is used for Tomcat, tomcat.service was chosen.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000516-AS-000237\"\r\n    tag \"gid\": \"TCAT-AS-001670\"\r\n    tag \"rid\": \"TCAT-AS-001670_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001670\"\r\n    tag \"cci\": \"CCI-000366\"\r\n    tag \"nist\": [\"CM-6\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server as a privileged user, run the following command:\r\n    sudo grep -i  recycle_facades /etc/systemd/system/tomcat.service \r\n    If there are no results, or if the org.apache.catalina.connector. \r\n    RECYCLE_FACADES is not configured to load at startup, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user: \r\n    Edit the /etc/systemd/system/tomcat.service file and either add or edit the org.apache.catalina.connector. \r\n    RECYCLE_FACADES setting. Set the org.apache.catalina.connector. RECYCLE_FACADES=true \r\n    EXAMPLE:\r\n    Environment='CATALINA_OPTS -Dorg.apache.catalina.connector. RECYCLE_FACADES=true'\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_service_file = '/etc/systemd/system/tomcat.service'\r\n    environment = command(\"grep RECYCLE_FACADES #{tomcat_service_file}\")\r\n    catalina_options = environment.stdout.split(\" \")\r\n    catalina_options.each do |option|\r\n        if option.include? \"RECYCLE_FACADES\"\r\n            describe option.split(\"=\")[1] do \r\n                it { should include \"true\" }\r\n            end\r\n        end\r\n    end\r\n  \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001670.rb"
                },
                "waiver_data":{
 
                },
                "results":[
 
                ]
             },
             {
                "id":"TCAT-AS-001680",
                "title":"ALLOW_BACKSLASH must be set to false.",
                "desc":"When Tomcat is installed behind a proxy configured to only allow access to certain Tomcat contexts \n    (web applications), an HTTP request containing \"/\\../\" may allow attackers to work around the proxy \n    restrictions using directory traversal attack methods. If allow_backslash is true the '' character will \n    be permitted as a path delimiter. The default value for the setting is false but Tomcat should always be \n    configured as if no proxy restricting context access was used and allow_backslash should be set to false \n    to prevent directory traversal style attacks. This setting can create operability issues with non-compliant \n    clients. In order to accommodate a non-compliant client, any deviation from the STIG setting must be approved by the ISSO.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"When Tomcat is installed behind a proxy configured to only allow access to certain Tomcat contexts \n    (web applications), an HTTP request containing \"/\\../\" may allow attackers to work around the proxy \n    restrictions using directory traversal attack methods. If allow_backslash is true the '' character will \n    be permitted as a path delimiter. The default value for the setting is false but Tomcat should always be \n    configured as if no proxy restricting context access was used and allow_backslash should be set to false \n    to prevent directory traversal style attacks. This setting can create operability issues with non-compliant \n    clients. In order to accommodate a non-compliant client, any deviation from the STIG setting must be approved by the ISSO."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000516-AS-000237",
                   "gid":"TCAT-AS-001680",
                   "rid":"TCAT-AS-001680_rule",
                   "stig_id":"TCAT-AS-001680",
                   "cci":"CCI-000366",
                   "nist":[
                      "CM-6",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"If the ISSO has accepted the risk for enabling the ALLOW_BACKSLASH setting, this requirement is NA.\n    From the Tomcat server as an elevated user, run the following command:\n    sudo grep -i ALLOW_BACKSLASH $CATALINA_HOME/conf/catalina.properties\n    sudo grep -i catalina_opts /etc/systemd/system/tomcat.service\n    If org.apache.catalina.connector. ALLOW_BACKSLASH=true, this is a finding.",
                   "fix":"As a privileged user on the Tomcat server:\n    If the finding is in the catalina.properties file, edit the $CATALINA_HOME/conf/catalina.properties file.\n    sudo nano $CATALINA_HOME/conf/catalina.properties\n    Change the org.apache.catalina.connector.ALLOW_BACKSLASH=true setting to =false.\n    If the finding is in the /etc/systemd/services/tomcat/service file, edit the file using a text editor.\n    sudo nano /etc/systemd/services/tomcat.service\n    Locate the Environment='CATALINA_OPTS=' line and change the -D.org.apache.catalina.connectorALLOW_BACKSLASH=true setting to =false.\n    Restart Tomcat:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001680\" do\r\n    title \"ALLOW_BACKSLASH must be set to false.\"\r\n    desc  \"When Tomcat is installed behind a proxy configured to only allow access to certain Tomcat contexts \r\n    (web applications), an HTTP request containing \\\"/\\\\../\\\" may allow attackers to work around the proxy \r\n    restrictions using directory traversal attack methods. If allow_backslash is true the '\\' character will \r\n    be permitted as a path delimiter. The default value for the setting is false but Tomcat should always be \r\n    configured as if no proxy restricting context access was used and allow_backslash should be set to false \r\n    to prevent directory traversal style attacks. This setting can create operability issues with non-compliant \r\n    clients. In order to accommodate a non-compliant client, any deviation from the STIG setting must be approved by the ISSO.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000516-AS-000237\"\r\n    tag \"gid\": \"TCAT-AS-001680\"\r\n    tag \"rid\": \"TCAT-AS-001680_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001680\"\r\n    tag \"cci\": \"CCI-000366\"\r\n    tag \"nist\": [\"CM-6\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"If the ISSO has accepted the risk for enabling the ALLOW_BACKSLASH setting, this requirement is NA.\r\n    From the Tomcat server as an elevated user, run the following command:\r\n    sudo grep -i ALLOW_BACKSLASH $CATALINA_HOME/conf/catalina.properties\r\n    sudo grep -i catalina_opts /etc/systemd/system/tomcat.service\r\n    If org.apache.catalina.connector. ALLOW_BACKSLASH=true, this is a finding.\"\r\n    tag \"fix\": \"As a privileged user on the Tomcat server:\r\n    If the finding is in the catalina.properties file, edit the $CATALINA_HOME/conf/catalina.properties file.\r\n    sudo nano $CATALINA_HOME/conf/catalina.properties\r\n    Change the org.apache.catalina.connector.ALLOW_BACKSLASH=true setting to =false.\r\n    If the finding is in the /etc/systemd/services/tomcat/service file, edit the file using a text editor.\r\n    sudo nano /etc/systemd/services/tomcat.service\r\n    Locate the Environment='CATALINA_OPTS=' line and change the -D.org.apache.catalina.connectorALLOW_BACKSLASH=true setting to =false.\r\n    Restart Tomcat:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_service_file = \"/etc/systemd/system/tomcat.service\"\r\n    environment = command(\"grep ALLOW_BACKSLASH #{tomcat_service_file}\")\r\n    catalina_options = environment.stdout.split(\" \")\r\n    if !catalina_options.empty?\r\n        catalina_options.each do |option|\r\n            if option.include? \"ALLOW_BACKSLASH\"\r\n                describe option.split(\"=\")[1] do \r\n                    it { should include \"true\" }\r\n                end\r\n            end\r\n        end\r\n    end\r\n  \r\n    describe parse_config_file('/usr/share/tomcat/conf/catalina.properties') do\r\n        its('ALLOW_BACKSLASH') { should eq 'false' }\r\n    end\r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001680.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"Parse Config File /usr/share/tomcat/conf/catalina.properties",
                      "run_time":4.471e-06,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "resource":"Parse Config File /usr/share/tomcat/conf/catalina.properties",
                      "skip_message":"Can't find file: /usr/share/tomcat/conf/catalina.properties"
                   }
                ]
             },
             {
                "id":"TCAT-AS-001690",
                "title":"ENFORCE_ENCODING_IN_GET_WRITER must be set to true.",
                "desc":"Some clients try to guess the character encoding of text media when the mandated default of ISO-8859-1 should be used. \n    Some browsers will interpret as UTF-7 when the characters are safe for ISO-8859-1. This can create the potential for a XSS attack. \n    To defend against this, enforce_encoding_in_get_writer must be set to true.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Some clients try to guess the character encoding of text media when the mandated default of ISO-8859-1 should be used. \n    Some browsers will interpret as UTF-7 when the characters are safe for ISO-8859-1. This can create the potential for a XSS attack. \n    To defend against this, enforce_encoding_in_get_writer must be set to true."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000516-AS-000237",
                   "gid":"TCAT-AS-001690",
                   "rid":"TCAT-AS-001690_rule",
                   "stig_id":"TCAT-AS-001690",
                   "cci":"CCI-000366",
                   "nist":[
                      "CM-6",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"From the Tomcat server as a privileged user, run the following command:\n    sudo grep -i  enforce_encoding /etc/systemd/system/tomcat.service \n    If there are no results, or if the org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER \n    is not enabled, this is a finding.",
                   "fix":"From the Tomcat server as a privileged user: \n    Edit the /etc/systemd/system/tomcat.service file, and either add or edit \n    the org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER setting.\n    Set the org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER=true \n    EXAMPLE:\n    Environment='CATALINA_OPTS -Dorg.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER=true'\n    Restart the Tomcat server.\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001690\" do\r\n    title \"ENFORCE_ENCODING_IN_GET_WRITER must be set to true.\"\r\n    desc  \"Some clients try to guess the character encoding of text media when the mandated default of ISO-8859-1 should be used. \r\n    Some browsers will interpret as UTF-7 when the characters are safe for ISO-8859-1. This can create the potential for a XSS attack. \r\n    To defend against this, enforce_encoding_in_get_writer must be set to true.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000516-AS-000237\"\r\n    tag \"gid\": \"TCAT-AS-001690\"\r\n    tag \"rid\": \"TCAT-AS-001690_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001690\"\r\n    tag \"cci\": \"CCI-000366\"\r\n    tag \"nist\": [\"CM-6\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"From the Tomcat server as a privileged user, run the following command:\r\n    sudo grep -i  enforce_encoding /etc/systemd/system/tomcat.service \r\n    If there are no results, or if the org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER \r\n    is not enabled, this is a finding.\"\r\n    tag \"fix\": \"From the Tomcat server as a privileged user: \r\n    Edit the /etc/systemd/system/tomcat.service file, and either add or edit \r\n    the org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER setting.\r\n    Set the org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER=true \r\n    EXAMPLE:\r\n    Environment='CATALINA_OPTS -Dorg.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER=true'\r\n    Restart the Tomcat server.\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    tomcat_service_file = \"/etc/systemd/system/tomcat.service\"\r\n    environment = command(\"grep ENFORCE_ENCODING_IN_GET_WRITER #{tomcat_service_file}\")\r\n    catalina_options = environment.stdout.split(\" \")\r\n    if !catalina_options.empty?\r\n        catalina_options.each do |option|\r\n            if option.include? \"ENFORCE_ENCODING_IN_GET_WRITER\"\r\n                describe option.split(\"=\")[1] do \r\n                    it { should include \"true\" }\r\n                end\r\n            end\r\n        end\r\n    else \r\n        describe catalina_options.empty? do \r\n            puts \"Could not find the ENFORCE_ENCODING_IN_GET_WRITER option. This check has failed\"\r\n            it { should be false }\r\n        end\r\n    end\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001690.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"failed",
                      "code_desc":"true is expected to equal false",
                      "run_time":0.00156573,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "message":"\nexpected false\n     got true\n"
                   }
                ]
             },
             {
                "id":"TCAT-AS-001700",
                "title":"Tomcat users in a management role must be approved by the ISSO.",
                "desc":"Deploying applications to Tomcat requires a Tomcat user account that is in the \n    \"manager-script\" role. Any user accounts in a Tomcat management role must be approved by the ISSO.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Deploying applications to Tomcat requires a Tomcat user account that is in the \n    \"manager-script\" role. Any user accounts in a Tomcat management role must be approved by the ISSO."
                   }
                ],
                "impact":0.5,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000516-AS-000237",
                   "gid":"TCAT-AS-001700",
                   "rid":"TCAT-AS-001700_rule",
                   "stig_id":"TCAT-AS-001700",
                   "cci":"CCI-000366",
                   "nist":[
                      "CM-6",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Review the Tomcat servers System Security Plan/server documentation.\n    Ensure that user accounts and roles with access to Tomcat management features such as the \"manager-script\" \n    role are documented and approved by the ISSO.\n    If the ISSO has not approved of documented roles and users who have management rights to the Tomcat server, this is a finding.",
                   "fix":"Document the users and the roles that have been defined for use with the Tomcat server.\n    Ensure that all users and roles with access to Tomcat management features and capabilities are approved by the ISSO."
                },
                "code":"control \"TCAT-AS-001700\" do\r\n    title \"Tomcat users in a management role must be approved by the ISSO.\"\r\n    desc  \"Deploying applications to Tomcat requires a Tomcat user account that is in the \r\n    \\\"manager-script\\\" role. Any user accounts in a Tomcat management role must be approved by the ISSO.\"\r\n    impact 0.5\r\n    tag \"gtitle\": \"SRG-APP-000516-AS-000237\"\r\n    tag \"gid\": \"TCAT-AS-001700\"\r\n    tag \"rid\": \"TCAT-AS-001700_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001700\"\r\n    tag \"cci\": \"CCI-000366\"\r\n    tag \"nist\": [\"CM-6\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Review the Tomcat servers System Security Plan/server documentation.\r\n    Ensure that user accounts and roles with access to Tomcat management features such as the \\\"manager-script\\\" \r\n    role are documented and approved by the ISSO.\r\n    If the ISSO has not approved of documented roles and users who have management rights to the Tomcat server, this is a finding.\"\r\n    tag \"fix\": \"Document the users and the roles that have been defined for use with the Tomcat server.\r\n    Ensure that all users and roles with access to Tomcat management features and capabilities are approved by the ISSO.\"\r\n    \r\n    describe \"This is a manual check\" do \r\n        skip \"Review the SSP or server documentation. Ensure all users and roles with access to the Tomcat \r\n        management features and capabilities are approved by the ISSO.\"\r\n    end \r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001700.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":5.652e-06,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "resource":"",
                      "skip_message":"Review the SSP or server documentation. Ensure all users and roles with access to the Tomcat \n        management features and capabilities are approved by the ISSO."
                   }
                ]
             },
             {
                "id":"TCAT-AS-001710",
                "title":"Hosted applications must be documented in the system security plan.",
                "desc":"The system administrator must be cognizant of all applications operating on the Tomcat server, \n    and must address any security implications associated with the operation of the applications.",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"The system administrator must be cognizant of all applications operating on the Tomcat server, \n    and must address any security implications associated with the operation of the applications."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000516-AS-000237",
                   "gid":"TCAT-AS-001710",
                   "rid":"TCAT-AS-001710_rule",
                   "stig_id":"TCAT-AS-001710",
                   "cci":"CCI-000366",
                   "nist":[
                      "CM-6",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Review the Tomcat servers System Security Plan/server documentation.\n    Access the Tomcat server and review the $CATALINA_HOME/webapps folder and the \n    $CATALINA_BASE/webapps folder (if they exist).\n    Ensure that all webapps are documented in the SSP.\n    If the applications that are hosted on the Tomcat server are not documented in the SSP, this is a finding.",
                   "fix":"Document the applications that have an ATO on the Tomcat server.\n    Retain the information in the SSP and present to the auditor in the event of a CCRI."
                },
                "code":"control \"TCAT-AS-001710\" do\r\n    title \"Hosted applications must be documented in the system security plan.\"\r\n    desc  \"The system administrator must be cognizant of all applications operating on the Tomcat server, \r\n    and must address any security implications associated with the operation of the applications.\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000516-AS-000237\"\r\n    tag \"gid\": \"TCAT-AS-001710\"\r\n    tag \"rid\": \"TCAT-AS-001710_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001710\"\r\n    tag \"cci\": \"CCI-000366\"\r\n    tag \"nist\": [\"CM-6\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Review the Tomcat servers System Security Plan/server documentation.\r\n    Access the Tomcat server and review the $CATALINA_HOME/webapps folder and the \r\n    $CATALINA_BASE/webapps folder (if they exist).\r\n    Ensure that all webapps are documented in the SSP.\r\n    If the applications that are hosted on the Tomcat server are not documented in the SSP, this is a finding.\"\r\n    tag \"fix\": \"Document the applications that have an ATO on the Tomcat server.\r\n    Retain the information in the SSP and present to the auditor in the event of a CCRI.\"\r\n    \r\n    describe \"This is a manual check\" do \r\n        skip \"Document applications that have an ATO on the Tomcat server in the SSP\"\r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001710.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":4.397e-06,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "resource":"",
                      "skip_message":"Document applications that have an ATO on the Tomcat server in the SSP"
                   }
                ]
             },
             {
                "id":"TCAT-AS-001720",
                "title":"Connectors must be approved by the ISSO.",
                "desc":"Connectors are how Tomcat receives requests over a network port, passes them to hosted web \n    applications via HTTP or AJP and then sends back the results to the requestor. A port and a protocol \n    are tied to each connector. Only connectors approved by the ISSO must be installed. ISSO review will \n    consist of validating connector protocol as being secure and required in order for the hosted application \n    to operate. The ISSO will ensure that unnecessary or insecure connector protocols are not enabled. \n    The ISSO will provide documented approval for each connector that will be maintained in the System Security Plan (SSP).",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Connectors are how Tomcat receives requests over a network port, passes them to hosted web \n    applications via HTTP or AJP and then sends back the results to the requestor. A port and a protocol \n    are tied to each connector. Only connectors approved by the ISSO must be installed. ISSO review will \n    consist of validating connector protocol as being secure and required in order for the hosted application \n    to operate. The ISSO will ensure that unnecessary or insecure connector protocols are not enabled. \n    The ISSO will provide documented approval for each connector that will be maintained in the System Security Plan (SSP)."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000516-AS-000237",
                   "gid":"TCAT-AS-001720",
                   "rid":"TCAT-AS-001720_rule",
                   "stig_id":"TCAT-AS-001720",
                   "cci":"CCI-000366",
                   "nist":[
                      "CM-6",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Review the Tomcat servers System Security Plan/server documentation.\n    Access the Tomcat server and review the server.xml file.\n    grep -i \"connector port\" $CATALINA_HOME/conf/server.xml\n    Compare the active Connectors and their associated IP ports with the Connectors documented and approved in the SSP.\n    If the Connectors that are configured on the Tomcat server are not approved by the ISSO and documented in the SSP, this is a finding.",
                   "fix":"Document and obtain ISSO approval for the Connectors that are configured on the Tomcat server.\n    Retain the information in the SSP and present to the auditor in the event of a CCRI."
                },
                "code":"control \"TCAT-AS-001720\" do\r\n    title \"Connectors must be approved by the ISSO.\"\r\n    desc  \"Connectors are how Tomcat receives requests over a network port, passes them to hosted web \r\n    applications via HTTP or AJP and then sends back the results to the requestor. A port and a protocol \r\n    are tied to each connector. Only connectors approved by the ISSO must be installed. ISSO review will \r\n    consist of validating connector protocol as being secure and required in order for the hosted application \r\n    to operate. The ISSO will ensure that unnecessary or insecure connector protocols are not enabled. \r\n    The ISSO will provide documented approval for each connector that will be maintained in the System Security Plan (SSP).\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000516-AS-000237\"\r\n    tag \"gid\": \"TCAT-AS-001720\"\r\n    tag \"rid\": \"TCAT-AS-001720_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001720\"\r\n    tag \"cci\": \"CCI-000366\"\r\n    tag \"nist\": [\"CM-6\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Review the Tomcat servers System Security Plan/server documentation.\r\n    Access the Tomcat server and review the server.xml file.\r\n    grep -i \\\"connector port\\\" $CATALINA_HOME/conf/server.xml\r\n    Compare the active Connectors and their associated IP ports with the Connectors documented and approved in the SSP.\r\n    If the Connectors that are configured on the Tomcat server are not approved by the ISSO and documented in the SSP, this is a finding.\"\r\n    tag \"fix\": \"Document and obtain ISSO approval for the Connectors that are configured on the Tomcat server.\r\n    Retain the information in the SSP and present to the auditor in the event of a CCRI.\"\r\n    \r\n    describe \"This is a manual check\" do \r\n        skip \"Review active Connectos and their IP ports with the Connectors \r\n        documented and approved in the SSP.\"\r\n    end\r\n    \r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001720.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":4.024e-06,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "resource":"",
                      "skip_message":"Review active Connectos and their IP ports with the Connectors \n        documented and approved in the SSP."
                   }
                ]
             },
             {
                "id":"TCAT-AS-001730",
                "title":"Connector address attribute must be set.",
                "desc":"Connectors are how Tomcat receives requests over a network port, passes them to hosted web \n    applications via HTTP or AJP, and then sends back the results to the requestor. The \"address\" attribute \n    specifies which network interface the connector listens on. If no IP address is specified, the connector \n    will listen on all configured interfaces. Access to the connector must be restricted to only the network \n    interface(s) specified in the System Security Plan (SSP).",
                "descriptions":[
                   {
                      "label":"default",
                      "data":"Connectors are how Tomcat receives requests over a network port, passes them to hosted web \n    applications via HTTP or AJP, and then sends back the results to the requestor. The \"address\" attribute \n    specifies which network interface the connector listens on. If no IP address is specified, the connector \n    will listen on all configured interfaces. Access to the connector must be restricted to only the network \n    interface(s) specified in the System Security Plan (SSP)."
                   }
                ],
                "impact":0.3,
                "refs":[
 
                ],
                "tags":{
                   "gtitle":"SRG-APP-000516-AS-000237",
                   "gid":"TCAT-AS-001730",
                   "rid":"TCAT-AS-001730_rule",
                   "stig_id":"TCAT-AS-001730",
                   "cci":"CCI-000366",
                   "nist":[
                      "CM-6",
                      "Rev_4"
                   ],
                   "false_negatives":null,
                   "false_positives":null,
                   "documentable":false,
                   "mitigations":null,
                   "severity_override_guidance":false,
                   "potential_impacts":null,
                   "third_party_tools":null,
                   "mitigation_controls":null,
                   "responsibility":null,
                   "ia_controls":null,
                   "check":"Review SSP documentation for list of approved connectors and associated TCP/IP ports and interfaces.\n    Verify the address attribute is specified for each connector and is set to the network interface specified in the SSP.\n    Execute the following command to find configured Connectors:\n    sudo grep -i -B1 -A5 connector $CATALINA_HOME/conf/server.xml\n    Review results and examine the \"address=\" field for each connector.\n    If the connector address attribute is not specified as per the SSP, this is a finding.",
                   "fix":"Ensure the address attribute for each connector and the network interfaces are specified in the SSP.\n    Edit the following file From the Tomcat server as a privileged user:\n    $CATALINA_HOME/conf/server.xml\n    Locate each Connector element then edit or add the \"address=\" field for each connector and specify the appropriate \n    network IP address. The following is an example using a random IP address:\n    EXAMPLE:\n    <Connector\n    port=\"8443\"\n    address=\"192.168.0.145\"\n    ...\n    />\n\n    Restart the Tomcat server:\n    sudo systemctl restart tomcat\n    sudo systemctl daemon-reload"
                },
                "code":"control \"TCAT-AS-001730\" do\r\n    title \"Connector address attribute must be set.\"\r\n    desc  \"Connectors are how Tomcat receives requests over a network port, passes them to hosted web \r\n    applications via HTTP or AJP, and then sends back the results to the requestor. The \\\"address\\\" attribute \r\n    specifies which network interface the connector listens on. If no IP address is specified, the connector \r\n    will listen on all configured interfaces. Access to the connector must be restricted to only the network \r\n    interface(s) specified in the System Security Plan (SSP).\"\r\n    impact 0.3\r\n    tag \"gtitle\": \"SRG-APP-000516-AS-000237\"\r\n    tag \"gid\": \"TCAT-AS-001730\"\r\n    tag \"rid\": \"TCAT-AS-001730_rule\"\r\n    tag \"stig_id\": \"TCAT-AS-001730\"\r\n    tag \"cci\": \"CCI-000366\"\r\n    tag \"nist\": [\"CM-6\", \"Rev_4\"]\r\n    tag \"false_negatives\": nil\r\n    tag \"false_positives\": nil\r\n    tag \"documentable\": false\r\n    tag \"mitigations\": nil\r\n    tag \"severity_override_guidance\": false\r\n    tag \"potential_impacts\": nil\r\n    tag \"third_party_tools\": nil\r\n    tag \"mitigation_controls\": nil\r\n    tag \"responsibility\": nil\r\n    tag \"ia_controls\": nil\r\n    tag \"check\": \"Review SSP documentation for list of approved connectors and associated TCP/IP ports and interfaces.\r\n    Verify the address attribute is specified for each connector and is set to the network interface specified in the SSP.\r\n    Execute the following command to find configured Connectors:\r\n    sudo grep -i -B1 -A5 connector $CATALINA_HOME/conf/server.xml\r\n    Review results and examine the \\\"address=\\\" field for each connector.\r\n    If the connector address attribute is not specified as per the SSP, this is a finding.\"\r\n    tag \"fix\": \"Ensure the address attribute for each connector and the network interfaces are specified in the SSP.\r\n    Edit the following file From the Tomcat server as a privileged user:\r\n    $CATALINA_HOME/conf/server.xml\r\n    Locate each Connector element then edit or add the \\\"address=\\\" field for each connector and specify the appropriate \r\n    network IP address. The following is an example using a random IP address:\r\n    EXAMPLE:\r\n    <Connector\r\n    port=\\\"8443\\\"\r\n    address=\\\"192.168.0.145\\\"\r\n    ...\r\n    />\r\n\r\n    Restart the Tomcat server:\r\n    sudo systemctl restart tomcat\r\n    sudo systemctl daemon-reload\"\r\n\r\n    describe \"This is a manual check\" do \r\n        skip \"Review all the addresses for each Connector and compare against the SSP\"\r\n    end \r\n\r\nend",
                "source_location":{
                   "line":1,
                   "ref":"Apache_Tomcat_9.0.36/controls/TCAT-AS-001730.rb"
                },
                "waiver_data":{
 
                },
                "results":[
                   {
                      "status":"skipped",
                      "code_desc":"This is a manual check",
                      "run_time":4.65e-06,
                      "start_time":"2020-06-17T00:47:15+00:00",
                      "resource":"",
                      "skip_message":"Review all the addresses for each Connector and compare against the SSP"
                   }
                ]
             }
          ],
          "status":"loaded"
       }
    ],
    "statistics":{
       "duration":10.341267526
    },
    "version":"4.19.0"
 }